{"date":"2024-07-25T06:23:11Z","items":[{"file_name":"okta_rules.yaml","comment":"# Example Rule on login in to OKTA. Disabled by default since it might be noisy\n#- rule: User logged in to OKTA\n#  desc: Detect the user login in to OKTA\n#  condition: okta.evt.type = \"user.session.start\"\n#  output: \"A user has logged in toOKTA (user=%okta.actor.name, ip=%okta.client.ip)\"\n#       priority: NOTICE\n#  source: okta\n#  tags: [okta]\n","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L34,L41","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User Changing password in to OKTA","rule":"User Changing password in to OKTA","condition":"okta.evt.type = \"user.account.update_password\"","desc":"Detect a user change password in OKTA","output":"A user has changed password from OKTA (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"1f26f720872048f01eb9d1dbd1adc6e1"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L43,L50","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Creating a new OKTA user account","rule":"Creating a new OKTA user account","condition":"okta.evt.type = \"user.lifecycle.create\"","desc":"Detect a new OKTA user account created in the OKTA environment","output":"A new OKTA user account created (user=%okta.actor.name, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"e337de73cbcc4ad0d19cf1b55bd7a1c7"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L52,L59","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User accessing app via single sign on OKTA","rule":"User accessing app via single sign on OKTA","condition":"okta.evt.type = \"user.authentication.sso\"","desc":"Detect a user accessing an app via OKTA","output":"A user has accessed an app using OKTA (user=%okta.actor.name, app=%okta.target.app.alternateid)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"ae03fa5e74f6b2796025188b5abcd7d6"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L61,L67","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User has been locked out in OKTA","rule":"User has been locked out in OKTA","condition":"okta.evt.type = \"user.account.lock\"","desc":"Detect a user who has been locked out in OKTA","output":"A user has been locked out in OKTA (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"611434b712cc87e1206c87a1a3bfd6de"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L69,L76","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User has been moved from suspended status in OKTA.","rule":"User has been moved from suspended status in OKTA.","condition":"okta.evt.type = \"user.lifecycle.unsuspend\"","desc":"Detect a user who has been moved from suspended status in OKTA","output":"A user has been moved from suspended status in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"a30d212382a7bda42ef3bd74f13ad690"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L78,L85","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User has been activated in OKTA","rule":"User has been activated in OKTA","condition":"okta.evt.type = \"user.lifecycle.activate\"","desc":"Detect a user who has been activated in OKTA","output":"A user has been activated in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"55db6f73f81c9c1b892d8fcf7e432c6b"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L87,L94","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User has been deactivated in OKTA","rule":"User has been deactivated in OKTA","condition":"okta.evt.type = \"user.lifecycle.deactivate\"","desc":"Detect a user who has been deactivated in OKTA","output":"A user has been deactivated in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"6ed3dd37b7c89909f62a07866135b1f1"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L96,L102","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User has been suspended in OKTA","rule":"User has been suspended in OKTA","condition":"okta.evt.type = \"user.lifecycle.suspended\"","desc":"Detect a user who has been suspended in OKTA","output":"A user has been suspended in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"a65fa61b3816cadf52781653c8769a85"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L104,L110","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Admin permission has been assigned to a user in OKTA","rule":"Admin permission has been assigned to a user in OKTA","condition":"okta.evt.type = \"user.account.privilege.grant\"","desc":"Detect an admin permission assigned to a user in OKTA","output":"A user has been locked out in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"1484b4602bcc5ceac8c952b641b4bb31"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L112,L118","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Creating a new OKTA API token","rule":"Creating a new OKTA API token","condition":"okta.evt.type = \"system.api_token.create\"","desc":"Detect a new OKTA API token created in the OKTA environment","output":"A new OKTA API token has been created in OKTA (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"ef0e1e31d7438e7c5901c18dd7b99163"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L120,L126","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User accessing OKTA admin section","rule":"User accessing OKTA admin section","condition":"okta.evt.type = \"user.session.access_admin_app\"","desc":"Detect a user accessing OKTA admin section of your OKTA instance","output":"A user accessed the OKTA admin section of your OKTA instance (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"0117ba68520026c20d9e3f4038c4bf18"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L128,L135","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Adding user in OKTA group","rule":"Adding user in OKTA group","condition":"okta.evt.type = \"group.user_membership.add\"","desc":"Detect a new user added to an OKTA group","output":"A user has been added in an OKTA group (user=%okta.actor.name, target group=%okta.target.group.name, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"9f8f49fc01e52e0319960cef2ea214ba"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L137,L143","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"removing MFA factor from user in OKTA","rule":"removing MFA factor from user in OKTA","condition":"okta.evt.type = \"user.mfa.factor.deactivate\"","desc":"Detect a removing MFA activity on a user in OKTA","output":"A user has removed MFA factor in the OKTA account (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"5d62adf3a2277e10cd1094cf4b4587d1"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L145,L151","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"removing all MFA factor from user in OKTA","rule":"removing all MFA factor from user in OKTA","condition":"okta.evt.type = \"user.mfa.factor.reset_all\"","desc":"Detect a removing MFA activity on a user in OKTA","output":"A user has removed all MFA factor in the OKTA account (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"b9e44c32660dde57785eaaa1dd72483d"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L153,L159","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User password reset by OKTA admin","rule":"User password reset by OKTA admin","condition":"okta.evt.type = \"user.account.reset_password\"","desc":"Detect a password reset on a user done by OKTA Admin Account","output":"A user password has been reset by an OKTA Admin account (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"9820dce802b4e9bc38e7cf3e7ba4f095"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L161,L167","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User hitting the rate limit on requests in OKTA","rule":"User hitting the rate limit on requests in OKTA","condition":"okta.evt.type = \"system.org.rate_limit.violation\"","desc":"Detect a user who hit the rate limit on requests in OKTA","output":"A user has hitted the rate limit on requests in OKTA (user=%okta.actor.name, ip=%okta.client.ip)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"b7f535056f38c1f5b84b07535c9ab399"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L169,L176","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Adding user to application membership in OKTA","rule":"Adding user to application membership in OKTA","condition":"okta.evt.type = \"application.user_membership.add\"","desc":"Detect a user who has been added o application membership in OKTA","output":"A user has been added to an application membership in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name, app=%okta.target.app.alternateid)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","type":"rule","hash":"c724ced6786accde7f8d47dad45546b6"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L178,L184","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"User initiating impersonation session in OKTA","rule":"User initiating impersonation session in OKTA","condition":"okta.evt.type = \"user.session.impersonation.initiate\"","desc":"Detect a user who initiate an impersonation session in OKTA","output":"A user has initiated an impersonation session in OKTA (user=%okta.actor.name, ip=%okta.client.ip, target user=%okta.target.user.name)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"2355060fe93a32428e493f84ee03a625"},{"file_name":"okta_rules.yaml","comment":"# This list allows easily whitelisting countries that are\n# expected to see OKTA logins from.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L188,L189","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"allowed_countries_list","list":"allowed_countries_list","tags":null,"enabled":"true","used_by":["macro:user_known_countries:6b1d99cf9a8792845d7683631d99ea50"],"type":"list","hash":"aee609c0f3b9fd1a19917657f00dc2a5"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L191,L192","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"user_known_countries","macro":"user_known_countries","condition":"(okta.client.geo.country in (allowed_countries_list))","tags":null,"enabled":"true","dependencies":["list:allowed_countries_list:aee609c0f3b9fd1a19917657f00dc2a5"],"used_by":["rule:Detecting unknown logins using geolocation:d2ac16b31fa023aadc8f8cc93f1b027d"],"type":"macro","hash":"6b1d99cf9a8792845d7683631d99ea50"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L194,L201","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Detecting unknown logins using geolocation","rule":"Detecting unknown logins using geolocation","condition":"okta.evt.type = \"user.session.start\" and not user_known_countries","desc":"Detect a logins event based on user geolocation","output":"A user logged in OKTA from a suspicious country (user=%okta.actor.name, ip=%okta.client.ip, country=%okta.client.geo.country)","priority":"NOTICE","source":"okta","tags":["okta"],"enabled":"false","dependencies":["macro:user_known_countries:6b1d99cf9a8792845d7683631d99ea50"],"type":"rule","hash":"d2ac16b31fa023aadc8f8cc93f1b027d"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L203,L209","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Too many failed MFA in last 5min","rule":"Too many failed MFA in last 5min","condition":"okta.mfa.failure.countlast[300]\u003e=3","desc":"An user failed MFA too many times in the last 5min","output":"A user has failed MFA too many times in last 5min (user='%okta.actor.name' last_reason='%okta.reason' countLast300=%okta.mfa.failure.countlast[300])","priority":"WARNING","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"4dae9ef8e6a0f66619807d0ccdeb90d5"},{"file_name":"okta_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/okta/rules/okta_rules.yaml#L211,L217","required_engine_version":"11","required_plugin_versions":[{"name":"okta","version":"0.11.0"}],"name":"Too many denied MFA Pushes in last 5min","rule":"Too many denied MFA Pushes in last 5min","condition":"okta.mfa.deny.countlast[300]\u003e=3","desc":"A user denied too many MFA Pushes in the last 5min","output":"A user has denied too many MFA pushes in last 5min (user='%okta.actor.name' reason='%okta.reason' countLast300=%okta.mfa.deny.countlast[300])","priority":"WARNING","source":"okta","tags":["okta"],"enabled":"true","type":"rule","hash":"fb66439f559a64be63f9dc6a77e34324"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"# Note that this rule is disabled by default. It's useful only to\n# verify that the cloudtrail plugin is sending events properly.  The\n# very broad condition evt.num \u003e 0 only works because the rule source\n# is limited to aws_cloudtrail. This ensures that the only events that\n# are matched against the rule are from the cloudtrail plugin (or\n# a different plugin with the same source).","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L34,L44","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"All Cloudtrail Events","rule":"All Cloudtrail Events","condition":"evt.num \u003e 0","desc":"Match all cloudtrail events.","output":"Some Cloudtrail Event (evtnum=%evt.num info=%evt.plugininfo ts=%evt.time.iso8601 id=%ct.id error=%ct.error)","priority":"DEBUG","source":"aws_cloudtrail","tags":["cloud","aws"],"enabled":"false","type":"rule","hash":"9116943c2762d1b5224cf25c9058c1ea"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L46,L64","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Console Login Through Assume Role","rule":"Console Login Through Assume Role","condition":"ct.name=\"ConsoleLogin\" and not ct.error exists and ct.user.identitytype=\"AssumedRole\" and json.value[/responseElements/ConsoleLogin]=\"Success\"","desc":"Detect a console login through Assume Role.","output":"Detected a console login through Assume Role (principal=%ct.user.principalid, assumedRole=%ct.user.arn, requesting IP=%ct.srcip, AWS region=%ct.region)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_console","aws_iam"],"enabled":"true","type":"rule","hash":"b0ad3c4cf84328c8b67192aab28cde54"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L66,L84","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Console Login Without MFA","rule":"Console Login Without MFA","condition":"ct.name=\"ConsoleLogin\" and not ct.error exists and ct.user.identitytype!=\"AssumedRole\" and json.value[/responseElements/ConsoleLogin]=\"Success\" and json.value[/additionalEventData/MFAUsed]=\"No\"","desc":"Detect a console login without MFA.","output":"Detected a console login without MFA (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region)","priority":"CRITICAL","source":"aws_cloudtrail","tags":["cloud","aws","aws_console","aws_iam"],"enabled":"true","type":"rule","hash":"f12820c22dba31060516853018c3a312"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L86,L105","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Console Root Login Without MFA","rule":"Console Root Login Without MFA","condition":"ct.name=\"ConsoleLogin\" and not ct.error exists and json.value[/additionalEventData/MFAUsed]=\"No\" and ct.user.identitytype!=\"AssumedRole\" and json.value[/responseElements/ConsoleLogin]=\"Success\" and ct.user.identitytype=\"Root\"","desc":"Detect root console login without MFA.","output":"Detected a root console login without MFA. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region)","priority":"CRITICAL","source":"aws_cloudtrail","tags":["cloud","aws","aws_console","aws_iam"],"enabled":"true","type":"rule","hash":"ac7702ed5350ddb09ea0d33abd4d9ade"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L107,L124","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Deactivate MFA for Root User","rule":"Deactivate MFA for Root User","condition":"ct.name=\"DeactivateMFADevice\" and not ct.error exists and ct.user.identitytype=\"Root\" and ct.request.username=\"AWS ROOT USER\"","desc":"Detect deactivating MFA configuration for root.","output":"Multi Factor Authentication configuration has been disabled for root (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, MFA serial number=%ct.request.serialnumber)","priority":"CRITICAL","source":"aws_cloudtrail","tags":["cloud","aws","aws_iam"],"enabled":"true","type":"rule","hash":"3b0639f7e71ecd1a6c7d421c257ffaf5"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L126,L141","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Create AWS user","rule":"Create AWS user","condition":"ct.name=\"CreateUser\" and not ct.error exists","desc":"Detect creation of a new AWS user.","output":"A new AWS user has been created (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, new user created=%ct.request.username)","priority":"INFO","source":"aws_cloudtrail","tags":["cloud","aws","aws_iam"],"enabled":"true","type":"rule","hash":"41594e8ac3660d1caa934371061ef3da"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L143,L158","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Create Group","rule":"Create Group","condition":"ct.name=\"CreateGroup\" and not ct.error exists","desc":"Detect creation of a new user group.","output":"A new user group has been created. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, group name=%ct.request.groupname)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_iam"],"enabled":"true","type":"rule","hash":"e3be07cece3e122b8197e1916a36ef83"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L160,L175","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Delete Group","rule":"Delete Group","condition":"ct.name=\"DeleteGroup\" and not ct.error exists","desc":"Detect deletion of a user group.","output":"A user group has been deleted. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, group name=%ct.request.groupname)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_iam"],"enabled":"true","type":"rule","hash":"f7f389b820140a98d5ce7387d6b88c86"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L177,L197","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"ECS Service Created","rule":"ECS Service Created","condition":"ct.src=\"ecs.amazonaws.com\" and ct.name=\"CreateService\" and not ct.error exists","desc":"Detect a new service is created in ECS.","output":"A new service has been created in ECS (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, cluster=%ct.request.cluster, service name=%ct.request.servicename, task definition=%ct.request.taskdefinition)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_ecs","aws_fargate"],"enabled":"true","type":"rule","hash":"34144709346c46ff46abc467dc1b1fd8"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L199,L218","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"ECS Task Run or Started","rule":"ECS Task Run or Started","condition":"ct.src=\"ecs.amazonaws.com\" and (ct.name=\"RunTask\" or ct.name=\"StartTask\") and not ct.error exists","desc":"Detect a new task is started in ECS.","output":"A new task has been started in ECS (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, cluster=%ct.request.cluster, task definition=%ct.request.taskdefinition)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_ecs","aws_fargate"],"enabled":"true","type":"rule","hash":"76c74a1a30ea9bcd34253a5e6d0573d1"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L220,L235","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Create Lambda Function","rule":"Create Lambda Function","condition":"ct.name=\"CreateFunction20150331\" and not ct.error exists","desc":"Detect creation of a Lambda function.","output":"Lambda function has been created. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, lambda function=%ct.request.functionname)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_lambda"],"enabled":"true","type":"rule","hash":"6335c345d6a66716bc2e5a83e48710d4"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L237,L252","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Update Lambda Function Code","rule":"Update Lambda Function Code","condition":"ct.name=\"UpdateFunctionCode20150331v2\" and not ct.error exists","desc":"Detect updates to a Lambda function code.","output":"The code of a Lambda function has been updated. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, lambda function=%ct.request.functionname)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_lambda"],"enabled":"true","type":"rule","hash":"26603485845705dd20b65aebffca6afa"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L254,L269","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Update Lambda Function Configuration","rule":"Update Lambda Function Configuration","condition":"ct.name=\"UpdateFunctionConfiguration20150331v2\" and not ct.error exists","desc":"Detect updates to a Lambda function configuration.","output":"The configuration of a Lambda function has been updated. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, lambda function=%ct.request.functionname)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_lambda"],"enabled":"true","type":"rule","hash":"53c92a80241676c138dabf192022bda6"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L271,L288","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Run Instances","rule":"Run Instances","condition":"ct.name=\"RunInstances\" and not ct.error exists","desc":"Detect launching of a specified number of instances.","output":"A number of instances have been launched. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, availability zone=%ct.request.availabilityzone, subnet id=%ct.response.subnetid, reservation id=%ct.response.reservationid)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_ec2"],"enabled":"true","type":"rule","hash":"9c7c12d8f0e68ec0868b7323d11cf7d4"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"# Only instances launched on regions in this list are approved.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L291,L293","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"approved_regions","list":"approved_regions","items":["us-east-0"],"tags":null,"enabled":"true","used_by":["rule:Run Instances in Non-approved Region:c568c3443e4945d1e20f297e4e0e2026"],"type":"list","hash":"ae80dda6a901ab76547a3e978d9ea3a8"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L295,L314","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Run Instances in Non-approved Region","rule":"Run Instances in Non-approved Region","condition":"ct.name=\"RunInstances\" and not ct.error exists and not ct.region in (approved_regions)","desc":"Detect launching of a specified number of instances in a non-approved region.","output":"A number of instances have been launched in a non-approved region. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, availability zone=%ct.request.availabilityzone, subnet id=%ct.response.subnetid, reservation id=%ct.response.reservationid, image id=%json.value[/responseElements/instancesSet/items/0/instanceId])","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_ec2"],"enabled":"true","dependencies":["list:approved_regions:ae80dda6a901ab76547a3e978d9ea3a8"],"type":"rule","hash":"c568c3443e4945d1e20f297e4e0e2026"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L316,L331","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Delete Bucket Encryption","rule":"Delete Bucket Encryption","condition":"ct.name=\"DeleteBucketEncryption\" and not ct.error exists","desc":"Detect deleting configuration to use encryption for bucket storage.","output":"A encryption configuration for a bucket has been deleted (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, bucket=%s3.bucket)","priority":"CRITICAL","source":"aws_cloudtrail","tags":["cloud","aws","aws_s3"],"enabled":"true","type":"rule","hash":"028148ef507046a3725f9859cc2ef6c2"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L333,L353","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Delete Bucket Public Access Block","rule":"Delete Bucket Public Access Block","condition":"ct.name=\"PutBucketPublicAccessBlock\" and not ct.error exists and json.value[/requestParameters/publicAccessBlock]=\"\" and (json.value[/requestParameters/PublicAccessBlockConfiguration/RestrictPublicBuckets]=false or json.value[/requestParameters/PublicAccessBlockConfiguration/BlockPublicPolicy]=false or json.value[/requestParameters/PublicAccessBlockConfiguration/BlockPublicAcls]=false or json.value[/requestParameters/PublicAccessBlockConfiguration/IgnorePublicAcls]=false)","desc":"Detect deleting blocking public access to bucket.","output":"A public access block for a bucket has been deleted (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, bucket=%s3.bucket)","priority":"CRITICAL","source":"aws_cloudtrail","tags":["cloud","aws","aws_s3"],"enabled":"true","type":"rule","hash":"e19c3390914e5f5bf9e68b9582be2f6b"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L355,L371","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"List Buckets","rule":"List Buckets","condition":"ct.name=\"ListBuckets\" and not ct.error exists","desc":"Detect listing of all S3 buckets.","output":"A list of all S3 buckets has been requested. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, host=%ct.request.host)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_s3"],"enabled":"false","type":"rule","hash":"5d5bc5179c22a13a629255b48656b390"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L373,L388","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Put Bucket ACL","rule":"Put Bucket ACL","condition":"ct.name=\"PutBucketAcl\" and not ct.error exists","desc":"Detect setting the permissions on an existing bucket using access control lists.","output":"The permissions on an existing bucket have been set using access control lists. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, bucket name=%s3.bucket)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_s3"],"enabled":"true","type":"rule","hash":"72583c91832241d90a10f6d1ab330369"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L390,L406","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"Put Bucket Policy","rule":"Put Bucket Policy","condition":"ct.name=\"PutBucketPolicy\" and not ct.error exists","desc":"Detect applying an Amazon S3 bucket policy to an Amazon S3 bucket.","output":"An Amazon S3 bucket policy has been applied to an Amazon S3 bucket. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, bucket name=%s3.bucket, policy=%ct.request.policy)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_s3"],"enabled":"true","type":"rule","hash":"dd35f820f9581af6d746c52141384ed5"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L408,L423","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"CloudTrail Trail Created","rule":"CloudTrail Trail Created","condition":"ct.name=\"CreateTrail\" and not ct.error exists","desc":"Detect creation of a new trail.","output":"A new trail has been created. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, trail name=%ct.request.name)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_cloudtrail"],"enabled":"true","type":"rule","hash":"52fccf410111d3bd39c39dacc6326991"},{"file_name":"aws_cloudtrail_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/cloudtrail/rules/aws_cloudtrail_rules.yaml#L425,L440","required_engine_version":"10","required_plugin_versions":[{"name":"cloudtrail","version":"0.10.0"},{"name":"json","version":"0.7.0"}],"name":"CloudTrail Logging Disabled","rule":"CloudTrail Logging Disabled","condition":"ct.name=\"StopLogging\" and not ct.error exists","desc":"The CloudTrail logging has been disabled, this could be potentially malicious.","output":"The CloudTrail logging has been disabled. (requesting user=%ct.user, requesting IP=%ct.srcip, AWS region=%ct.region, resource name=%ct.request.name)","priority":"WARNING","source":"aws_cloudtrail","tags":["cloud","aws","aws_cloudtrail"],"enabled":"true","type":"rule","hash":"5b53707d7dbc58175c8418b2d15cfa43"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L25,L31","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Webhook Connected","rule":"Webhook Connected","condition":"github.type=ping","desc":"Detect a webhook link","output":"A github webhook was linked to this Falco instance (ID=%github.webhook.id type=%github.webhook.type owner=%github.owner user=%github.user)","priority":"DEBUG","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"357e5a18f6e0e9f5b63a7eb33758a6fd"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L33,L39","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Webhook Disconnected","rule":"Webhook Disconnected","condition":"github.type=meta and github.action=deleted","desc":"Detect a webhook unlink","output":"A github webhook was disconnected from Falco instance (ID=%github.webhook.id type=%github.webhook.type org=%github.org user=%github.user)","priority":"DEBUG","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"28cd6785f6cd0252798f295ee779b26a"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L41,L47","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Private Repository Becoming Public","rule":"Private Repository Becoming Public","condition":"github.type=repository and github.action=publicized","desc":"Detect changing the visibility of a repository to public","output":"A repository went from private to public (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"CRITICAL","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"8aa6f25f45d965e0b564d4bf5d86a6bc"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L49,L55","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Public Repository Becoming Private","rule":"Public Repository Becoming Private","condition":"github.type=repository and github.action=privatized","desc":"Detect changing the visibility of a repository to private","output":"A repository went from public to private (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"WARNING","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"f867a1336aff9f0a32c26cfe43f30eb3"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L57,L63","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Create Public Repository","rule":"Create Public Repository","condition":"github.type=repository and github.action=created and github.repo.public=true","desc":"Detect the creation of a new public repository","output":"A new public repository was created (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"WARNING","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"32ddc95900e5967d0f39cc17864316a5"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L65,L71","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Delete Public Repository","rule":"Delete Public Repository","condition":"github.type=repository and github.action=deleted and github.repo.public=true","desc":"Detect the deletion of a public repository","output":"A public repository was deleted (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"WARNING","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"4014f3c0c6eb1ad3fd6e41c6d5d85c73"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L73,L79","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Create Repository","rule":"Create Repository","condition":"github.type=repository and github.action=created","desc":"Detect the creation of a new repository","output":"A new repository was created (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"6d75e32e66e631a0fdbc8a9cad5c1d4e"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L81,L87","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Delete Repository","rule":"Delete Repository","condition":"github.type=repository and github.action=deleted","desc":"Detect the deletion of a repository","output":"A repository was deleted (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"a463888f1331a2014c52bbd78d339fe7"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L89,L95","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Create Deploy Key","rule":"Create Deploy Key","condition":"github.type=deploy_key and github.action=created","desc":"Detect the creation of a new deploy key for a repository","output":"A new deploy key was created (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"b04ae0bfbf266ee7273510e13106ffea"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L97,L103","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Delete Deploy Key","rule":"Delete Deploy Key","condition":"github.type=deploy_key and github.action=deleted","desc":"Detect the deletion a repository's deploy key","output":"A deploy key was deleted (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"4e8579b97922549c848a0a40c21d7301"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L105,L111","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Add Collaborator to Repository","rule":"Add Collaborator to Repository","condition":"github.type=member and github.action=added","desc":"Detect the addition of a collaborator to a repository","output":"A collaborator was added to a repository (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user collaborator=%github.collaborator.name role=%github.collaborator.role)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"b38e980243a329b83261b86d79cc3123"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L113,L119","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Remove Collaborator from Repository","rule":"Remove Collaborator from Repository","condition":"github.type=member and github.action=removed","desc":"Detect the removal of a collaborator from a repository","output":"A collaborator was removed from a repository (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user collaborator=%github.collaborator.name)","priority":"INFO","source":"github","tags":["github"],"enabled":"true","dependencies":["macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:remove:0f6969d7052da9261e31ddb6e88c136e"],"type":"rule","hash":"943741810bf68993058924c0fa203405"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L121,L127","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Secret pushed into a public repository","rule":"Secret pushed into a public repository","condition":"github.type=push and github.diff.has_secrets = true and github.repo.public=true","desc":"A secret (AWS keys, github token...) was committed into a public repository","output":"One or more secrets were pushed into a private repository (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user secret_types=%github.diff.committed_secrets.desc file=%github.diff.committed_secrets.files line=%github.diff.committed_secrets.lines url=%github.diff.committed_secrets.links)","priority":"CRITICAL","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"3bad91dae16b3f8aa4af903be51a9628"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L129,L135","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Secret pushed into a private repository","rule":"Secret pushed into a private repository","condition":"github.type=push and github.diff.has_secrets = true and github.repo.public=false","desc":"A secret (AWS keys, github token...) was committed into a private repository","output":"One or more secrets were pushed into a private repository (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user secret_types=%github.diff.committed_secrets.desc file=%github.diff.committed_secrets.files line=%github.diff.committed_secrets.lines url=%github.diff.committed_secrets.links)","priority":"CRITICAL","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"9f3a0ed9b12a97dd544ba951f73be993"},{"file_name":"github.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/github/rules/github.yaml#L137,L143","required_engine_version":"10","required_plugin_versions":[{"name":"github","version":"0.7.0"}],"name":"Github action with miners","rule":"Github action with miners","condition":"github.type=workflow_run and github.action=requested and github.workflow.has_miners=true","desc":"a github action containing crypto miners was executed","output":"a github action containing crypto miners was executed (repository=%github.repo repo_owner=%github.owner org=%github.org user=%github.user file=%github.workflow.filename)","priority":"CRITICAL","source":"github","tags":["github"],"enabled":"true","type":"rule","hash":"12138870e633cb5410005bd73af34618"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L27,L28","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_binded_delta_to_public","macro":"is_binded_delta_to_public","condition":"gcp.policyDelta contains \"ADD\" and (gcp.policyDelta contains \"allAuthenticatedUsers\" or gcp.policyDelta contains \"allUsers\")\n","tags":null,"enabled":"true","used_by":["rule:GCP Bucket configured to be public:c72cc419c4f24905a54d688c1535b6a0","rule:GCP Bucket objects configured to be public:d48246f3978ec6722cd9eae9044325c3","rule:GCP BigQuery Dataset access configured to be public:1b04e6c7e89d30feeff5f4716c7ceb25"],"type":"macro","hash":"84d2d419153ce176b6e8449dd19c5b38"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L32,L33","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_bigquery_service","macro":"is_bigquery_service","condition":"gcp.serviceName=\"bigquery.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP BigQuery Dataset access configured to be public:1b04e6c7e89d30feeff5f4716c7ceb25"],"type":"macro","hash":"309dd764be8a0320d174072cb53b27c7"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L35,L36","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_crm_service","macro":"is_crm_service","condition":"gcp.serviceName=\"cloudresourcemanager.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP IAM policy modified:99e189954467681d2eba010890433284"],"type":"macro","hash":"489b2cc8a51f305cdde16d101bc76d07"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L38,L39","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_gcs_service","macro":"is_gcs_service","condition":"gcp.serviceName=\"storage.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP Bucket configured to be public:c72cc419c4f24905a54d688c1535b6a0","rule:GCP Bucket objects configured to be public:d48246f3978ec6722cd9eae9044325c3","rule:GCP Bucket enumerated:10eb3a11e84dfb8b7c0e6b3335539adb","rule:GCP Bucket deleted:6063c9c76c6327605e84db7dde570d5e","rule:GCP Bucket updated:f5e47bc60e7e0d03c7f87e3816530b97","rule:GCP Bucket permissions modified:33a7142c9343b70e39d2bcee044e9f99"],"type":"macro","hash":"9a4d1ba58cf9d3f6351b431ee3e6885b"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L41,L42","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_cloudfunctions_service","macro":"is_cloudfunctions_service","condition":"gcp.serviceName=\"cloudfunctions.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP cloud function created:96a91d7666a6ecd40e353dcf312715bd","rule:GCP cloud function deleted:3162ec8d5c7f57f79c301afba624ea91","rule:GCP cloud function modified:ffd04bce3e16a90ba30536cd72685d5d"],"type":"macro","hash":"d54f0508d2fd9e00de3c36d1fdd5356a"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L44,L45","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_kms_service","macro":"is_kms_service","condition":"gcp.serviceName=\"cloudkms.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP KMS keyring created:5539678ad4d049348788218c065288dd","rule:GCP KMS created:77b2af37cddb31da4faa84b21de8a147","rule:GCP KMS updated:b98f92a6a672b613b5d6f183553adc85","rule:GCP KMS deleted:79bd2b031018a37614ae719b006e5f52"],"type":"macro","hash":"f00116b4bddd9287d2e310a160fdb8bf"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L47,L48","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_pubsub_service","macro":"is_pubsub_service","condition":"gcp.serviceName=\"pubsub.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP Pub/Sub topic deleted:91149d848ccf5d745884df70df35cfa6","rule:GCP Pub/Sub subscription modified:32cb0dd144a9cefdefc1f9ff82ce7dc6","rule:GCP Pub/Sub subscription deleted:04bbcf62a909e8d6b85ed6bf9a4ec7da"],"type":"macro","hash":"b3b8d94ecda3e948a9116419104d161d"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L50,L51","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_compute_service","macro":"is_compute_service","condition":"gcp.serviceName=\"compute.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP VM modified:20154d58930280f1f688a52a40780646","rule:GCP VM stopped:047b58b78894bf17792667d9507b6f84","rule:GCP GCE Firewall rule modified:fa5f1a0d363622db805b1da4bfbe33ae","rule:GCP WAF Network policy modified:ea9d6ae148573635aa52476eb059d08d","rule:GCP WAF rule modified or deleted:8306e720ad3a1f2cf34fad7d791fc6f5","rule:GCP CloudArmor edge security service modified:c2e9e0c777c9fd685986808198e34262","rule:GCP backend service deleted:366b06dc86b4f3012b435a9b8e09ad35"],"type":"macro","hash":"ce8b2682446938de2af5aa40d05d9d71"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L53,L54","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_iam_service","macro":"is_iam_service","condition":"gcp.serviceName=\"iam.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP IAM service account created:b175add7a555476a32a006cec84a317e","rule:GCP IAM service account deleted:316af8b9eefa48cdb26c11daba8181b2","rule:GCP IAM service account modified:40a25797d027ba4839fa611dcb08435f","rule:GCP IAM service account key created:6cb3039deb4e30ef2e53da015e35a7e5","rule:GCP IAM service account key deleted:e0d1f230648dd0b6e7ceaf5e23910535","rule:GCP IAM custom role created:1f80950fdb537372d5a9530fa55336ae","rule:GCP IAM custom role modified:1d2c5dad99a9d9f5ab74539890cd643e"],"type":"macro","hash":"cfa403d7dd93ea990b2809ad898af209"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L56,L57","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_logging_service","macro":"is_logging_service","condition":"gcp.serviceName=\"logging.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP logging sink modified:ff8a3f8ceccc8b65ad17c432896a9b62","rule:GCP logging sink deleted:91013b69eed7b5f45f8189f35772a8f0"],"type":"macro","hash":"bbaef6d8c9ea001da1cef21dfb68b682"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L59,L60","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"is_cloudsql_service","macro":"is_cloudsql_service","condition":"gcp.serviceName=\"cloudsql.googleapis.com\"","tags":null,"enabled":"true","used_by":["rule:GCP Cloud SQL database user modified or deleted:1701d3c81ed3c11f97678576e02fd909","rule:GCP Cloud SQL database backup deleted:3bb479179a87f0a8487e0a35e7d918af","rule:GCP Cloud SQL database instance data exported:30c7ac7e5023b027ba17f60a4de546cc","rule:GCP Cloud SQL database instance deleted:2fcad4755277a549ba0ea21ee2ca0db4","rule:GCP Cloud SQL database instance modified or created:aa0fe9ea33e3d68a04b9f51fe1d56723"],"type":"macro","hash":"77d1b43a8143d347a26ec2ade4a41564"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L62,L74","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Cloud SQL database user modified or deleted","rule":"GCP Cloud SQL database user modified or deleted","condition":"is_cloudsql_service and (gcp.methodName=\"cloudsql.users.update\" or gcp.methodName=\"cloudsql.users.delete\")\n","desc":"Detect when a Cloud SQL DB user has been modified or deleted.","output":"project=%gcp.projectId  A CloudSQL DB user has been updated by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request databaseName=%gcp.cloudsql.databaseId\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","cloudsql","compliance"],"enabled":"true","dependencies":["macro:is_cloudsql_service:77d1b43a8143d347a26ec2ade4a41564","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"1701d3c81ed3c11f97678576e02fd909"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L76,L86","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Cloud SQL database backup deleted","rule":"GCP Cloud SQL database backup deleted","condition":"is_cloudsql_service and gcp.methodName=\"cloudsql.backupRuns.delete\"","desc":"Detect when a Cloud SQL DB backup has been deleted.","output":"project=%gcp.projectId A Cloud SQL DB backup has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request databaseName=%gcp.cloudsql.databaseId\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","cloudsql","impact","T1490-inhibit-system-recovery"],"enabled":"true","dependencies":["macro:is_cloudsql_service:77d1b43a8143d347a26ec2ade4a41564","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"3bb479179a87f0a8487e0a35e7d918af"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L89,L99","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Cloud SQL database instance data exported","rule":"GCP Cloud SQL database instance data exported","condition":"is_cloudsql_service and gcp.methodName=\"cloudsql.instances.export\"","desc":"Detect when a Cloud SQL DB instance data has been exported to cloud storage bucket.","output":"project=%gcp.projectId A Cloud SQL DB instance data has been exported to a cloud storage bucket by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request databaseName=%gcp.cloudsql.databaseId\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","cloudsql","data-exfiltration","T1567-exfiltration-to-Cloud-Storage"],"enabled":"true","dependencies":["macro:is_cloudsql_service:77d1b43a8143d347a26ec2ade4a41564","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"30c7ac7e5023b027ba17f60a4de546cc"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L101,L111","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Cloud SQL database instance deleted","rule":"GCP Cloud SQL database instance deleted","condition":"is_cloudsql_service and gcp.methodName=\"cloudsql.instances.delete\"","desc":"Detect when a Cloud SQL DB instance has been deleted.","output":"project=%gcp.projectId A Cloud SQL DB instance has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request databaseName=%gcp.cloudsql.databaseId\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","cloudsql","impact","T1485-data-destruction"],"enabled":"true","dependencies":["macro:is_cloudsql_service:77d1b43a8143d347a26ec2ade4a41564","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"2fcad4755277a549ba0ea21ee2ca0db4"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L113,L126","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Cloud SQL database instance modified or created","rule":"GCP Cloud SQL database instance modified or created","condition":"is_cloudsql_service and (gcp.methodName=\"cloudsql.instances.update\"  or gcp.methodName=\"cloudsql.instances.create\"  or gcp.methodName=\"cloudsql.instances.patch\")\n","desc":"Detect when a Cloud SQL DB instance has been modified or created.","output":"project=%gcp.projectId A Cloud SQL DB instance has been modified or created by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request databaseName=%gcp.cloudsql.databaseId\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","cloudsql","compliance"],"enabled":"true","dependencies":["macro:is_cloudsql_service:77d1b43a8143d347a26ec2ade4a41564","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"aa0fe9ea33e3d68a04b9f51fe1d56723"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L128,L138","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket configured to be public","rule":"GCP Bucket configured to be public","condition":"is_gcs_service and gcp.methodName=\"storage.setIamPermissions\" and is_binded_delta_to_public","desc":"Detect when access on a GCP Bucket is granted to the public internet.","output":"project=%gcp.projectId A GCP bucket has been granted public access by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  bindedDelta=%gcp.policyDelta authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request bucketName=%gcp.storage.bucket  \n","priority":"CRITICAL","source":"gcp_auditlog","tags":["GCP","buckets","compliance"],"enabled":"true","dependencies":["macro:is_binded_delta_to_public:84d2d419153ce176b6e8449dd19c5b38","macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"c72cc419c4f24905a54d688c1535b6a0"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L140,L153","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket objects configured to be public","rule":"GCP Bucket objects configured to be public","condition":"is_gcs_service  and gcp.methodName=\"storage.objects.update\"  and is_binded_delta_to_public\n","desc":"Detect when access on a GCP Bucket objects has been granted to the public internet.","output":"project=%gcp.projectId Access to a A GCP bucket object has been granted public access by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request bucketName=%gcp.storage.bucket \n","priority":"CRITICAL","source":"gcp_auditlog","tags":["GCP","buckets","objects","compliance"],"enabled":"true","dependencies":["macro:is_binded_delta_to_public:84d2d419153ce176b6e8449dd19c5b38","macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"d48246f3978ec6722cd9eae9044325c3"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L155,L165","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket enumerated","rule":"GCP Bucket enumerated","condition":"is_gcs_service and gcp.methodName=\"storage.buckets.list\"","desc":"Detect deletion of a GCS bucket.","output":"project=%gcp.projectId A GCS bucket's content has been listed to user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request bucketName=%gcp.storage.bucket\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","buckets","TA0007-discovery","T1083-file-and-directory-discovery"],"enabled":"true","dependencies":["macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"10eb3a11e84dfb8b7c0e6b3335539adb"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L167,L177","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket deleted","rule":"GCP Bucket deleted","condition":"is_gcs_service and gcp.methodName=\"storage.buckets.delete\"","desc":"Detect deletion of a GCS bucket.","output":"project=%gcp.projectId  A GCS bucket has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request bucketName=%gcp.storage.bucket\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","buckets","mitre_data_destruction"],"enabled":"true","dependencies":["macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"6063c9c76c6327605e84db7dde570d5e"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L179,L188","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket updated","rule":"GCP Bucket updated","condition":"is_gcs_service and gcp.methodName=\"storage.buckets.update\"","desc":"Detect when an administrative change to a GCS Bucket has been made.","output":"project=%gcp.projectId A GCS bucket has been updated by user=%gcp.user callerip=%gcp.callerIP useragent=%gcp.userAgent  service=%gcp.serviceName method=%gcp.methodName zones= bucketName=%gcp.storage.bucket rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","buckets","compliance"],"enabled":"true","dependencies":["macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"f5e47bc60e7e0d03c7f87e3816530b97"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L190,L201","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Bucket permissions modified","rule":"GCP Bucket permissions modified","condition":"is_gcs_service and gcp.methodName=\"storage.setIamPermissions\"","desc":"Detect when permissions have changed on a GCS Bucket.","output":"project=%gcp.projectId A GCS bucket Iam policy has been changed by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request bucketName=%gcp.storage.bucket\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","buckets","compliance"],"enabled":"true","dependencies":["macro:is_gcs_service:9a4d1ba58cf9d3f6351b431ee3e6885b","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"33a7142c9343b70e39d2bcee044e9f99"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L203,L217","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP BigQuery Dataset access configured to be public","rule":"GCP BigQuery Dataset access configured to be public","condition":"is_bigquery_service and gcp.methodName=\"google.iam.v1.IAMPolicy.SetIamPolicy\"  and is_binded_delta_to_public\n","desc":"Detect when access on a BigQuery Dataset has been set to public.","output":"project=%gcp.projectId Access to a GCP Bigquery has been set to public by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request datasetName=%json.value[/resource/labels/dataset_id]\n","priority":"CRITICAL","source":"gcp_auditlog","tags":["GCP","bigquery","datasets","compliance"],"enabled":"true","dependencies":["macro:is_binded_delta_to_public:84d2d419153ce176b6e8449dd19c5b38","macro:is_bigquery_service:309dd764be8a0320d174072cb53b27c7","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"1b04e6c7e89d30feeff5f4716c7ceb25"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L219,L234","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP VM modified","rule":"GCP VM modified","condition":"is_compute_service and (gcp.methodName contains \"compute.instances.insert\"  or gcp.methodName contains \"compute.instances.update\"  or gcp.methodName contains \"compute.instances.setServiceAccount\" or gcp.methodName contains \"compute.instances.setIamPolicy\" or gcp.methodName contains \"compute.instances.updateAccessConfig\" or gcp.methodName contains \"compute.instances.updateNetworkInterface\")\n","desc":"Detect when a virtual machine is modified or created.","output":"project=%gcp.projectId A GCP VM has been created or modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","VM","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"20154d58930280f1f688a52a40780646"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L237,L246","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP VM stopped","rule":"GCP VM stopped","condition":"is_compute_service and (gcp.methodName contains \"compute.instances.stop\")","desc":"Detect when a virtual machine is stopped.","output":"project=%gcp.projectId A GCP VM has been stopped by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","VM","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"047b58b78894bf17792667d9507b6f84"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L249,L261","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP GCE Firewall rule modified","rule":"GCP GCE Firewall rule modified","condition":"is_compute_service and (gcp.methodName contains \"compute.firewalls.delete\"  or gcp.methodName contains \"compute.firewalls.patch\"  or gcp.methodName contains \"compute.firewalls.insert\")\n","desc":"Detect when a firewall rule is created, modified or deleted.","output":"project=%gcp.projectId A GCP GCE Firewall rule was modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Firewall","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"fa5f1a0d363622db805b1da4bfbe33ae"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L264,L277","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP WAF Network policy modified","rule":"GCP WAF Network policy modified","condition":"is_compute_service and (gcp.methodName contains \"compute.securityPolicies.delete\"  or gcp.methodName contains \"compute.securityPolicies.insert\"  or gcp.methodName contains \"compute.securityPolicies.patch\")\n","desc":"Detect when a WAF Network policy is created, modified or deleted.","output":"project=%gcp.projectId A GCP WAF network policy or waf rule was modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.methodName rawRequest=%gcp.request policyName=%json.value[/resource/labels/policy_name]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","WAF","CloudArmor","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"ea9d6ae148573635aa52476eb059d08d"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L280,L293","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP WAF rule modified or deleted","rule":"GCP WAF rule modified or deleted","condition":"is_compute_service and (gcp.methodName contains \"compute.securityPolicies.removeRule\"  or gcp.methodName contains \"compute.securityPolicies.addRule\"  or gcp.methodName contains \"compute.securityPolicies.patchRule\")\n","desc":"Detect when a WAF rule is created, modified or deleted.","output":"project=%gcp.projectId A GCP WAF network policy or waf rule was modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo rawRequest=%gcp.request policyName=%json.value[/resource/labels/policy_name]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","WAF","CloudArmor","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"8306e720ad3a1f2cf34fad7d791fc6f5"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L296,L310","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP CloudArmor edge security service modified","rule":"GCP CloudArmor edge security service modified","condition":"is_compute_service and (gcp.methodName contains \"compute.networkEdgeSecurityServices.delete\"  or gcp.methodName contains \"compute.networkEdgeSecurityServices.create\"  or gcp.methodName contains \"compute.networkEdgeSecurityServices.update\")\n","desc":"Detect when a CloudArmor edge security service was created, modified or deleted.","output":"project=%gcp.projectId A GCP CloudArmor edge security service was modified by user=%gcp.user user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request policyName=%json.value[/resource/labels/policy_name]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","WAF","CloudArmor","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"c2e9e0c777c9fd685986808198e34262"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L313,L323","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP backend service deleted","rule":"GCP backend service deleted","condition":"is_compute_service and (gcp.methodName contains \"compute.backendServices.delete\")","desc":"Detect when a backend service is deleted.","output":"project=%gcp.projectId A GCP backend service was deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","backendService","T1498-DOS"],"enabled":"true","dependencies":["macro:is_compute_service:ce8b2682446938de2af5aa40d05d9d71","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"366b06dc86b4f3012b435a9b8e09ad35"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L326,L336","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM service account created","rule":"GCP IAM service account created","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.CreateServiceAccount\")","desc":"Detect when a serviceAccount is created.","output":"project=%gcp.projectId A GCP service account was created by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"b175add7a555476a32a006cec84a317e"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L339,L349","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM service account deleted","rule":"GCP IAM service account deleted","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.DeleteServiceAccount\")","desc":"Detect when a service account deleted.","output":"project=%gcp.projectId A GCP service account was deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"316af8b9eefa48cdb26c11daba8181b2"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L351,L361","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM service account modified","rule":"GCP IAM service account modified","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.UpdateServiceAccount\")","desc":"Detect when a service account is modified.","output":"project=%gcp.projectId A GCP service account was modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"40a25797d027ba4839fa611dcb08435f"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L364,L374","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM service account key created","rule":"GCP IAM service account key created","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.CreateServiceAccountKey\")","desc":"Detect when a serviceAccount key is created.","output":"project=%gcp.projectId A GCP service account key was created by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"6cb3039deb4e30ef2e53da015e35a7e5"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L377,L387","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM service account key deleted","rule":"GCP IAM service account key deleted","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.DeleteServiceAccountKey\")","desc":"Detect when a service account key is deleted.","output":"project=%gcp.projectId A GCP service account key was deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"e0d1f230648dd0b6e7ceaf5e23910535"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L389,L399","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM custom role created","rule":"GCP IAM custom role created","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.CreateRole\")","desc":"Detect when an IAM custom role is created.","output":"project=%gcp.projectId A GCP IAM custom role was created by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"1f80950fdb537372d5a9530fa55336ae"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L401,L411","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM custom role modified","rule":"GCP IAM custom role modified","condition":"is_iam_service and (gcp.methodName=\"google.iam.admin.v1.UpdateRole\")","desc":"Detect when an IAM custom role is modified.","output":"project=%gcp.projectId A GCP IAM custom role was modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_iam_service:cfa403d7dd93ea990b2809ad898af209","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"1d2c5dad99a9d9f5ab74539890cd643e"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L413,L423","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP IAM policy modified","rule":"GCP IAM policy modified","condition":"is_crm_service and (gcp.methodName=\"SetIamPolicy\")","desc":"Detect when an IAM policy is modified.","output":"project=%gcp.projectId A GCP IAM policy was modified by user=%gcp.user bindingPolicy=%gcp.policyDelta userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","IAM","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_crm_service:489b2cc8a51f305cdde16d101bc76d07","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"99e189954467681d2eba010890433284"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L426,L437","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP cloud function created","rule":"GCP cloud function created","condition":"is_cloudfunctions_service and (gcp.methodName=\"google.cloud.functions.v1.CloudFunctionsService.CreateFunction\")","desc":"Detect when a cloud function is created.","output":"project=%gcp.projectId A GCP cloud function was created by  user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request functionName=%gcp.cloudfunctions.function\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","CloudFunction","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_cloudfunctions_service:d54f0508d2fd9e00de3c36d1fdd5356a","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"96a91d7666a6ecd40e353dcf312715bd"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L439,L450","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP cloud function deleted","rule":"GCP cloud function deleted","condition":"is_cloudfunctions_service and (gcp.methodName=\"google.cloud.functions.v1.CloudFunctionsService.DeleteFunction\")","desc":"Detect when a cloud function is deleted.","output":"project=%gcp.projectId A GCP cloud function was deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request functionName=%gcp.cloudfunctions.function\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","CloudFunction","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_cloudfunctions_service:d54f0508d2fd9e00de3c36d1fdd5356a","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"3162ec8d5c7f57f79c301afba624ea91"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L452,L464","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP cloud function modified","rule":"GCP cloud function modified","condition":"is_cloudfunctions_service and (gcp.methodName=\"google.cloud.functions.v1.CloudFunctionsService.UpdateFunction\")\n","desc":"Detect when a cloud function is modified.","output":"project=%gcp.projectId A GCP cloud function was modiefied by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request functionName=%gcp.cloudfunctions.function\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","CloudFunction","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_cloudfunctions_service:d54f0508d2fd9e00de3c36d1fdd5356a","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"ffd04bce3e16a90ba30536cd72685d5d"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L466,L477","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP KMS keyring created","rule":"GCP KMS keyring created","condition":"is_kms_service and gcp.methodName=\"CreateKeyRing\"","desc":"Detect when a KMS keyring is created.","output":"project=%gcp.projectId A GCP KMS key ring was created by by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request ringName=%json.value[/resource/labels/key_ring_id]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","KMS","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_kms_service:f00116b4bddd9287d2e310a160fdb8bf","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"5539678ad4d049348788218c065288dd"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L479,L490","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP KMS created","rule":"GCP KMS created","condition":"is_kms_service and gcp.methodName=\"CreateCryptoKey\"","desc":"Detect when a KMS key is created.","output":"project=%gcp.projectId A GCP KMS key was created by by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request keyName=%json.value[/resource/labels/crypto_key_id]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","KMS","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_kms_service:f00116b4bddd9287d2e310a160fdb8bf","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"77b2af37cddb31da4faa84b21de8a147"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L492,L504","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP KMS updated","rule":"GCP KMS updated","condition":"is_kms_service and (gcp.methodName=\"UpdateCryptoKey\")\n","desc":"Detect when a KMS key is updated","output":"project=%gcp.projectId A GCP KMS key was updated by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request keyName=%json.value[/resource/labels/crypto_key_id]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","KMS","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_kms_service:f00116b4bddd9287d2e310a160fdb8bf","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"b98f92a6a672b613b5d6f183553adc85"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L506,L518","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP KMS deleted","rule":"GCP KMS deleted","condition":"is_kms_service and (gcp.methodName=\"DestroyCryptoKeyVersion\")\n","desc":"Detect when a KMS key is deleted","output":"project=%gcp.projectId A GCP KMS was deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request keyName=%json.value[/resource/labels/crypto_key_id]\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","KMS","abuse-elevation-control-mechanism"],"enabled":"true","dependencies":["macro:is_kms_service:f00116b4bddd9287d2e310a160fdb8bf","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"79bd2b031018a37614ae719b006e5f52"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L520,L530","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Pub/Sub topic deleted","rule":"GCP Pub/Sub topic deleted","condition":"is_pubsub_service and gcp.methodName=\"google.pubsub.v1.Publisher.DeleteTopic\"","desc":"Detect when a GCP Pub/Sub topic has been deleted. This could stop audit logs from being sent to the GCP Audit Log plugin.","output":"project=%gcp.projectId A GCP Pub/Sub topic has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Pub/Sub","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_pubsub_service:b3b8d94ecda3e948a9116419104d161d","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"91149d848ccf5d745884df70df35cfa6"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L532,L543","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Pub/Sub subscription modified","rule":"GCP Pub/Sub subscription modified","condition":"is_pubsub_service and (gcp.methodName=\"google.pubsub.v1.Subscriber.UpdateSubscription\")\n","desc":"Detect when a GCP Pub/Sub subscription has been modified. This could stop audit logs from being sent to the GCP Audit Log plugin.","output":"project=%gcp.projectId A GCP Pub/Sub subscription has been modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Pub/Sub","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_pubsub_service:b3b8d94ecda3e948a9116419104d161d","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"32cb0dd144a9cefdefc1f9ff82ce7dc6"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L545,L556","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP Pub/Sub subscription deleted","rule":"GCP Pub/Sub subscription deleted","condition":"is_pubsub_service and (gcp.methodName=\"google.pubsub.v1.Subscriber.DeleteSubscription\")\n","desc":"Detect when a GCP Pub/Sub subscription has been deleted. This could stop audit logs from being sent to the GCP Audit Log plugin.","output":"project=%gcp.projectId A GCP Pub/Sub subscription has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Pub/Sub","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_pubsub_service:b3b8d94ecda3e948a9116419104d161d","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"04bbcf62a909e8d6b85ed6bf9a4ec7da"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L559,L570","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP logging sink modified","rule":"GCP logging sink modified","condition":"is_logging_service and (gcp.methodName=\"google.logging.v2.ConfigServiceV2.UpdateSink\")\n","desc":"Detect when a GCP logging sink has been modified. This could stop audit logs from being sent to the GCP Audit Log plugin.","output":"project=%gcp.projectId A GCP Pub/Sub subscription has been modified by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Sink","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_logging_service:bbaef6d8c9ea001da1cef21dfb68b682","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"ff8a3f8ceccc8b65ad17c432896a9b62"},{"file_name":"gcp_auditlog_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/gcpaudit/rules/gcp_auditlog_rules.yaml#L572,L583","required_engine_version":"11","required_plugin_versions":[{"name":"gcpaudit","version":"0.3.0"},{"name":"json","version":"0.7.0"}],"name":"GCP logging sink deleted","rule":"GCP logging sink deleted","condition":"is_logging_service and (gcp.methodName=\"google.logging.v2.ConfigServiceV2.DeleteSink\")\n","desc":"Detect when a GCP logging sink has been deleted. This could stop audit logs from being sent to the GCP Audit Log plugin.","output":"project=%gcp.projectId A GCP Pub/Sub subscription has been deleted by user=%gcp.user userIP=%gcp.callerIP userAgent=%gcp.userAgent  authorizationInfo=%gcp.authorizationInfo  rawRequest=%gcp.request\n","priority":"NOTICE","source":"gcp_auditlog","tags":["GCP","Sink","TA0005-defense-evasion","T1562-impair-defenses"],"enabled":"true","dependencies":["macro:is_logging_service:bbaef6d8c9ea001da1cef21dfb68b682","macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"type":"rule","hash":"91013b69eed7b5f45f8189f35772a8f0"},{"file_name":"falco_rules.yaml","comment":"# Currently disabled as read/write are ignored syscalls. The nearly\n# similar open_write/open_read check for files being opened for\n# reading/writing.\n# - macro: write\n#   condition: (syscall.type=write and fd.type in (file, directory))\n# - macro: read\n#   condition: (syscall.type=read and evt.dir=\u003e and fd.type in (file, directory))\n","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L38,L39","required_engine_version":"0.31.0","name":"open_write","macro":"open_write","condition":"(evt.type in (open,openat,openat2) and evt.is_open_write=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:truncate_shell_history:ac78bdcd5d832a2f504b6e3ce03a6868","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3"],"type":"macro","hash":"43a1a1a71582531905f162ae8757ecda","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L41,L42","required_engine_version":"0.31.0","name":"open_read","macro":"open_read","condition":"(evt.type in (open,openat,openat2) and evt.is_open_read=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","rule:Backdoored library loaded into SSHD (CVE-2024-3094):6a98bda365511a682502887ba09fb757","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"macro","hash":"fada70dac63821c34b095b962e02cb36","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Failed file open attempts, useful to detect threat actors making mistakes\n# https://man7.org/linux/man-pages/man3/errno.3.html\n# evt.res=ENOENT - No such file or directory\n# evt.res=EACCESS - Permission denied","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L48,L49","required_engine_version":"0.31.0","name":"open_file_failed","macro":"open_file_failed","condition":"(evt.type in (open,openat,openat2) and fd.typechar='f' and fd.num=-1 and evt.res startswith E)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f"],"type":"macro","hash":"79b6d9042977e497bec0d62841125fa4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# This macro `never_true` is used as placeholder for tuning negative logical sub-expressions, for example\n# - macro: allowed_ssh_hosts\n#   condition: (never_true)\n# can be used in a rules' expression with double negation `and not allowed_ssh_hosts` which effectively evaluates\n# to true and does nothing, the perfect empty template for `logical` cases as opposed to list templates.\n# When tuning the rule you can override the macro with something useful, e.g.\n# - macro: allowed_ssh_hosts\n#   condition: (evt.hostname contains xyz)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L59,L60","required_engine_version":"0.31.0","name":"never_true","macro":"never_true","condition":"(evt.num=0)","tags":null,"enabled":"true","used_by":["macro:user_known_read_sensitive_files_activities:93013fdd38f628311bbd04ebd0e01436","macro:possibly_node_in_container:513181c67b31a65f5956a1911a700134","macro:possibly_parent_java_running_tomcat:ff2e34a96a3a090dab697eb7bef460f0","macro:user_known_system_user_login:c220c191248c206685113a98cf6cc4f4","macro:user_expected_terminal_shell_in_container_conditions:506bd5cc090648cf6e9411357909e53d","macro:user_shell_container_exclusions:f0b59b425c9d3204fb50ec6e436e8cd7","macro:user_known_contact_k8s_api_server_activities:4c6ed813572d74073bccdf798a240244","macro:grep_more:1f162d2b9d80645c0c17e19656463e53","macro:allowed_clear_log_files:27cabc017fb347048c5906d368af02da","macro:user_known_remove_data_activities:82aeff15fb6a39dfd18eb8a0aa4490b2","macro:user_known_stand_streams_redirect_activities:c2f8c69b4ec7a2b55cd5ce0381586875","macro:known_drop_and_execute_activities:a1a1ce54329c3cd6f627d9bdc5e50ea8","macro:user_known_node_port_service:eef8c8cb2dddbde98acc0032c8437a1e","macro:user_known_exec_pod_activities:654a93971e99c9f7b3bb5a8614b96d7f","macro:user_known_portforward_activities:c1bda959367c501d28cf34ac7b327cd5","macro:user_known_pod_debug_activities:f680ce82ade487e7d4c6d0bcf300391a","macro:consider_all_events:38d89891d1f279c05021c92e24eee45a","macro:user_known_shell_config_modifiers:6b8f57e70346a317add4e1e9046c3660","macro:user_known_cron_jobs:e19053b1c16c7ae8df45015aafbe5355","macro:user_known_read_ssh_information_activities:66b9d639d9ffb5e4aec0837ef7b1a7f2","macro:user_known_db_spawned_processes:e9782b773c4c9b7a5b5c0c30a23a0662","macro:user_known_change_thread_namespace_activities:be737247cfb371d8c20ef23aab8bed09","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_privileged_containers:605f400a686e1bec4f1e18414be552c5","macro:user_expected_system_procs_network_activity_conditions:2c633a138f025b38353d5ed0477bfd72","macro:allowed_ssh_proxy_env:ee1096508e1dd9b7b7b2a990d6fd1cb5","macro:user_known_user_management_activities:23d1a029d115829da2c3d05ddc8ba459","macro:user_known_create_files_below_dev_activities:e252bfb734f01b620917e7724e620572","macro:ec2_metadata_containers:d5f0dfcd1bb7ef57fab8910ab3796682","macro:user_known_package_manager_in_container:e9db6635f0430b51de8b303990f927a7","macro:user_known_network_tool_activities:9b807c4e0d8ba042426b117cdced8023","macro:user_known_set_setuid_or_setgid_bit_conditions:8d6a4ea3d29f9754bb194645d6826e7e","macro:user_known_remote_file_copy_activities:5847045134b24363470fbdeb3e4ddbdf","macro:user_known_mount_in_privileged_containers:aeaf73de6e782cca5767eccf444dfc86","macro:user_known_ingress_remote_file_copy_activities:4e472f54aebecefce22864525e76104b","macro:user_known_update_package_registry:9e4592918895a4946eeab7a831fd4c7c","macro:user_known_write_below_binary_dir_activities:e9327cc6148dd2254c56add6bdca831d","macro:user_known_write_monitored_dir_conditions:08d473341b14e4bbae4157a75faab7f7","macro:etckeeper_activities:1e5781086c2cc3322cf517ae6e095ccc","macro:user_known_write_below_etc_activities:1481c66148493216582035ff05ba2863","macro:user_known_write_below_root_activities:b1f944844634ff62884377a1e56fca2a","macro:user_known_write_rpm_database_activities:c772da1c64ba873faf57a17e5c0af342","macro:user_known_modify_bin_dir_activities:22c60c5fe87a748d783a1bf606652cd6","macro:user_known_mkdir_bin_dir_activities:07904727e6d103f3e4cec0b46f15466d","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_sensitive_mount_containers:f0bae3b600b45943c88848d69ff0511b","macro:nodeport_containers:d08e4abe1246be2869449a98762daa05","macro:user_known_create_hidden_file_activities:c604f50751c1133a076f8194b9f04921","macro:user_known_container_drift_activities:46ac0d3ff6fcf7d1fec5e687faf159f5"],"type":"macro","hash":"7fdab030a488289fce9f593757b50ba3","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# In some cases, such as dropped system call events, information about\n# the process name may be missing. For some rules that really depend\n# on the identity of the process performing an action such as opening\n# a file, etc., we require that the process name be known.\n# TODO: At the moment we keep the `N/A` variant for compatibility with old scap-files","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L78,L79","required_engine_version":"0.31.0","name":"proc_name_exists","macro":"proc_name_exists","condition":"(not proc.name in (\"\u003cNA\u003e\",\"N/A\"))","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:PTRACE attached to process:061f25635ba16ec4c05dec23396e4a6d","rule:PTRACE anti-debug attempt:2552a1ec1bd48915c8e2f2279ea7054e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"453387eaa91c2ac2bd725502766ed7d3","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L81,L82","required_engine_version":"0.31.0","name":"spawned_process","macro":"spawned_process","condition":"(evt.type in (execve, execveat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","rule:Search Private Keys or Passwords:55941ff25a7d8c6253b5a17e4ed20d30","rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Find AWS Credentials:6f600d3da731ed8b36a42b3e6edc613a","rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Fileless execution via memfd_create:421925c119255e3807c6bbf9609c23cb","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7","rule:Program run with disallowed http proxy env:cf0f7f713bd9ca1baa7ef93da5ca1a3a","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Potential Local Privilege Escalation via Environment Variables Misuse:5ab919338a6e3deab238595f8895a76c","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Detect crypto miners using the Stratum protocol:b22719ac071b8de3c7e0ec92dcab21cb","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Sudo Potential Privilege Escalation:f1e70442dbd3656e78ceb11d3863b239","rule:Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034):5bc83b5d4fdd9b976dabc965dfe05fee","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81","rule:Basic Interactive Reconnaissance:f919d2aa742cf1ef21907e9e3d805ca1"],"type":"macro","hash":"b684ebf37c34399a595a3791398d95b2","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L84,L85","required_engine_version":"0.31.0","name":"create_symlink","macro":"create_symlink","condition":"(evt.type in (symlink, symlinkat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Create Symlink Over Sensitive Files:2bcdd8e246ad13d6937576a2d5cbce01"],"type":"macro","hash":"35e03553351704bb106cfe6792249297","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L87,L88","required_engine_version":"0.31.0","name":"create_hardlink","macro":"create_hardlink","condition":"(evt.type in (link, linkat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Create Hardlink Over Sensitive Files:44f504a9337c5c86699a0cb02a0a355d"],"type":"macro","hash":"8793cb40375e36decc9d0527e9a044db","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L90,L91","required_engine_version":"0.31.0","name":"kernel_module_load","macro":"kernel_module_load","condition":"(evt.type in (init_module, finit_module) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Linux Kernel Module Injection Detected:41258ebe4f0565b8c3c1ddd96663c1a6"],"type":"macro","hash":"3a34b01673a16b2e4d0286248a2b024e","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L93,L94","required_engine_version":"0.31.0","name":"dup","macro":"dup","condition":"(evt.type in (dup, dup2, dup3) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Redirect STDOUT/STDIN to Network Connection in Container:3448315ac2834f28f611653e79764663","macro:duply_writing_exclude_files:7e582f2eb2af9630a1c3cfd1c715fd18","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"0e9f1e8e40bb79e800b0cc9433830cf4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# File categories","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L97,L98","required_engine_version":"0.31.0","name":"etc_dir","macro":"etc_dir","condition":"(fd.name startswith /etc/)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e750c953eb53022a0b566477ad6e8090","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L100,L101","required_engine_version":"0.31.0","name":"shell_binaries","list":"shell_binaries","items":["ash","bash","csh","ksh","sh","tcsh","zsh","dash"],"tags":null,"enabled":"true","used_by":["macro:shell_procs:8907863a6a74678a4246f35930a29fe1","rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"af03e5f14f4aa2d1505ec180e1c58caf","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L103,L104","required_engine_version":"0.31.0","name":"shell_procs","macro":"shell_procs","condition":"(proc.name in (shell_binaries))","tags":null,"enabled":"true","dependencies":["list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf"],"used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684"],"type":"macro","hash":"8907863a6a74678a4246f35930a29fe1","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# dpkg -L login | grep bin | xargs ls -ld | grep -v '^d' | awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L107,L108","required_engine_version":"0.31.0","name":"login_binaries","list":"login_binaries","items":["login","systemd","\"(systemd)\"","systemd-logind","su","nologin","faillog","lastlog","newgrp","sg"],"tags":null,"enabled":"true","type":"list","hash":"dedbc650e5df9d28c764ee3aedae7db9","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# dpkg -L passwd | grep bin | xargs ls -ld | grep -v '^d' | awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L114,L115","required_engine_version":"0.31.0","name":"passwd_binaries","list":"passwd_binaries","items":["shadowconfig","grpck","pwunconv","grpconv","pwck","groupmod","vipw","pwconv","useradd","newusers","cppw","chpasswd","usermod","groupadd","groupdel","grpunconv","chgpasswd","userdel","chage","chsh","gpasswd","chfn","expiry","passwd","vigr","cpgr","adduser","addgroup","deluser","delgroup"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"11d902c686355a4df0580d2b954301da","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# repoquery -l shadow-utils | grep bin | xargs ls -ld | grep -v '^d' |\n#     awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L124,L125","required_engine_version":"0.31.0","name":"shadowutils_binaries","list":"shadowutils_binaries","items":["chage","gpasswd","lastlog","newgrp","sg","adduser","deluser","chpasswd","groupadd","groupdel","addgroup","delgroup","groupmems","groupmod","grpck","grpconv","grpunconv","newusers","pwck","pwconv","pwunconv","useradd","userdel","usermod","vigr","vipw","unix_chkpwd"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"dd53fb0d2784a8a52ac3c20ab275de72","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L131,L132","required_engine_version":"0.31.0","name":"http_server_binaries","list":"http_server_binaries","items":["nginx","httpd","httpd-foregroun","lighttpd","apache","apache2"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e"],"type":"list","hash":"61646da82f5fbac9590c38bfb846ce10","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L134,L135","required_engine_version":"0.31.0","name":"db_server_binaries","list":"db_server_binaries","items":["mysqld","postgres","sqlplus"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7"],"type":"list","hash":"449619792d4c73357d92287273fbd164","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L137,L138","required_engine_version":"0.31.0","name":"postgres_mgmt_binaries","list":"postgres_mgmt_binaries","items":["pg_dumpall","pg_ctl","pg_lsclusters","pg_ctlcluster"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"list","hash":"983f83fafcd16f2c180fc70666c34845","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L140,L141","required_engine_version":"0.31.0","name":"nosql_server_binaries","list":"nosql_server_binaries","items":["couchdb","memcached","redis-server","rabbitmq-server","mongod"],"tags":null,"enabled":"true","type":"list","hash":"724523f554919e254cb89a80c8e74efd","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L143,L144","required_engine_version":"0.31.0","name":"gitlab_binaries","list":"gitlab_binaries","items":["gitlab-shell","gitlab-mon","gitlab-runner-b","git"],"tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"list","hash":"93a3755022112947842484415a332c0b","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L146,L147","required_engine_version":"0.31.0","name":"server_procs","macro":"server_procs","condition":"(proc.name in (http_server_binaries, db_server_binaries, docker_binaries, sshd))","tags":null,"enabled":"true","dependencies":["list:http_server_binaries:61646da82f5fbac9590c38bfb846ce10","list:db_server_binaries:449619792d4c73357d92287273fbd164","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:db_server_binaries:449619792d4c73357d92287273fbd164","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85"],"used_by":["rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6"],"type":"macro","hash":"b0b2aee9b1b742b7be027fd5c2ac590e","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# The explicit quotes are needed to avoid the - characters being\n# interpreted by the filter expression.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L151,L152","required_engine_version":"0.31.0","name":"rpm_binaries","list":"rpm_binaries","items":["dnf","dnf-automatic","rpm","rpmkey","yum","\"75-system-updat\"","rhsmcertd-worke","rhsmcertd","subscription-ma","repoquery","rpmkeys","rpmq","yum-cron","yum-config-mana","yum-debug-dump","abrt-action-sav","rpmdb_stat","microdnf","rhn_check","yumdb"],"tags":null,"enabled":"true","used_by":["macro:rpm_procs:4af559147e158d724c3273c0cf781a9f"],"type":"list","hash":"7ee4dcdb218ac951a864e29417a8177c","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L156,L157","required_engine_version":"0.31.0","name":"deb_binaries","list":"deb_binaries","items":["dpkg","dpkg-preconfigu","dpkg-reconfigur","dpkg-divert","apt","apt-get","aptitude","frontend","preinst","add-apt-reposit","apt-auto-remova","apt-key","apt-listchanges","unattended-upgr","apt-add-reposit","apt-cache","apt.systemd.dai"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"69ab88691c72177ecff691379ff122c4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L161,L162","required_engine_version":"0.31.0","name":"python_package_managers","list":"python_package_managers","items":["pip","pip3","conda"],"tags":null,"enabled":"true","type":"list","hash":"a529bcd7406766c180064511628b15f3","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# The truncated dpkg-preconfigu is intentional, process names are\n# truncated at the falcosecurity-libs level.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L166,L167","required_engine_version":"0.31.0","name":"package_mgmt_binaries","list":"package_mgmt_binaries","items":["rpm_binaries","deb_binaries","update-alternat","gem","npm","python_package_managers","sane-utils.post","alternatives","chef-client","apk","snapd"],"tags":null,"enabled":"true","used_by":["macro:run_by_package_mgmt_binaries:330b541f474e818efb55c808d9f9ec6f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"cbd791c45a9d5d51118aaf6c9ce6b934","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L169,L170","required_engine_version":"0.31.0","name":"run_by_package_mgmt_binaries","macro":"run_by_package_mgmt_binaries","condition":"(proc.aname in (package_mgmt_binaries, needrestart))","tags":null,"enabled":"true","dependencies":["list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934"],"used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"330b541f474e818efb55c808d9f9ec6f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# A canonical set of processes that run other programs with different\n# privileges or as a different user.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L174,L175","required_engine_version":"0.31.0","name":"userexec_binaries","list":"userexec_binaries","items":["sudo","su","suexec","critical-stack","dzdo"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"list","hash":"a565f19993c396a912312fc67ef23f02","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L177,L178","required_engine_version":"0.31.0","name":"user_mgmt_binaries","list":"user_mgmt_binaries","items":["login_binaries","passwd_binaries","shadowutils_binaries"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:system_procs:1626c650eb514b1780d01d83b1609b2f","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"list","hash":"2b8476e193b6319359b8500841101a95","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L180,L181","required_engine_version":"0.31.0","name":"hids_binaries","list":"hids_binaries","items":["aide","aide.wrapper","update-aide.con","logcheck","syslog-summary","osqueryd","ossec-syscheckd"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"list","hash":"2e2257f901952e8f1c71c6433859164d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L183,L184","required_engine_version":"0.31.0","name":"vpn_binaries","list":"vpn_binaries","items":["openvpn"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"list","hash":"f977d9a09aad2ea83fffbd3a7a869c2d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L186,L187","required_engine_version":"0.31.0","name":"nomachine_binaries","list":"nomachine_binaries","items":["nxexec","nxnode.bin","nxserver.bin","nxclient.bin"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"be10dcfdff8f673dfb82d8bed97c68b9","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L189,L190","required_engine_version":"0.31.0","name":"mail_binaries","list":"mail_binaries","items":["sendmail","sendmail-msp","postfix","procmail","exim4","pickup","showq","mailq","dovecot","imap-login","imap","mailmng-core","pop3-login","dovecot-lda","pop3"],"tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"list","hash":"e80bc600472c458a1eb834ef6cc3608d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L196,L197","required_engine_version":"0.31.0","name":"mail_config_binaries","list":"mail_config_binaries","items":["update_conf","parse_mc","makemap_hash","newaliases","update_mk","update_tlsm4","update_db","update_mc","ssmtp.postinst","mailq","postalias","postfix.config.","postfix.config","postfix-script","postconf"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"b7be6fc7d0d3734f0bdfda0a81accc5f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L203,L204","required_engine_version":"0.31.0","name":"sensitive_file_names","list":"sensitive_file_names","items":["/etc/shadow","/etc/sudoers","/etc/pam.conf","/etc/security/pwquality.conf"],"tags":null,"enabled":"true","used_by":["macro:sensitive_files:bc813752062be252ca253cee28ddbbae","rule:Create Symlink Over Sensitive Files:2bcdd8e246ad13d6937576a2d5cbce01","rule:Create Hardlink Over Sensitive Files:44f504a9337c5c86699a0cb02a0a355d"],"type":"list","hash":"e54197be4a07891d91c98ea756ac113d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L206,L207","required_engine_version":"0.31.0","name":"sensitive_directory_names","list":"sensitive_directory_names","items":["/","/etc","/etc/","/root","/root/"],"tags":null,"enabled":"true","used_by":["rule:Create Symlink Over Sensitive Files:2bcdd8e246ad13d6937576a2d5cbce01"],"type":"list","hash":"fa2eee2cc3ead2d99ca3d4789e90621c","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L209,L210","required_engine_version":"0.31.0","name":"sensitive_files","macro":"sensitive_files","condition":"(fd.name in (sensitive_file_names) or\n  fd.directory in (/etc/sudoers.d, /etc/pam.d))\n","tags":null,"enabled":"true","dependencies":["list:sensitive_file_names:e54197be4a07891d91c98ea756ac113d"],"used_by":["rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"bc813752062be252ca253cee28ddbbae","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Indicates that the process is new. Currently detected using time\n# since process was started, using a threshold of 5 seconds.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L216,L217","required_engine_version":"0.31.0","name":"proc_is_new","macro":"proc_is_new","condition":"(proc.duration \u003c= 5000000000)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6"],"type":"macro","hash":"9bcebd514bbad53f4298328825d0d4c2","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Use this to test whether the event occurred within a container.\n# When displaying container information in the output field, use\n# %container.info, without any leading term (file=%fd.name\n# %container.info user=%user.name user_loginuid=%user.loginuid, and not file=%fd.name\n# container=%container.info user=%user.name user_loginuid=%user.loginuid). The output will change\n# based on the context and whether or not -pk/-pm/-pc was specified on\n# the command line.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L226,L227","required_engine_version":"0.31.0","name":"container","macro":"container","condition":"(container.id != host)","tags":null,"enabled":"true","used_by":["macro:user_read_sensitive_file_containers:e8df79ecac70e22ac5ac4f683bb13d24","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","macro:trusted_logging_images:321c1a70d9796565640a81b9f3701e42","macro:containerd_activities:c2ce963725cd72b3df80b07413b7e4c4","rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Packet socket created in container:59e21c1607722fe0bee894eff26d9025","rule:Redirect STDOUT/STDIN to Network Connection in Container:3448315ac2834f28f611653e79764663","rule:Linux Kernel Module Injection Detected:41258ebe4f0565b8c3c1ddd96663c1a6","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","macro:sensitive_vol_mount:621cd5c512333ac20ba436785be6b179","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Change namespace privileges via unshare:1447a5e5cc069325af45954d0d349353","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa","macro:known_user_in_container:068a3f594dcb9921289b7525ef804824","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:jboss_in_container_writing_passwd:e104575a302efede918aaae611ba6fac","macro:etcd_manager_updating_dns:b7185f0f1766ee6887147bf0d00c4500","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017","rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3","macro:user_known_k8s_client_container_parens:2fdfd506ad251627b22d33c77dee9957","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81"],"type":"macro","hash":"5f0b6ebc4bea10285ba2b8a6ce78b863","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L229,L230","required_engine_version":"0.31.0","name":"interactive","macro":"interactive","condition":"((proc.aname=sshd and proc.name != sshd) or proc.name=systemd-logind or proc.name=login)\n","tags":null,"enabled":"true","used_by":["rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326"],"type":"macro","hash":"fe88c03a1958b4259f0c51d68eed3213","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L234,L235","required_engine_version":"0.31.0","name":"cron_binaries","list":"cron_binaries","items":["anacron","cron","crond","crontab"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"list","hash":"6f1f66d014c874287d9333b0ee22b125","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# https://github.com/liske/needrestart","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L238,L239","required_engine_version":"0.31.0","name":"needrestart_binaries","list":"needrestart_binaries","items":["needrestart","10-dpkg","20-rpm","30-pacman"],"tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"list","hash":"6e00b59826ab685a4964571124be5622","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Possible scripts run by sshkit","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L242,L243","required_engine_version":"0.31.0","name":"sshkit_script_binaries","list":"sshkit_script_binaries","items":["10_etc_sudoers.","10_passwd_group"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"ce44254edc701be4dd47f06f9052328d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# System users that should never log into a system. Consider adding your own\n# service users (e.g. 'apache' or 'mysqld') here.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L247,L248","required_engine_version":"0.31.0","name":"system_users","macro":"system_users","condition":"(user.name in (bin, daemon, games, lp, mail, nobody, sshd, sync, uucp, www-data))","tags":null,"enabled":"true","used_by":["rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326"],"type":"macro","hash":"ae2ad3d3da10c2072175ce20624812d4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L250,L251","required_engine_version":"0.31.0","name":"ansible_running_python","macro":"ansible_running_python","condition":"(proc.name in (python, pypy, python3) and proc.cmdline contains ansible)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"32953f9f3a0f3f017f72d291abad0fd5","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Qualys seems to run a variety of shell subprocesses, at various\n# levels. This checks at a few levels without the cost of a full\n# proc.aname, which traverses the full parent hierarchy.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L256,L257","required_engine_version":"0.31.0","name":"run_by_qualys","macro":"run_by_qualys","condition":"(proc.pname=qualys-cloud-ag or\n proc.aname[2]=qualys-cloud-ag or\n proc.aname[3]=qualys-cloud-ag or\n proc.aname[4]=qualys-cloud-ag)\n","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"a778e5b0cc0d78490f59b07c87278a0f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L263,L264","required_engine_version":"0.31.0","name":"run_by_google_accounts_daemon","macro":"run_by_google_accounts_daemon","condition":"(proc.aname[1] startswith google_accounts or\n proc.aname[2] startswith google_accounts or\n proc.aname[3] startswith google_accounts)\n","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"d6ec884ac09a5dcfa8a67fa1a5232233","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Chef is similar.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L270,L271","required_engine_version":"0.31.0","name":"run_by_chef","macro":"run_by_chef","condition":"(proc.aname[2]=chef_command_wr or proc.aname[3]=chef_command_wr or proc.aname[2]=chef-client or proc.aname[3]=chef-client or proc.name=chef-client)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e3aec37896453ee7f73bca485d8c4ef1","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Also handles running semi-indirectly via scl","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L276,L277","required_engine_version":"0.31.0","name":"run_by_foreman","macro":"run_by_foreman","condition":"(user.name=foreman and\n ((proc.pname in (rake, ruby, scl) and proc.aname[5] in (tfm-rake,tfm-ruby)) or\n (proc.pname=scl and proc.aname[2] in (tfm-rake,tfm-ruby))))\n","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"d08847b65ce4993a0c38c52bab29f8b9","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L282,L283","required_engine_version":"0.31.0","name":"python_mesos_marathon_scripting","macro":"python_mesos_marathon_scripting","condition":"(proc.pcmdline startswith \"python3 /marathon-lb/marathon_lb.py\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"e1ba57442586f49f842c17f052c2c842","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L285,L286","required_engine_version":"0.31.0","name":"splunk_running_forwarder","macro":"splunk_running_forwarder","condition":"(proc.pname=splunkd and proc.cmdline startswith \"sh -c /opt/splunkforwarder\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"a755be42eb6a029167dfccc9a0d550e8","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L288,L289","required_engine_version":"0.31.0","name":"perl_running_plesk","macro":"perl_running_plesk","condition":"(proc.cmdline startswith \"perl /opt/psa/admin/bin/plesk_agent_manager\" or proc.pcmdline startswith \"perl /opt/psa/admin/bin/plesk_agent_manager\")","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"2b0e5df74d6eb443338b26da9b136f87","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L292,L293","required_engine_version":"0.31.0","name":"perl_running_updmap","macro":"perl_running_updmap","condition":"(proc.cmdline startswith \"perl /usr/bin/updmap\")","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"589a4f8cbb574b765bb9d8f5823401e1","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L295,L296","required_engine_version":"0.31.0","name":"perl_running_centrifydc","macro":"perl_running_centrifydc","condition":"(proc.cmdline startswith \"perl /usr/share/centrifydc\")","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"1d8351cb0ee455690fd0ad293929f012","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L298,L299","required_engine_version":"0.31.0","name":"runuser_reading_pam","macro":"runuser_reading_pam","condition":"(proc.name=runuser and fd.directory=/etc/pam.d)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"3aa78dff367e96705b5f16a8fd8771e9","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# CIS Linux Benchmark program","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L302,L303","required_engine_version":"0.31.0","name":"linux_bench_reading_etc_shadow","macro":"linux_bench_reading_etc_shadow","condition":"((proc.aname[2]=linux-bench and proc.name in (awk,cut,grep)) and (fd.name=/etc/shadow or fd.directory=/etc/pam.d))","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"33ae527a98b2b3ef94e0b006097440fd","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L308,L309","required_engine_version":"0.31.0","name":"veritas_driver_script","macro":"veritas_driver_script","condition":"(proc.cmdline startswith \"perl /opt/VRTSsfmh/bin/mh_driver.pl\")","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:veritas_progs:2c0c8010c4e0e4adb53d4dec2e5be024"],"type":"macro","hash":"289a40694621cf340ededcb65e4c6d3b","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L311,L312","required_engine_version":"0.31.0","name":"user_ssh_directory","macro":"user_ssh_directory","condition":"(fd.name contains '/.ssh/' and fd.name glob '/home/*/.ssh/*')","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","macro:google_accounts_daemon_writing_ssh:2b6db0ba0430fd8423be766536193b3c","macro:cloud_init_writing_ssh:4bf6d26e36510c3b6e49059baad4d129","macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093"],"type":"macro","hash":"2cd1d449c2270b4de4a69a70a37f69fb","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L314,L315","required_engine_version":"0.31.0","name":"directory_traversal","macro":"directory_traversal","condition":"(fd.nameraw contains '../' and fd.nameraw glob '*../*../*')","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f"],"type":"macro","hash":"72aa068e80fb98fafcad214d92ee0d2b","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# ******************************************************************************\n# * \"Directory traversal monitored file read\" requires FALCO_ENGINE_VERSION 13 *\n# ******************************************************************************","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L320,L335","required_engine_version":"0.31.0","name":"Directory traversal monitored file read","rule":"Directory traversal monitored file read","condition":"(open_read or open_file_failed)  and (etc_dir or user_ssh_directory or \n     fd.name startswith /root/.ssh or \n     fd.name contains \"id_rsa\") \nand directory_traversal  and not proc.pname in (shell_binaries)\n","desc":"Web applications can be vulnerable to directory traversal attacks that allow accessing files outside of the web app's root directory  (e.g. Arbitrary File Read bugs). System directories like /etc are typically accessed via absolute paths. Access patterns outside of this  (here path traversal) can be regarded as suspicious. This rule includes failed file open attempts.\n","output":"Read monitored file via directory traversal (file=%fd.name fileraw=%fd.nameraw gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_credential_access","T1555"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:open_file_failed:79b6d9042977e497bec0d62841125fa4","macro:etc_dir:e750c953eb53022a0b566477ad6e8090","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:directory_traversal:72aa068e80fb98fafcad214d92ee0d2b","macro:open_read:fada70dac63821c34b095b962e02cb36","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:etc_dir:e750c953eb53022a0b566477ad6e8090","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb"],"type":"rule","hash":"7c55139e8c139d003d1c3355efc40c3f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L337,L338","required_engine_version":"0.31.0","name":"cmp_cp_by_passwd","macro":"cmp_cp_by_passwd","condition":"(proc.name in (cmp, cp) and proc.pname in (passwd, run-parts))","tags":null,"enabled":"true","used_by":["macro:user_read_sensitive_file_conditions:fdde2fe38eff306d1a5d93da1cf05f39","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"01c57df4cbda98ff94ed6cec21f1a3f0","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L340,L341","required_engine_version":"0.31.0","name":"user_known_read_sensitive_files_activities","macro":"user_known_read_sensitive_files_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"93013fdd38f628311bbd04ebd0e01436","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L343,L361","required_engine_version":"0.31.0","name":"Read sensitive file trusted after startup","rule":"Read sensitive file trusted after startup","condition":"open_read  and sensitive_files  and server_procs  and not proc_is_new  and proc.name!=\"sshd\"  and not user_known_read_sensitive_files_activities\n","desc":"An attempt to read any sensitive file (e.g. files containing user/password/authentication information) by a trusted program after startup. Trusted programs might read these files at startup to load initial state, but not afterwards. Can be customized as needed. In modern containerized cloud infrastructures, accessing traditional Linux sensitive files  might be less relevant, yet it remains valuable for baseline detections. While we provide additional  rules for SSH or cloud vendor-specific credentials, you can significantly enhance your security  program by crafting custom rules for critical application credentials unique to your environment.\n","output":"Sensitive file opened for reading by trusted program after startup (file=%fd.name pcmdline=%proc.pcmdline gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_credential_access","T1555"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","macro:sensitive_files:bc813752062be252ca253cee28ddbbae","macro:proc_is_new:9bcebd514bbad53f4298328825d0d4c2","macro:user_known_read_sensitive_files_activities:93013fdd38f628311bbd04ebd0e01436","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:open_read:fada70dac63821c34b095b962e02cb36"],"type":"rule","hash":"b75aa41834466514724e394b6983a5e6","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L363,L364","required_engine_version":"0.31.0","name":"read_sensitive_file_binaries","list":"read_sensitive_file_binaries","items":["iptables","ps","lsb_release","check-new-relea","dumpe2fs","accounts-daemon","sshd","vsftpd","systemd","mysql_install_d","psql","screen","debconf-show","sa-update","pam-auth-update","pam-config","/usr/sbin/spamd","polkit-agent-he","lsattr","file","sosreport","scxcimservera","adclient","rtvscand","cockpit-session","userhelper","ossec-syscheckd"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"list","hash":"e257522d28d019628f8c7b3a76714300","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to allow for specific combinations of\n# programs accessing sensitive files.\n# fluentd_writing_conf_files is a good example to follow, as it\n# specifies both the program doing the writing as well as the specific\n# files it is allowed to modify.\n#\n# In this file, it just takes one of the macros in the base rule\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L380,L381","required_engine_version":"0.31.0","name":"user_read_sensitive_file_conditions","macro":"user_read_sensitive_file_conditions","condition":"cmp_cp_by_passwd","tags":null,"enabled":"true","dependencies":["macro:cmp_cp_by_passwd:01c57df4cbda98ff94ed6cec21f1a3f0"],"used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"fdde2fe38eff306d1a5d93da1cf05f39","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L383,L384","required_engine_version":"0.31.0","name":"read_sensitive_file_images","list":"read_sensitive_file_images","tags":null,"enabled":"true","used_by":["macro:user_read_sensitive_file_containers:e8df79ecac70e22ac5ac4f683bb13d24"],"type":"list","hash":"10c5017498bf1815a9231ce0aba6ec75","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L386,L387","required_engine_version":"0.31.0","name":"user_read_sensitive_file_containers","macro":"user_read_sensitive_file_containers","condition":"(container and container.image.repository in (read_sensitive_file_images))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:read_sensitive_file_images:10c5017498bf1815a9231ce0aba6ec75","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"e8df79ecac70e22ac5ac4f683bb13d24","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# This macro detects man-db postinst, see https://salsa.debian.org/debian/man-db/-/blob/master/debian/postinst\n# The rule \"Read sensitive file untrusted\" use this macro to avoid FPs.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L391,L392","required_engine_version":"0.31.0","name":"mandb_postinst","macro":"mandb_postinst","condition":"(proc.name=perl and proc.args startswith \"-e\" and proc.args contains \"@pwd = getpwnam(\" and proc.args contains \"exec \" and proc.args contains \"/usr/bin/mandb\")\n","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315"],"type":"macro","hash":"40193336becb6cb0459de83b2842c5f5","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L398,L433","required_engine_version":"0.31.0","name":"Read sensitive file untrusted","rule":"Read sensitive file untrusted","condition":"open_read and sensitive_files and proc_name_exists and not proc.name in (user_mgmt_binaries, userexec_binaries, package_mgmt_binaries,\n cron_binaries, read_sensitive_file_binaries, shell_binaries, hids_binaries,\n vpn_binaries, mail_config_binaries, nomachine_binaries, sshkit_script_binaries,\n in.proftpd, mandb, salt-call, salt-minion, postgres_mgmt_binaries,\n google_oslogin_\n )\nand not cmp_cp_by_passwd and not ansible_running_python and not run_by_qualys and not run_by_chef and not run_by_google_accounts_daemon and not user_read_sensitive_file_conditions and not mandb_postinst and not perl_running_plesk and not perl_running_updmap and not veritas_driver_script and not perl_running_centrifydc and not runuser_reading_pam and not linux_bench_reading_etc_shadow and not user_known_read_sensitive_files_activities and not user_read_sensitive_file_containers\n","desc":"An attempt to read any sensitive file (e.g. files containing user/password/authentication information). Exceptions are made for known trusted programs. Can be customized as needed. In modern containerized cloud infrastructures, accessing traditional Linux sensitive files  might be less relevant, yet it remains valuable for baseline detections. While we provide additional  rules for SSH or cloud vendor-specific credentials, you can significantly enhance your security  program by crafting custom rules for critical application credentials unique to your environment.\n","output":"Sensitive file opened for reading by non-trusted program (file=%fd.name gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_credential_access","T1555"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:postgres_mgmt_binaries:983f83fafcd16f2c180fc70666c34845","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:userexec_binaries:a565f19993c396a912312fc67ef23f02","list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95","list:hids_binaries:2e2257f901952e8f1c71c6433859164d","list:vpn_binaries:f977d9a09aad2ea83fffbd3a7a869c2d","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_config_binaries:b7be6fc7d0d3734f0bdfda0a81accc5f","macro:sensitive_files:bc813752062be252ca253cee28ddbbae","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","list:sshkit_script_binaries:ce44254edc701be4dd47f06f9052328d","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:run_by_qualys:a778e5b0cc0d78490f59b07c87278a0f","macro:run_by_google_accounts_daemon:d6ec884ac09a5dcfa8a67fa1a5232233","macro:run_by_chef:e3aec37896453ee7f73bca485d8c4ef1","macro:perl_running_plesk:2b0e5df74d6eb443338b26da9b136f87","macro:perl_running_updmap:589a4f8cbb574b765bb9d8f5823401e1","macro:perl_running_centrifydc:1d8351cb0ee455690fd0ad293929f012","macro:runuser_reading_pam:3aa78dff367e96705b5f16a8fd8771e9","macro:linux_bench_reading_etc_shadow:33ae527a98b2b3ef94e0b006097440fd","macro:veritas_driver_script:289a40694621cf340ededcb65e4c6d3b","macro:cmp_cp_by_passwd:01c57df4cbda98ff94ed6cec21f1a3f0","macro:user_known_read_sensitive_files_activities:93013fdd38f628311bbd04ebd0e01436","list:read_sensitive_file_binaries:e257522d28d019628f8c7b3a76714300","macro:user_read_sensitive_file_conditions:fdde2fe38eff306d1a5d93da1cf05f39","macro:user_read_sensitive_file_containers:e8df79ecac70e22ac5ac4f683bb13d24","macro:mandb_postinst:40193336becb6cb0459de83b2842c5f5","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:userexec_binaries:a565f19993c396a912312fc67ef23f02","list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","macro:run_by_qualys:a778e5b0cc0d78490f59b07c87278a0f","macro:run_by_google_accounts_daemon:d6ec884ac09a5dcfa8a67fa1a5232233","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_config_binaries:b7be6fc7d0d3734f0bdfda0a81accc5f","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:sshkit_script_binaries:ce44254edc701be4dd47f06f9052328d","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:run_by_chef:e3aec37896453ee7f73bca485d8c4ef1","macro:veritas_driver_script:289a40694621cf340ededcb65e4c6d3b"],"type":"rule","hash":"5116b3ca0c5fad246cc41ca67938a315","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L435,L436","required_engine_version":"0.31.0","name":"postgres_running_wal_e","macro":"postgres_running_wal_e","condition":"(proc.pname=postgres and (proc.cmdline startswith \"sh -c envdir /etc/wal-e.d/env /usr/local/bin/wal-e\" or proc.cmdline startswith \"sh -c envdir \\\"/run/etc/wal-e.d/env\\\" wal-g wal-push\"))","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7"],"type":"macro","hash":"bd23433612d1f77cb9276c6da05b3775","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L438,L439","required_engine_version":"0.31.0","name":"redis_running_prepost_scripts","macro":"redis_running_prepost_scripts","condition":"(proc.aname[2]=redis-server and (proc.cmdline contains \"redis-server.post-up.d\" or proc.cmdline contains \"redis-server.pre-up.d\"))","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"3e1e02f554acefc92046376f42e325aa","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L441,L442","required_engine_version":"0.31.0","name":"rabbitmq_running_scripts","macro":"rabbitmq_running_scripts","condition":"(proc.pname=beam.smp and (proc.cmdline startswith \"sh -c exec ps\" or\n proc.cmdline startswith \"sh -c exec inet_gethost\" or\n proc.cmdline= \"sh -s unix:cmd\" or\n proc.cmdline= \"sh -c exec /bin/sh -s unix:cmd 2\u003e\u00261\"))\n","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"f7fcb3478b892a618720d7851aa8692d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L449,L450","required_engine_version":"0.31.0","name":"rabbitmqctl_running_scripts","macro":"rabbitmqctl_running_scripts","condition":"(proc.aname[2]=rabbitmqctl and proc.cmdline startswith \"sh -c \")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"3a68d09c450f70537cc057d2203370ab","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L452,L453","required_engine_version":"0.31.0","name":"run_by_appdynamics","macro":"run_by_appdynamics","condition":"(proc.pexe endswith java and proc.pcmdline contains \" -jar -Dappdynamics\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"4d7485c7030db9363f27078b5359f7a2","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# The binaries in this list and their descendents are *not* allowed\n# spawn shells. This includes the binaries spawning shells directly as\n# well as indirectly. For example, apache -\u003e php/perl for\n# mod_{php,perl} -\u003e some shell is also not allowed, because the shell\n# has apache as an ancestor.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L460,L461","required_engine_version":"0.31.0","name":"protected_shell_spawning_binaries","list":"protected_shell_spawning_binaries","items":["http_server_binaries","db_server_binaries","nosql_server_binaries","mail_binaries","fluentd","flanneld","splunkd","consul","smbd","runsv","PM2"],"tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"list","hash":"5a831ca53621d645202a0936bbe93658","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L466,L467","required_engine_version":"0.31.0","name":"parent_java_running_zookeeper","macro":"parent_java_running_zookeeper","condition":"(proc.pexe endswith java and proc.pcmdline contains org.apache.zookeeper.server)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"dad2e903f337136ed85901ba3603d00b","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L469,L470","required_engine_version":"0.31.0","name":"parent_java_running_kafka","macro":"parent_java_running_kafka","condition":"(proc.pexe endswith java and proc.pcmdline contains kafka.Kafka)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"85f14070f56fef4ad14c02d9bb484d6d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L472,L473","required_engine_version":"0.31.0","name":"parent_java_running_elasticsearch","macro":"parent_java_running_elasticsearch","condition":"(proc.pexe endswith java and proc.pcmdline contains org.elasticsearch.bootstrap.Elasticsearch)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"b7e7beee746fb6cbd38ed9b2dc7989e1","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L475,L476","required_engine_version":"0.31.0","name":"parent_java_running_activemq","macro":"parent_java_running_activemq","condition":"(proc.pexe endswith java and proc.pcmdline contains activemq.jar)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"3b38b224f8279f053c1b95f4aab530e9","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L478,L479","required_engine_version":"0.31.0","name":"parent_java_running_cassandra","macro":"parent_java_running_cassandra","condition":"(proc.pexe endswith java and (proc.pcmdline contains \"-Dcassandra.config.loader\" or proc.pcmdline contains org.apache.cassandra.service.CassandraDaemon))","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"b8c144f02823399396cfacf218bd8ce8","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L481,L482","required_engine_version":"0.31.0","name":"parent_java_running_jboss_wildfly","macro":"parent_java_running_jboss_wildfly","condition":"(proc.pexe endswith java and proc.pcmdline contains org.jboss)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"3c177ac87bd44c168201e6cfc60e7682","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L484,L485","required_engine_version":"0.31.0","name":"parent_java_running_glassfish","macro":"parent_java_running_glassfish","condition":"(proc.pexe endswith java and proc.pcmdline contains com.sun.enterprise.glassfish)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"ec61aecf16523635b8a105d655552a4f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L487,L488","required_engine_version":"0.31.0","name":"parent_java_running_hadoop","macro":"parent_java_running_hadoop","condition":"(proc.pexe endswith java and proc.pcmdline contains org.apache.hadoop)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"c7e3f16120da2be85a01a746d1bb29c0","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L490,L491","required_engine_version":"0.31.0","name":"parent_java_running_datastax","macro":"parent_java_running_datastax","condition":"(proc.pexe endswith java and proc.pcmdline contains com.datastax)","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"7c07fd37bfa769582043db9af298939d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L493,L494","required_engine_version":"0.31.0","name":"nginx_starting_nginx","macro":"nginx_starting_nginx","condition":"(proc.pname=nginx and proc.cmdline contains \"/usr/sbin/nginx -c /etc/nginx/nginx.conf\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"8f17af6fb377b48111eaecbfb08cc4f5","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L496,L497","required_engine_version":"0.31.0","name":"nginx_running_aws_s3_cp","macro":"nginx_running_aws_s3_cp","condition":"(proc.pname=nginx and proc.cmdline startswith \"sh -c /usr/local/bin/aws s3 cp\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"0706dddd6e0ea756feaff182e53dec8f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L499,L500","required_engine_version":"0.31.0","name":"consul_running_net_scripts","macro":"consul_running_net_scripts","condition":"(proc.pname=consul and (proc.cmdline startswith \"sh -c curl\" or proc.cmdline startswith \"sh -c nc\"))","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"b90a9710c72307790a89d9cd655d6695","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L502,L503","required_engine_version":"0.31.0","name":"consul_running_alert_checks","macro":"consul_running_alert_checks","condition":"(proc.pname=consul and proc.cmdline startswith \"sh -c /bin/consul-alerts\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"7cab13b781e8aba8ad318dc176d99928","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L505,L506","required_engine_version":"0.31.0","name":"serf_script","macro":"serf_script","condition":"(proc.cmdline startswith \"sh -c serf\")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"d4d58ded4f3d34ebc7d2f76052f00711","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L508,L509","required_engine_version":"0.31.0","name":"check_process_status","macro":"check_process_status","condition":"(proc.cmdline startswith \"sh -c kill -0 \")","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"284a2345c49d324a7abfa859c03a5ba8","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# In some cases, you may want to consider node processes run directly\n# in containers as protected shell spawners. Examples include using\n# pm2-docker or pm2 start some-app.js --no-daemon-mode as the direct\n# entrypoint of the container, and when the node app is a long-lived\n# server using something like express.\n#\n# However, there are other uses of node related to build pipelines for\n# which node is not really a server but instead a general scripting\n# tool. In these cases, shells are very likely and in these cases you\n# don't want to consider node processes protected shell spawners.\n#\n# We have to choose one of these cases, so we consider node processes\n# as unprotected by default. If you want to consider any node process\n# run in a container as a protected shell spawner, override the below\n# macro to remove the \"never_true\" clause, which allows it to take effect.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L526,L527","required_engine_version":"0.31.0","name":"possibly_node_in_container","macro":"possibly_node_in_container","condition":"(never_true and (proc.pname=node and proc.aname[3]=docker-containe))","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:node:36c4536996ca5615dcf9911f068786dc","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"513181c67b31a65f5956a1911a700134","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Similarly, you may want to consider any shell spawned by apache\n# tomcat as suspect. The famous apache struts attack (CVE-2017-5638)\n# could be exploited to do things like spawn shells.\n#\n# However, many applications *do* use tomcat to run arbitrary shells,\n# as a part of build pipelines, etc.\n#\n# Like for node, we make this case opt-in.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L537,L538","required_engine_version":"0.31.0","name":"possibly_parent_java_running_tomcat","macro":"possibly_parent_java_running_tomcat","condition":"(never_true and proc.pexe endswith java and proc.pcmdline contains org.apache.catalina.startup.Bootstrap)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f"],"type":"macro","hash":"ff2e34a96a3a090dab697eb7bef460f0","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L540,L541","required_engine_version":"0.31.0","name":"protected_shell_spawner","macro":"protected_shell_spawner","condition":"(proc.aname in (protected_shell_spawning_binaries) or parent_java_running_zookeeper or parent_java_running_kafka or parent_java_running_elasticsearch or parent_java_running_activemq or parent_java_running_cassandra or parent_java_running_jboss_wildfly or parent_java_running_glassfish or parent_java_running_hadoop or parent_java_running_datastax or possibly_parent_java_running_tomcat or possibly_node_in_container)\n","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:protected_shell_spawning_binaries:5a831ca53621d645202a0936bbe93658","macro:parent_java_running_zookeeper:dad2e903f337136ed85901ba3603d00b","macro:parent_java_running_kafka:85f14070f56fef4ad14c02d9bb484d6d","macro:parent_java_running_elasticsearch:b7e7beee746fb6cbd38ed9b2dc7989e1","macro:parent_java_running_activemq:3b38b224f8279f053c1b95f4aab530e9","macro:parent_java_running_cassandra:b8c144f02823399396cfacf218bd8ce8","macro:parent_java_running_jboss_wildfly:3c177ac87bd44c168201e6cfc60e7682","macro:parent_java_running_glassfish:ec61aecf16523635b8a105d655552a4f","macro:parent_java_running_hadoop:c7e3f16120da2be85a01a746d1bb29c0","macro:parent_java_running_datastax:7c07fd37bfa769582043db9af298939d","macro:possibly_node_in_container:513181c67b31a65f5956a1911a700134","macro:possibly_parent_java_running_tomcat:ff2e34a96a3a090dab697eb7bef460f0","macro:node:36c4536996ca5615dcf9911f068786dc","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:java_running_cassandra:4007e4b4c8d21c944cab57c742f7544e"],"used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"289d0fac7ddcc0b55530dce34e2f574f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L555,L556","required_engine_version":"0.31.0","name":"mesos_shell_binaries","list":"mesos_shell_binaries","items":["mesos-docker-ex","mesos-slave","mesos-health-ch"],"tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"list","hash":"31447a41e6ee41c094fd5156aca7019c","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Note that runsv is both in protected_shell_spawner and the\n# exclusions by pname. This means that runsv can itself spawn shells\n# (the ./run and ./finish scripts), but the processes runsv can not\n# spawn shells.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L562,L605","required_engine_version":"0.31.0","name":"Run shell untrusted","rule":"Run shell untrusted","condition":"spawned_process and shell_procs and proc.pname exists and protected_shell_spawner and not proc.pname in (shell_binaries, gitlab_binaries, cron_binaries, user_known_shell_spawn_binaries,\n                       needrestart_binaries,\n                       mesos_shell_binaries,\n                       erl_child_setup, exechealthz,\n                       PM2, PassengerWatchd, c_rehash, svlogd, logrotate, hhvm, serf,\n                       lb-controller, nvidia-installe, runsv, statsite, erlexec, calico-node,\n                       \"puma reactor\")\nand not proc.cmdline in (known_shell_spawn_cmdlines) and not proc.aname in (unicorn_launche) and not consul_running_net_scripts and not consul_running_alert_checks and not nginx_starting_nginx and not nginx_running_aws_s3_cp and not run_by_package_mgmt_binaries and not serf_script and not check_process_status and not run_by_foreman and not python_mesos_marathon_scripting and not splunk_running_forwarder and not postgres_running_wal_e and not redis_running_prepost_scripts and not rabbitmq_running_scripts and not rabbitmqctl_running_scripts and not run_by_appdynamics and not user_shell_container_exclusions\n","desc":"An attempt to spawn a shell below a non-shell application. The non-shell applications that are monitored are  defined in the protected_shell_spawner macro, with protected_shell_spawning_binaries being the list you can  easily customize. For Java parent processes, please note that Java often has a custom process name. Therefore,  rely more on proc.exe to define Java applications. This rule can be noisier, as you can see in the exhaustive  existing tuning. However, given it is very behavior-driven and broad, it is universally relevant to catch  general Remote Code Execution (RCE). Allocate time to tune this rule for your use cases and reduce noise.  Tuning suggestions include looking at the duration of the parent process (proc.ppid.duration) to define your  long-running app processes. Checking for newer fields such as proc.vpgid.name and proc.vpgid.exe instead of the  direct parent process being a non-shell application could make the rule more robust.\n","output":"Shell spawned by untrusted binary (parent_exe=%proc.pexe parent_exepath=%proc.pexepath pcmdline=%proc.pcmdline gparent=%proc.aname[2] ggparent=%proc.aname[3] aname[4]=%proc.aname[4] aname[5]=%proc.aname[5] aname[6]=%proc.aname[6] aname[7]=%proc.aname[7] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","host","container","process","shell","mitre_execution","T1059.004"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:shell_procs:8907863a6a74678a4246f35930a29fe1","list:gitlab_binaries:93a3755022112947842484415a332c0b","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","macro:run_by_package_mgmt_binaries:330b541f474e818efb55c808d9f9ec6f","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","list:needrestart_binaries:6e00b59826ab685a4964571124be5622","macro:run_by_foreman:d08847b65ce4993a0c38c52bab29f8b9","macro:python_mesos_marathon_scripting:e1ba57442586f49f842c17f052c2c842","macro:splunk_running_forwarder:a755be42eb6a029167dfccc9a0d550e8","macro:postgres_running_wal_e:bd23433612d1f77cb9276c6da05b3775","macro:redis_running_prepost_scripts:3e1e02f554acefc92046376f42e325aa","macro:rabbitmq_running_scripts:f7fcb3478b892a618720d7851aa8692d","macro:rabbitmqctl_running_scripts:3a68d09c450f70537cc057d2203370ab","macro:run_by_appdynamics:4d7485c7030db9363f27078b5359f7a2","macro:nginx_starting_nginx:8f17af6fb377b48111eaecbfb08cc4f5","macro:nginx_running_aws_s3_cp:0706dddd6e0ea756feaff182e53dec8f","macro:consul_running_net_scripts:b90a9710c72307790a89d9cd655d6695","macro:consul_running_alert_checks:7cab13b781e8aba8ad318dc176d99928","macro:serf_script:d4d58ded4f3d34ebc7d2f76052f00711","macro:check_process_status:284a2345c49d324a7abfa859c03a5ba8","macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","list:mesos_shell_binaries:31447a41e6ee41c094fd5156aca7019c","list:known_shell_spawn_cmdlines:a471b7368b7e78eb6da1a59b45d22732","list:user_known_shell_spawn_binaries:aee0480002d472c37c865d1f651a4c77","macro:user_shell_container_exclusions:f0b59b425c9d3204fb50ec6e436e8cd7","macro:node:36c4536996ca5615dcf9911f068786dc","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","macro:postgres_running_wal_e:bd23433612d1f77cb9276c6da05b3775","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"551646aedeb1120e4db55fddbd6aff15","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# These images are allowed both to run with --privileged and to mount\n# sensitive paths from the host filesystem.\n#\n# NOTE: This list is only provided for backwards compatibility with\n# older local falco rules files that may have been appending to\n# trusted_images. To make customizations, it's better to add images to\n# either privileged_images or falco_sensitive_mount_images.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L614,L615","required_engine_version":"0.31.0","name":"trusted_images","list":"trusted_images","tags":null,"enabled":"true","used_by":["rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","rule:Detect outbound connections to common miner pool ports:3f01c102c6d26af968d5eb6b6777085d"],"type":"list","hash":"b8b0db0ef4ed293fcc7d4192f53599fa","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L617,L618","required_engine_version":"0.31.0","name":"sematext_images","list":"sematext_images","items":["docker.io/sematext/sematext-agent-docker","docker.io/sematext/agent","docker.io/sematext/logagent","registry.access.redhat.com/sematext/sematext-agent-docker","registry.access.redhat.com/sematext/agent","registry.access.redhat.com/sematext/logagent"],"tags":null,"enabled":"true","type":"list","hash":"af95e235bec59a2fb0ccb358794c7980","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Falco containers","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L624,L626","required_engine_version":"0.31.0","name":"falco_containers","list":"falco_containers","items":["falcosecurity/falco","docker.io/falcosecurity/falco","public.ecr.aws/falcosecurity/falco"],"tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3"],"type":"list","hash":"88616fd0dac29b81cc6b368ce116b9f4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Falco no driver containers","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L631,L633","required_engine_version":"0.31.0","name":"falco_no_driver_containers","list":"falco_no_driver_containers","items":["falcosecurity/falco-no-driver","docker.io/falcosecurity/falco-no-driver","public.ecr.aws/falcosecurity/falco-no-driver"],"tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3"],"type":"list","hash":"4f989b0d285e037e0ff36043120df432","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# These container images are allowed to run with --privileged and full set of capabilities","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L638,L639","required_engine_version":"0.31.0","name":"falco_privileged_images","list":"falco_privileged_images","items":["falco_containers","docker.io/calico/node","calico/node","docker.io/cloudnativelabs/kube-router","docker.io/docker/ucp-agent","docker.io/mesosphere/mesos-slave","docker.io/rook/toolbox","docker.io/sysdig/sysdig","gcr.io/google_containers/kube-proxy","gcr.io/google-containers/startup-script","gcr.io/projectcalico-org/node","gke.gcr.io/kube-proxy","gke.gcr.io/gke-metadata-server","gke.gcr.io/netd-amd64","gke.gcr.io/watcher-daemonset","gcr.io/google-containers/prometheus-to-sd","registry.k8s.io/ip-masq-agent-amd64","registry.k8s.io/kube-proxy","registry.k8s.io/prometheus-to-sd","quay.io/calico/node","sysdig/sysdig","sematext_images","registry.k8s.io/dns/k8s-dns-node-cache","mcr.microsoft.com/oss/kubernetes/kube-proxy"],"tags":null,"enabled":"true","used_by":["rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74"],"type":"list","hash":"fcbbd9234536bd53a20eb8d98e3fd443","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# The steps libcontainer performs to set up the root program for a container are:\n# - clone + exec self to a program runc:[0:PARENT]\n# - clone a program runc:[1:CHILD] which sets up all the namespaces\n# - clone a second program runc:[2:INIT] + exec to the root program.\n#   The parent of runc:[2:INIT] is runc:0:PARENT]\n# As soon as 1:CHILD is created, 0:PARENT exits, so there's a race\n#   where at the time 2:INIT execs the root program, 0:PARENT might have\n#   already exited, or might still be around. So we handle both.\n# We also let runc:[1:CHILD] count as the parent process, which can occur\n# when we lose events and lose track of state.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L676,L677","required_engine_version":"0.31.0","name":"container_entrypoint","macro":"container_entrypoint","condition":"(not proc.pname exists or proc.pname in (runc:[0:PARENT], runc:[1:CHILD], runc, docker-runc, exe, docker-runc-cur, containerd-shim, systemd, crio))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7"],"type":"macro","hash":"26bc459b2105c039deb4460ebd89573f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L679,L680","required_engine_version":"0.31.0","name":"user_known_system_user_login","macro":"user_known_system_user_login","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326"],"type":"macro","hash":"c220c191248c206685113a98cf6cc4f4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Anything run interactively by root\n# - condition: evt.type != switch and user.name = root and proc.name != sshd and interactive\n#  output: \"Interactive root (%user.name %proc.name %evt.dir %evt.type %evt.args %fd.name)\"\n#  priority: WARNING","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L686,L703","required_engine_version":"0.31.0","name":"System user interactive","rule":"System user interactive","condition":"spawned_process  and system_users  and interactive  and not user_known_system_user_login\n","desc":"System (e.g. non-login) users spawning new processes. Can add custom service users (e.g. apache or mysqld). 'Interactive' is defined as new processes as descendants of an ssh session or login process. Consider further tuning  by only looking at processes in a terminal / tty (proc.tty != 0). A newer field proc.is_vpgid_leader could be of help  to distinguish if the process was \"directly\" executed, for instance, in a tty, or executed as a descendant process in the  same process group, which, for example, is the case when subprocesses are spawned from a script. Consider this rule  as a great template rule to monitor interactive accesses to your systems more broadly. However, such a custom rule would be  unique to your environment. The rule \"Terminal shell in container\" that fires when using \"kubectl exec\" is more Kubernetes  relevant, whereas this one could be more interesting for the underlying host.\n","output":"System user ran an interactive command (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_stable","host","container","users","mitre_execution","T1059","NIST_800-53_AC-2"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:interactive:fe88c03a1958b4259f0c51d68eed3213","macro:system_users:ae2ad3d3da10c2072175ce20624812d4","macro:user_known_system_user_login:c220c191248c206685113a98cf6cc4f4","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"5bdbd778450a0e3fa8c0b9c8261f5326","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# In some cases, a shell is expected to be run in a container. For example, configuration\n# management software may do this, which is expected.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L707,L708","required_engine_version":"0.31.0","name":"user_expected_terminal_shell_in_container_conditions","macro":"user_expected_terminal_shell_in_container_conditions","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4"],"type":"macro","hash":"506bd5cc090648cf6e9411357909e53d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L710,L726","required_engine_version":"0.31.0","name":"Terminal shell in container","rule":"Terminal shell in container","condition":"spawned_process  and container and shell_procs  and proc.tty != 0 and container_entrypoint and not user_expected_terminal_shell_in_container_conditions\n","desc":"A shell was used as the entrypoint/exec point into a container with an attached terminal. Parent process may have  legitimately already exited and be null (read container_entrypoint macro). Common when using \"kubectl exec\" in Kubernetes.  Correlate with k8saudit exec logs if possible to find user or serviceaccount token used (fuzzy correlation by namespace and pod name).  Rather than considering it a standalone rule, it may be best used as generic auditing rule while examining other triggered  rules in this container/tty.\n","output":"A shell was spawned in a container with an attached terminal (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","container","shell","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:shell_procs:8907863a6a74678a4246f35930a29fe1","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","macro:user_expected_terminal_shell_in_container_conditions:506bd5cc090648cf6e9411357909e53d","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"1a24c2ccf3a790d0c04e3858f7439ab4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# For some container types (mesos), there isn't a container image to\n# work with, and the container name is autogenerated, so there isn't\n# any stable aspect of the software to work with. In this case, we\n# fall back to allowing certain command lines.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L732,L733","required_engine_version":"0.31.0","name":"known_shell_spawn_cmdlines","list":"known_shell_spawn_cmdlines","items":["\"sh -c uname -p 2\u003e /dev/null\"","\"sh -c uname -s 2\u003e\u00261\"","\"sh -c uname -r 2\u003e\u00261\"","\"sh -c uname -v 2\u003e\u00261\"","\"sh -c uname -a 2\u003e\u00261\"","\"sh -c ruby -v 2\u003e\u00261\"","\"sh -c getconf CLK_TCK\"","\"sh -c getconf PAGESIZE\"","\"sh -c LC_ALL=C LANG=C /sbin/ldconfig -p 2\u003e/dev/null\"","\"sh -c LANG=C /sbin/ldconfig -p 2\u003e/dev/null\"","\"sh -c /sbin/ldconfig -p 2\u003e/dev/null\"","\"sh -c stty -a 2\u003e/dev/null\"","\"sh -c stty -a \u003c /dev/tty\"","\"sh -c stty -g \u003c /dev/tty\"","\"sh -c node index.js\"","\"sh -c node index\"","\"sh -c node ./src/start.js\"","\"sh -c node app.js\"","\"sh -c node -e \\\"require('nan')\\\"\"","\"sh -c node -e \\\"require('nan')\\\")\"","\"sh -c node $NODE_DEBUG_OPTION index.js \"","\"sh -c crontab -l 2\"","\"sh -c lsb_release -a\"","\"sh -c lsb_release -is 2\u003e/dev/null\"","\"sh -c whoami\"","\"sh -c node_modules/.bin/bower-installer\"","\"sh -c /bin/hostname -f 2\u003e /dev/null\"","\"sh -c locale -a\"","\"sh -c  -t -i\"","\"sh -c openssl version\"","\"bash -c id -Gn kafadmin\"","\"sh -c /bin/sh -c 'date +%%s'\"","\"sh -c /usr/share/lighttpd/create-mime.conf.pl\""],"tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"list","hash":"a471b7368b7e78eb6da1a59b45d22732","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# This list allows for easy additions to the set of commands allowed\n# to run shells in containers without having to without having to copy\n# and override the entire run shell in container macro. Once\n# https://github.com/falcosecurity/falco/issues/255 is fixed this will be a\n# bit easier, as someone could append of any of the existing lists.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L774,L775","required_engine_version":"0.31.0","name":"user_known_shell_spawn_binaries","list":"user_known_shell_spawn_binaries","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"list","hash":"aee0480002d472c37c865d1f651a4c77","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# This macro allows for easy additions to the set of commands allowed\n# to run shells in containers without having to override the entire\n# rule. Its default value is an expression that always is false, which\n# becomes true when the \"not ...\" in the rule is applied.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L781,L782","required_engine_version":"0.31.0","name":"user_shell_container_exclusions","macro":"user_shell_container_exclusions","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15"],"type":"macro","hash":"f0b59b425c9d3204fb50ec6e436e8cd7","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# Containers from IBM Cloud","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L785,L787","required_engine_version":"0.31.0","name":"ibm_cloud_containers","list":"ibm_cloud_containers","items":["icr.io/ext/sysdig/agent","registry.ng.bluemix.net/armada-master/metrics-server-amd64","registry.ng.bluemix.net/armada-master/olm"],"tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3"],"type":"list","hash":"f4fc34c3b1d9f090b2dc45b4d4f7345f","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# In a local/user rules file, list the namespace or container images that are\n# allowed to contact the K8s API Server from within a container. This\n# might cover cases where the K8s infrastructure itself is running\n# within a container.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L795,L796","required_engine_version":"0.31.0","name":"k8s_containers","macro":"k8s_containers","condition":"(container.image.repository in (gcr.io/google_containers/hyperkube-amd64,\n gcr.io/google_containers/kube2sky,\n docker.io/sysdig/sysdig, sysdig/sysdig,\n fluent/fluentd-kubernetes-daemonset, prom/prometheus,\n falco_containers,\n falco_no_driver_containers,\n ibm_cloud_containers,\n velero/velero,\n quay.io/jetstack/cert-manager-cainjector, weaveworks/kured,\n quay.io/prometheus-operator/prometheus-operator,\n registry.k8s.io/ingress-nginx/kube-webhook-certgen, quay.io/spotahome/redis-operator,\n registry.opensource.zalan.do/acid/postgres-operator, registry.opensource.zalan.do/acid/postgres-operator-ui,\n rabbitmqoperator/cluster-operator, quay.io/kubecost1/kubecost-cost-model,\n docker.io/bitnami/prometheus, docker.io/bitnami/kube-state-metrics, mcr.microsoft.com/oss/azure/aad-pod-identity/nmi)\n or (k8s.ns.name = \"kube-system\"))\n","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4","list:falco_no_driver_containers:4f989b0d285e037e0ff36043120df432","list:ibm_cloud_containers:f4fc34c3b1d9f090b2dc45b4d4f7345f","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:ingress:17f1d7a64442cda6863a4251c2eaf2ee","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4"],"used_by":["rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e"],"type":"macro","hash":"d8bdacbfed1ae82231bffc00d31c49e3","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L813,L814","required_engine_version":"0.31.0","name":"k8s_api_server","macro":"k8s_api_server","condition":"(fd.sip.name=\"kubernetes.default.svc.cluster.local\")","tags":null,"enabled":"true","used_by":["rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27"],"type":"macro","hash":"00fa288aff0ae1a736dd65b8e8b2a29d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L816,L817","required_engine_version":"0.31.0","name":"user_known_contact_k8s_api_server_activities","macro":"user_known_contact_k8s_api_server_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27"],"type":"macro","hash":"4c6ed813572d74073bccdf798a240244","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L819,L836","required_engine_version":"0.31.0","name":"Contact K8S API Server From Container","rule":"Contact K8S API Server From Container","condition":"evt.type=connect and evt.dir=\u003c  and (fd.typechar=4 or fd.typechar=6)  and container  and k8s_api_server  and not k8s_containers  and not user_known_contact_k8s_api_server_activities\n","desc":"Detect attempts to communicate with the K8S API Server from a container by non-profiled users. Kubernetes APIs play a  pivotal role in configuring the cluster management lifecycle. Detecting potential unauthorized access to the API server  is of utmost importance. Audit your complete infrastructure and pinpoint any potential machines from which the API server  might be accessible based on your network layout. If Falco can't operate on all these machines, consider analyzing the  Kubernetes audit logs (typically drained from control nodes, and Falco offers a k8saudit plugin) as an additional data  source for detections within the control plane.\n","output":"Unexpected connection to K8s API Server from container (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","container","network","k8s","mitre_discovery","T1565"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:k8s_api_server:00fa288aff0ae1a736dd65b8e8b2a29d","macro:user_known_contact_k8s_api_server_activities:4c6ed813572d74073bccdf798a240244","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"d067eb11f0680c4f94e83770bd307c27","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L838,L856","required_engine_version":"0.31.0","name":"Netcat Remote Code Execution in Container","rule":"Netcat Remote Code Execution in Container","condition":"spawned_process  and container  and ((proc.name = \"nc\" and (proc.cmdline contains \" -e\" or \n                            proc.cmdline contains \" -c\")) or\n     (proc.name = \"ncat\" and (proc.args contains \"--sh-exec\" or \n                              proc.args contains \"--exec\" or proc.args contains \"-e \" or\n                              proc.args contains \"-c \" or proc.args contains \"--lua-exec\"))\n     )\n","desc":"Netcat Program runs inside container that allows remote code execution and may be utilized  as a part of a variety of reverse shell payload https://github.com/swisskyrepo/PayloadsAllTheThings/. These programs are of higher relevance as they are commonly installed on UNIX-like operating systems. Can fire in combination with the \"Redirect STDOUT/STDIN to Network Connection in Container\"  rule as it utilizes a different evt.type.\n","output":"Netcat runs inside container that allows remote code execution (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","container","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"b1be8adba840b7e237a11c3744fc2a3e","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L858,L859","required_engine_version":"0.31.0","name":"grep_binaries","list":"grep_binaries","items":["grep","egrep","fgrep"],"tags":null,"enabled":"true","used_by":["macro:grep_commands:04176c101a26b7187926f0abb44c4ff6"],"type":"list","hash":"6c151c686d54f0194bc8815228f0fa3b","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L861,L862","required_engine_version":"0.31.0","name":"grep_commands","macro":"grep_commands","condition":"(proc.name in (grep_binaries))","tags":null,"enabled":"true","dependencies":["list:grep_binaries:6c151c686d54f0194bc8815228f0fa3b"],"used_by":["rule:Search Private Keys or Passwords:55941ff25a7d8c6253b5a17e4ed20d30","rule:Find AWS Credentials:6f600d3da731ed8b36a42b3e6edc613a"],"type":"macro","hash":"04176c101a26b7187926f0abb44c4ff6","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# a less restrictive search for things that might be passwords/ssh/user etc.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L865,L866","required_engine_version":"0.31.0","name":"grep_more","macro":"grep_more","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:private_key_or_password:0ef2bde6b9b81c59ef2c8881eb3b7107"],"type":"macro","hash":"1f162d2b9d80645c0c17e19656463e53","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L868,L869","required_engine_version":"0.31.0","name":"private_key_or_password","macro":"private_key_or_password","condition":"(proc.args icontains \"BEGIN PRIVATE\" or\n proc.args icontains \"BEGIN OPENSSH PRIVATE\" or\n proc.args icontains \"BEGIN RSA PRIVATE\" or\n proc.args icontains \"BEGIN DSA PRIVATE\" or\n proc.args icontains \"BEGIN EC PRIVATE\" or\n (grep_more and\n  (proc.args icontains \" pass \" or\n   proc.args icontains \" ssh \" or\n   proc.args icontains \" user \"))\n)\n","tags":null,"enabled":"true","dependencies":["macro:grep_more:1f162d2b9d80645c0c17e19656463e53"],"used_by":["rule:Search Private Keys or Passwords:55941ff25a7d8c6253b5a17e4ed20d30"],"type":"macro","hash":"0ef2bde6b9b81c59ef2c8881eb3b7107","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L881,L899","required_engine_version":"0.31.0","name":"Search Private Keys or Passwords","rule":"Search Private Keys or Passwords","condition":"spawned_process  and ((grep_commands and private_key_or_password) or\n     (proc.name = \"find\" and (proc.args contains \"id_rsa\" or \n                              proc.args contains \"id_dsa\" or \n                              proc.args contains \"id_ed25519\" or \n                              proc.args contains \"id_ecdsa\"\n      )\n    ))\n","desc":"Detect attempts to search for private keys or passwords using the grep or find command. This is often seen with  unsophisticated attackers, as there are many ways to access files using bash built-ins that could go unnoticed.  Regardless, this serves as a solid baseline detection that can be tailored to cover these gaps while maintaining  an acceptable noise level.\n","output":"Grep private keys or passwords activities found (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","process","filesystem","mitre_credential_access","T1552.001"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:grep_commands:04176c101a26b7187926f0abb44c4ff6","macro:private_key_or_password:0ef2bde6b9b81c59ef2c8881eb3b7107","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"55941ff25a7d8c6253b5a17e4ed20d30","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L901,L902","required_engine_version":"0.31.0","name":"log_directories","list":"log_directories","items":["/var/log","/dev/log"],"tags":null,"enabled":"true","used_by":["macro:access_log_files:bba37fe39a9099e9fd050a455d7fb794"],"type":"list","hash":"39fadae9f829adaeb52681a3ad931a14","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L904,L905","required_engine_version":"0.31.0","name":"log_files","list":"log_files","items":["syslog","auth.log","secure","kern.log","cron","user.log","dpkg.log","last.log","yum.log","access_log","mysql.log","mysqld.log"],"tags":null,"enabled":"true","used_by":["macro:access_log_files:bba37fe39a9099e9fd050a455d7fb794","rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4"],"type":"list","hash":"55714339632c0160f10b39434333e3f5","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L907,L908","required_engine_version":"0.31.0","name":"access_log_files","macro":"access_log_files","condition":"(fd.directory in (log_directories) or fd.filename in (log_files))","tags":null,"enabled":"true","dependencies":["list:log_directories:39fadae9f829adaeb52681a3ad931a14","list:log_files:55714339632c0160f10b39434333e3f5"],"used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4"],"type":"macro","hash":"bba37fe39a9099e9fd050a455d7fb794","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# a placeholder for whitelist log files that could be cleared. Recommend the macro as (fd.name startswith \"/var/log/app1*\")","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L911,L912","required_engine_version":"0.31.0","name":"allowed_clear_log_files","macro":"allowed_clear_log_files","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4"],"type":"macro","hash":"27cabc017fb347048c5906d368af02da","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L914,L915","required_engine_version":"0.31.0","name":"trusted_logging_images","macro":"trusted_logging_images","condition":"(container.image.repository endswith \"splunk/fluentd-hec\" or container.image.repository endswith \"fluent/fluentd-kubernetes-daemonset\" or container.image.repository endswith \"openshift3/ose-logging-fluentd\" or container.image.repository endswith \"containernetworking/azure-npm\")","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4"],"type":"macro","hash":"321c1a70d9796565640a81b9f3701e42","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L920,L921","required_engine_version":"0.31.0","name":"containerd_activities","macro":"containerd_activities","condition":"(proc.name=containerd and (fd.name startswith \"/var/lib/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/\" or fd.name startswith \"/var/lib/containerd/tmpmounts/\"))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4"],"type":"macro","hash":"c2ce963725cd72b3df80b07413b7e4c4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L924,L939","required_engine_version":"0.31.0","name":"Clear Log Activities","rule":"Clear Log Activities","condition":"open_write  and access_log_files  and evt.arg.flags contains \"O_TRUNC\"  and not containerd_activities and not trusted_logging_images  and not allowed_clear_log_files\n","desc":"Detect clearing of critical access log files, typically done to erase evidence that could be attributed to an adversary's  actions. To effectively customize and operationalize this detection, check for potentially missing log file destinations  relevant to your environment, and adjust the profiled containers you wish not to be alerted on.\n","output":"Log files were tampered (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_defense_evasion","T1070","NIST_800-53_AU-10"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:log_files:55714339632c0160f10b39434333e3f5","macro:access_log_files:bba37fe39a9099e9fd050a455d7fb794","macro:allowed_clear_log_files:27cabc017fb347048c5906d368af02da","macro:trusted_logging_images:321c1a70d9796565640a81b9f3701e42","macro:containerd_activities:c2ce963725cd72b3df80b07413b7e4c4","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"791121642c2a993b9c4b71e1dc53dcf4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L941,L942","required_engine_version":"0.31.0","name":"data_remove_commands","list":"data_remove_commands","items":["shred","mkfs","mke2fs"],"tags":null,"enabled":"true","used_by":["macro:clear_data_procs:d1a24b75738d164999774767fb52b175"],"type":"list","hash":"9919c21161d44c1840f522f7d9fbc5e4","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L944,L945","required_engine_version":"0.31.0","name":"clear_data_procs","macro":"clear_data_procs","condition":"(proc.name in (data_remove_commands))","tags":null,"enabled":"true","dependencies":["list:data_remove_commands:9919c21161d44c1840f522f7d9fbc5e4","macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:remove:0f6969d7052da9261e31ddb6e88c136e"],"used_by":["rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206"],"type":"macro","hash":"d1a24b75738d164999774767fb52b175","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L947,L948","required_engine_version":"0.31.0","name":"user_known_remove_data_activities","macro":"user_known_remove_data_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206"],"type":"macro","hash":"82aeff15fb6a39dfd18eb8a0aa4490b2","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L950,L961","required_engine_version":"0.31.0","name":"Remove Bulk Data from Disk","rule":"Remove Bulk Data from Disk","condition":"spawned_process  and clear_data_procs  and not user_known_remove_data_activities\n","desc":"Detect a process running to clear bulk data from disk with the intention to destroy data, possibly interrupting availability  to systems. Profile your environment and use user_known_remove_data_activities to tune this rule.\n","output":"Bulk data has been removed from disk (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","process","filesystem","mitre_impact","T1485"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:clear_data_procs:d1a24b75738d164999774767fb52b175","macro:user_known_remove_data_activities:82aeff15fb6a39dfd18eb8a0aa4490b2","macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"ee50daeb936f1d2a3ecf9211b963d206","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L963,L973","required_engine_version":"0.31.0","name":"Create Symlink Over Sensitive Files","rule":"Create Symlink Over Sensitive Files","condition":"create_symlink  and (evt.arg.target in (sensitive_file_names) or evt.arg.target in (sensitive_directory_names))\n","desc":"Detect symlinks created over a curated list of sensitive files or subdirectories under /etc/ or  root directories. Can be customized as needed. Refer to further and equivalent guidance within the  rule \"Read sensitive file untrusted\".\n","output":"Symlinks created over sensitive files (target=%evt.arg.target linkpath=%evt.arg.linkpath evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_credential_access","T1555"],"enabled":"true","dependencies":["macro:create_symlink:35e03553351704bb106cfe6792249297","list:sensitive_file_names:e54197be4a07891d91c98ea756ac113d","list:sensitive_directory_names:fa2eee2cc3ead2d99ca3d4789e90621c"],"type":"rule","hash":"2bcdd8e246ad13d6937576a2d5cbce01","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L975,L985","required_engine_version":"0.31.0","name":"Create Hardlink Over Sensitive Files","rule":"Create Hardlink Over Sensitive Files","condition":"create_hardlink  and (evt.arg.oldpath in (sensitive_file_names))\n","desc":"Detect hardlink created over a curated list of sensitive files or subdirectories under /etc/ or  root directories. Can be customized as needed. Refer to further and equivalent guidance within the  rule \"Read sensitive file untrusted\".\n","output":"Hardlinks created over sensitive files (target=%evt.arg.oldpath linkpath=%evt.arg.newpath evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","filesystem","mitre_credential_access","T1555"],"enabled":"true","dependencies":["macro:create_hardlink:8793cb40375e36decc9d0527e9a044db","list:sensitive_file_names:e54197be4a07891d91c98ea756ac113d"],"type":"rule","hash":"44f504a9337c5c86699a0cb02a0a355d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L987,L988","required_engine_version":"0.31.0","name":"user_known_packet_socket_binaries","list":"user_known_packet_socket_binaries","tags":null,"enabled":"true","used_by":["rule:Packet socket created in container:59e21c1607722fe0bee894eff26d9025"],"type":"list","hash":"423133c62533ff12397ea330a9f04cf7","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L990,L1002","required_engine_version":"0.31.0","name":"Packet socket created in container","rule":"Packet socket created in container","condition":"evt.type=socket and evt.dir=\u003e and container  and evt.arg.domain contains AF_PACKET  and not proc.name in (user_known_packet_socket_binaries)\n","desc":"Detect new packet socket at the device driver (OSI Layer 2) level in a container. Packet socket could be used for ARP Spoofing  and privilege escalation (CVE-2020-14386) by an attacker. Noise can be reduced by using the user_known_packet_socket_binaries template list.\n","output":"Packet socket was created in a container (socket_info=%evt.args connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","container","network","mitre_credential_access","T1557.002"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:user_known_packet_socket_binaries:423133c62533ff12397ea330a9f04cf7","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"59e21c1607722fe0bee894eff26d9025","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1004,L1005","required_engine_version":"0.31.0","name":"user_known_stand_streams_redirect_activities","macro":"user_known_stand_streams_redirect_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Redirect STDOUT/STDIN to Network Connection in Container:3448315ac2834f28f611653e79764663"],"type":"macro","hash":"c2f8c69b4ec7a2b55cd5ce0381586875","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# As of engine version 20 this rule can be improved by using the fd.types[]\n# field so it only triggers once when all three of std{out,err,in} are\n# redirected.\n#\n# - list: ip_sockets\n#   items: [\"ipv4\", \"ipv6\"]\n#\n# - rule: Redirect STDOUT/STDIN to Network Connection in Container once\n#   condition: dup and container and evt.rawres in (0, 1, 2) and fd.type in (ip_sockets) and fd.types[0] in (ip_sockets) and fd.types[1] in (ip_sockets) and fd.types[2] in (ip_sockets) and not user_known_stand_streams_redirect_activities\n#\n# The following rule has not been changed by default as existing users could be\n# relying on the rule triggering when any of std{out,err,in} are redirected.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1019,L1035","required_engine_version":"0.31.0","name":"Redirect STDOUT/STDIN to Network Connection in Container","rule":"Redirect STDOUT/STDIN to Network Connection in Container","condition":"dup  and container  and evt.rawres in (0, 1, 2)  and fd.type in (\"ipv4\", \"ipv6\")  and not user_known_stand_streams_redirect_activities\n","desc":"Detect redirection of stdout/stdin to a network connection within a container, achieved by utilizing a  variant of the dup syscall (potential reverse shell or remote code execution  https://github.com/swisskyrepo/PayloadsAllTheThings/). This detection is behavior-based and may generate  noise in the system, and can be adjusted using the user_known_stand_streams_redirect_activities template  macro. Tuning can be performed similarly to existing detections based on process lineage or container images,  and/or it can be limited to interactive tty (tty != 0).\n","output":"Redirect stdout/stdin to network connection (gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] fd.sip=%fd.sip connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","container","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:dup:0e9f1e8e40bb79e800b0cc9433830cf4","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:user_known_stand_streams_redirect_activities:c2f8c69b4ec7a2b55cd5ce0381586875","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"3448315ac2834f28f611653e79764663","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1037,L1038","required_engine_version":"0.31.0","name":"allowed_container_images_loading_kernel_module","list":"allowed_container_images_loading_kernel_module","tags":null,"enabled":"true","used_by":["rule:Linux Kernel Module Injection Detected:41258ebe4f0565b8c3c1ddd96663c1a6"],"type":"list","hash":"f3b78b0d921d327ef27b35c244f6d83c","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1040,L1052","required_engine_version":"0.31.0","name":"Linux Kernel Module Injection Detected","rule":"Linux Kernel Module Injection Detected","condition":"kernel_module_load  and container  and thread.cap_effective icontains sys_module  and not container.image.repository in (allowed_container_images_loading_kernel_module)\n","desc":"Inject Linux Kernel Modules from containers using insmod or modprobe with init_module and finit_module syscalls, given the precondition of sys_module effective capabilities. Profile the environment and consider allowed_container_images_loading_kernel_module to reduce noise and account for legitimate cases.\n","output":"Linux Kernel Module injection from container (parent_exepath=%proc.pexepath gparent=%proc.aname[2] gexepath=%proc.aexepath[2] module=%proc.args res=%evt.res evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","process","mitre_persistence","TA0003"],"enabled":"true","dependencies":["macro:kernel_module_load:3a34b01673a16b2e4d0286248a2b024e","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:allowed_container_images_loading_kernel_module:f3b78b0d921d327ef27b35c244f6d83c","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"41258ebe4f0565b8c3c1ddd96663c1a6","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1054,L1065","required_engine_version":"0.31.0","name":"Debugfs Launched in Privileged Container","rule":"Debugfs Launched in Privileged Container","condition":"spawned_process  and container and container.privileged=true and proc.name=debugfs\n","desc":"Detect file system debugger debugfs launched inside a privileged container which might lead to container escape.  This rule has a more narrow scope.\n","output":"Debugfs launched started in a privileged container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","container","cis","process","mitre_privilege_escalation","T1611"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"6a074afb1d46b7c8e242bf8390fc101c","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1067,L1080","required_engine_version":"0.31.0","name":"Detect release_agent File Container Escapes","rule":"Detect release_agent File Container Escapes","condition":"open_write  and container  and fd.name endswith release_agent  and (user.uid=0 or thread.cap_effective contains CAP_DAC_OVERRIDE)  and thread.cap_effective contains CAP_SYS_ADMIN\n","desc":"Detect an attempt to exploit a container escape using release_agent file.  By running a container with certains capabilities, a privileged user can modify  release_agent file and escape from the container.\n","output":"Detect an attempt to exploit a container escape using release_agent file (file=%fd.name cap_effective=%thread.cap_effective evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_stable","container","process","mitre_privilege_escalation","T1611"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"d55778da6b1e973e75c07a0379882547","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1082,L1083","required_engine_version":"0.31.0","name":"docker_binaries","list":"docker_binaries","items":["docker","dockerd","containerd-shim","runc:[1:CHILD]","pause","exe","docker-compose","docker-entrypoi","docker-runc-cur","docker-current","dockerd-current"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc","macro:docker_procs:26fc5da2b4808fa032d520b261d62d9d"],"type":"list","hash":"663cca84b425c42a03acc1f2ee04be85","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1085,L1086","required_engine_version":"0.31.0","name":"known_ptrace_binaries","list":"known_ptrace_binaries","tags":null,"enabled":"true","used_by":["macro:known_ptrace_procs:413474c52ae5a2f9ab13410a94a7759a"],"type":"list","hash":"eb5e413691c24ce29dc359f53dc02199","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1088,L1089","required_engine_version":"0.31.0","name":"known_ptrace_procs","macro":"known_ptrace_procs","condition":"(proc.name in (known_ptrace_binaries))","tags":null,"enabled":"true","dependencies":["list:known_ptrace_binaries:eb5e413691c24ce29dc359f53dc02199"],"used_by":["rule:PTRACE attached to process:061f25635ba16ec4c05dec23396e4a6d"],"type":"macro","hash":"413474c52ae5a2f9ab13410a94a7759a","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1091,L1092","required_engine_version":"0.31.0","name":"ptrace_attach_or_injection","macro":"ptrace_attach_or_injection","condition":"(evt.type=ptrace and evt.dir=\u003e and (evt.arg.request contains PTRACE_POKETEXT or evt.arg.request contains PTRACE_POKEDATA or evt.arg.request contains PTRACE_ATTACH or evt.arg.request contains PTRACE_SEIZE or evt.arg.request contains PTRACE_SETREGS))\n","tags":null,"enabled":"true","used_by":["rule:PTRACE attached to process:061f25635ba16ec4c05dec23396e4a6d"],"type":"macro","hash":"c4feb84db3def9a82221d06935faf9bb","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1100,L1112","required_engine_version":"0.31.0","name":"PTRACE attached to process","rule":"PTRACE attached to process","condition":"ptrace_attach_or_injection  and proc_name_exists  and not known_ptrace_procs\n","desc":"Detect an attempt to inject potentially malicious code into a process using PTRACE in order to evade  process-based defenses or elevate privileges. Common anti-patterns are debuggers. Additionally, profiling  your environment via the known_ptrace_procs template macro can reduce noise.  A successful ptrace syscall generates multiple logs at once.\n","output":"Detected ptrace PTRACE_ATTACH attempt (proc_pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","process","mitre_privilege_escalation","T1055.008"],"enabled":"true","dependencies":["macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:known_ptrace_procs:413474c52ae5a2f9ab13410a94a7759a","macro:ptrace_attach_or_injection:c4feb84db3def9a82221d06935faf9bb","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3"],"type":"rule","hash":"061f25635ba16ec4c05dec23396e4a6d","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1114,L1125","required_engine_version":"0.31.0","name":"PTRACE anti-debug attempt","rule":"PTRACE anti-debug attempt","condition":"evt.type=ptrace and evt.dir=\u003e  and evt.arg.request contains PTRACE_TRACEME  and proc_name_exists\n","desc":"Detect usage of the PTRACE system call with the PTRACE_TRACEME argument, indicating a program actively attempting  to avoid debuggers attaching to the process. This behavior is typically indicative of malware activity. Read more about PTRACE in the \"PTRACE attached to process\" rule.\n","output":"Detected potential PTRACE_TRACEME anti-debug attempt (proc_pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","host","container","process","mitre_defense_evasion","T1622"],"enabled":"true","dependencies":["macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3"],"type":"rule","hash":"2552a1ec1bd48915c8e2f2279ea7054e","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1127,L1128","required_engine_version":"0.31.0","name":"private_aws_credentials","macro":"private_aws_credentials","condition":"(proc.args icontains \"aws_access_key_id\" or proc.args icontains \"aws_secret_access_key\" or proc.args icontains \"aws_session_token\" or proc.args icontains \"accesskeyid\" or proc.args icontains \"secretaccesskey\")\n","tags":null,"enabled":"true","dependencies":["macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69"],"used_by":["rule:Find AWS Credentials:6f600d3da731ed8b36a42b3e6edc613a"],"type":"macro","hash":"9fcead5c6eef1bdbf3f1a4981a100df6","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1135,L1147","required_engine_version":"0.31.0","name":"Find AWS Credentials","rule":"Find AWS Credentials","condition":"spawned_process  and ((grep_commands and private_aws_credentials) or\n     (proc.name = \"find\" and proc.args endswith \".aws/credentials\"))\n","desc":"Detect attempts to search for private keys or passwords using the grep or find command, particularly targeting standard  AWS credential locations. This is often seen with unsophisticated attackers, as there are many ways to access files  using bash built-ins that could go unnoticed. Regardless, this serves as a solid baseline detection that can be tailored  to cover these gaps while maintaining an acceptable noise level. This rule complements the rule \"Search Private Keys or Passwords\".\n","output":"Detected AWS credentials search activity (proc_pcmdline=%proc.pcmdline proc_cwd=%proc.cwd group_gid=%group.gid group_name=%group.name user_loginname=%user.loginname evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","process","aws","mitre_credential_access","T1552"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:grep_commands:04176c101a26b7187926f0abb44c4ff6","macro:private_aws_credentials:9fcead5c6eef1bdbf3f1a4981a100df6","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"6f600d3da731ed8b36a42b3e6edc613a","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1149,L1166","required_engine_version":"0.31.0","name":"Execution from /dev/shm","rule":"Execution from /dev/shm","condition":"spawned_process  and (proc.exe startswith \"/dev/shm/\" or \n    (proc.cwd startswith \"/dev/shm/\" and proc.exe startswith \"./\" ) or \n    (shell_procs and proc.args startswith \"-c /dev/shm\") or \n    (shell_procs and proc.args startswith \"-i /dev/shm\") or \n    (shell_procs and proc.args startswith \"/dev/shm\") or \n    (proc.cwd startswith \"/dev/shm/\" and proc.args startswith \"./\" )) \nand not container.image.repository in (falco_privileged_images, trusted_images)\n","desc":"This rule detects file execution in the /dev/shm directory, a tactic often used by threat actors to store their readable, writable, and  occasionally executable files. /dev/shm acts as a link to the host or other containers, creating vulnerabilities for their compromise  as well. Notably, /dev/shm remains unchanged even after a container restart. Consider this rule alongside the newer  \"Drop and execute new binary in container\" rule.\n","output":"File execution detected from /dev/shm (evt_res=%evt.res file=%fd.name proc_cwd=%proc.cwd proc_pcmdline=%proc.pcmdline user_loginname=%user.loginname group_gid=%group.gid group_name=%group.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_stable","host","container","mitre_execution","T1059.004"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:shell_procs:8907863a6a74678a4246f35930a29fe1","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","list:falco_privileged_images:fcbbd9234536bd53a20eb8d98e3fd443","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","list:falco_privileged_images:fcbbd9234536bd53a20eb8d98e3fd443","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa"],"type":"rule","hash":"d11fc15d58c80066743faeab957a1684","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# List of allowed container images that are known to execute binaries not part of their base image.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1169,L1170","required_engine_version":"0.31.0","name":"known_drop_and_execute_containers","list":"known_drop_and_execute_containers","tags":null,"enabled":"true","used_by":["rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6"],"type":"list","hash":"8c19a829f77003357ec93fdddd149730","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1172,L1173","required_engine_version":"0.31.0","name":"known_drop_and_execute_activities","macro":"known_drop_and_execute_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6"],"type":"macro","hash":"a1a1ce54329c3cd6f627d9bdc5e50ea8","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1175,L1193","required_engine_version":"0.31.0","name":"Drop and execute new binary in container","rule":"Drop and execute new binary in container","condition":"spawned_process and container and proc.is_exe_upper_layer=true  and not container.image.repository in (known_drop_and_execute_containers) and not known_drop_and_execute_activities\n","desc":"Detect if an executable not belonging to the base image of a container is being executed. The drop and execute pattern can be observed very often after an attacker gained an initial foothold. is_exe_upper_layer filter field only applies for container runtimes that use overlayfs as union mount filesystem. Adopters can utilize the provided template list known_drop_and_execute_containers containing allowed container  images known to execute binaries not included in their base image. Alternatively, you could exclude non-production namespaces in Kubernetes settings by adjusting the rule further. This helps reduce noise by applying application  and environment-specific knowledge to this rule. Common anti-patterns include administrators or SREs performing  ad-hoc debugging.\n","output":"Executing binary not part of base image (proc_exe=%proc.exe proc_sname=%proc.sname gparent=%proc.aname[2] proc_exe_ino_ctime=%proc.exe_ino.ctime proc_exe_ino_mtime=%proc.exe_ino.mtime proc_exe_ino_ctime_duration_proc_start=%proc.exe_ino.ctime_duration_proc_start proc_cwd=%proc.cwd container_start_ts=%container.start_ts evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_stable","container","process","mitre_persistence","TA0003","PCI_DSS_11.5.1"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:known_drop_and_execute_containers:8c19a829f77003357ec93fdddd149730","macro:known_drop_and_execute_activities:a1a1ce54329c3cd6f627d9bdc5e50ea8","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"ea1bc081c535967ed009cd4b0a4d9df6","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"# RFC1918 addresses were assigned for private network usage","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1196,L1197","required_engine_version":"0.31.0","name":"rfc_1918_addresses","list":"rfc_1918_addresses","items":["\"10.0.0.0/8\"","\"172.16.0.0/12\"","\"192.168.0.0/16\""],"tags":null,"enabled":"true","used_by":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:network_local_subnet:7c4dcd18fe7bc3092fbc897963b579e1","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"list","hash":"748492cefb06210e27885e76e1ab8f7a","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1199,L1200","required_engine_version":"0.31.0","name":"outbound","macro":"outbound","condition":"(((evt.type = connect and evt.dir=\u003c) or\n  (evt.type in (sendto,sendmsg) and evt.dir=\u003c and\n   fd.l4proto != tcp and fd.connected=false and fd.name_changed=true)) and\n (fd.typechar = 4 or fd.typechar = 6) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","dependencies":["list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a"],"used_by":["rule:Disallowed SSH Connection Non Standard Port:8d88e40d9773d500a7fb9fb5d28d0aad","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Interpreted procs outbound network activity:f44c77a690d44b9d8004d3283a63cb92","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"b5229dfdd9136d1c772f9070f3095016","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1208,L1209","required_engine_version":"0.31.0","name":"ssh_non_standard_ports","list":"ssh_non_standard_ports","items":["80","8080","88","443","8443","53","4444"],"tags":null,"enabled":"true","used_by":["macro:ssh_non_standard_ports_network:862bb6d69a748ef55e8ac568da61c87e","rule:Disallowed SSH Connection Non Standard Port:8d88e40d9773d500a7fb9fb5d28d0aad"],"type":"list","hash":"7ebec6e892b633d83dd16b5973ec3b42","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1211,L1212","required_engine_version":"0.31.0","name":"ssh_non_standard_ports_network","macro":"ssh_non_standard_ports_network","condition":"(fd.sport in (ssh_non_standard_ports))","tags":null,"enabled":"true","dependencies":["list:ssh_non_standard_ports:7ebec6e892b633d83dd16b5973ec3b42"],"used_by":["rule:Disallowed SSH Connection Non Standard Port:8d88e40d9773d500a7fb9fb5d28d0aad"],"type":"macro","hash":"862bb6d69a748ef55e8ac568da61c87e","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1214,L1230","required_engine_version":"0.31.0","name":"Disallowed SSH Connection Non Standard Port","rule":"Disallowed SSH Connection Non Standard Port","condition":"outbound  and proc.exe endswith ssh  and fd.l4proto=tcp  and ssh_non_standard_ports_network\n","desc":"Detect any new outbound SSH connection from the host or container using a non-standard port. This rule holds the potential  to detect a family of reverse shells that cause the victim machine to connect back out over SSH, with STDIN piped from  the SSH connection to a shell's STDIN, and STDOUT of the shell piped back over SSH. Such an attack can be launched against  any app that is vulnerable to command injection. The upstream rule only covers a limited selection of non-standard ports.  We suggest adding more ports, potentially incorporating ranges based on your environment's knowledge and custom SSH port  configurations. This rule can complement the \"Redirect STDOUT/STDIN to Network Connection in Container\" or  \"Disallowed SSH Connection\" rule.\n","output":"Disallowed SSH Connection (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_stable","host","container","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","list:ssh_non_standard_ports:7ebec6e892b633d83dd16b5973ec3b42","macro:ssh_non_standard_ports_network:862bb6d69a748ef55e8ac568da61c87e","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016"],"type":"rule","hash":"8d88e40d9773d500a7fb9fb5d28d0aad","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1232,L1233","required_engine_version":"0.31.0","name":"known_memfd_execution_binaries","list":"known_memfd_execution_binaries","tags":null,"enabled":"true","used_by":["macro:known_memfd_execution_processes:c8e939c1587129ca24f6e24930def9b7"],"type":"list","hash":"ef5012d056f6a5ced22949026684a6bf","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1235,L1236","required_engine_version":"0.31.0","name":"known_memfd_execution_processes","macro":"known_memfd_execution_processes","condition":"(proc.name in (known_memfd_execution_binaries))","tags":null,"enabled":"true","dependencies":["list:known_memfd_execution_binaries:ef5012d056f6a5ced22949026684a6bf"],"used_by":["rule:Fileless execution via memfd_create:421925c119255e3807c6bbf9609c23cb"],"type":"macro","hash":"c8e939c1587129ca24f6e24930def9b7","maturity":"stable"},{"file_name":"falco_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco_rules.yaml#L1238,L1250","required_engine_version":"0.31.0","name":"Fileless execution via memfd_create","rule":"Fileless execution via memfd_create","condition":"spawned_process and proc.is_exe_from_memfd=true and not known_memfd_execution_processes\n","desc":"Detect if a binary is executed from memory using the memfd_create technique. This is a well-known defense evasion  technique for executing malware on a victim machine without storing the payload on disk and to avoid leaving traces  about what has been executed. Adopters can whitelist processes that may use fileless execution for benign purposes  by adding items to the list known_memfd_execution_processes.\n","output":"Fileless execution via memfd_create (container_start_ts=%container.start_ts proc_cwd=%proc.cwd evt_res=%evt.res proc_sname=%proc.sname gparent=%proc.aname[2] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_stable","host","container","process","mitre_defense_evasion","T1620"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:known_memfd_execution_processes:c8e939c1587129ca24f6e24930def9b7","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"421925c119255e3807c6bbf9609c23cb","maturity":"stable"},{"file_name":"k8s_audit_rules.yaml","comment":"# Like always_true/always_false, but works with k8s audit events","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L33,L34","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_always_true","macro":"k8s_audit_always_true","condition":"(jevt.rawtime exists)","tags":null,"enabled":"true","used_by":["macro:allowed_k8s_containers:5d511025a0b51bc9c69d1f382f0d7b55","macro:consider_activity_events:89419f9eea00ed54a7e7dc8be73546e0","macro:allowed_full_admin_users:7b1c241c01498a54f103f3d91c24fd5f","macro:allow_all_k8s_nodes:dcfaad7a677bccbcaee9df174560a2af"],"type":"macro","hash":"21ef6651784861fced1315889d54de4f"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L36,L37","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_never_true","macro":"k8s_audit_never_true","condition":"(jevt.rawtime=0)","tags":null,"enabled":"true","used_by":["macro:user_known_node_port_service:eef8c8cb2dddbde98acc0032c8437a1e","macro:user_known_exec_pod_activities:654a93971e99c9f7b3bb5a8614b96d7f","macro:user_known_portforward_activities:c1bda959367c501d28cf34ac7b327cd5","macro:user_known_pod_debug_activities:f680ce82ade487e7d4c6d0bcf300391a","macro:consider_all_events:38d89891d1f279c05021c92e24eee45a"],"type":"macro","hash":"9a704dd4f5279b6d5619cb257258825a"},{"file_name":"k8s_audit_rules.yaml","comment":"# Generally only consider audit events once the response has completed","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L40,L41","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_stages","list":"k8s_audit_stages","items":["ResponseComplete"],"tags":null,"enabled":"true","used_by":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532"],"type":"list","hash":"39538ea9b89d00871aaf74e6bc5584ae"},{"file_name":"k8s_audit_rules.yaml","comment":"# Generally exclude users starting with \"system:\"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L44,L45","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"non_system_user","macro":"non_system_user","condition":"(not ka.user.name startswith \"system:\")","tags":null,"enabled":"true","used_by":["rule:Disallowed K8s User:3c7c39a2467726e0ac1db091b3fa729a","rule:K8s Namespace Deleted:32d046d86731ba73014ef4a3e6982de3","rule:K8s Secret Created:0cfe5113b020e988115c63966a0096e3","rule:K8s Secret Deleted:5d9fab46ecddd2256510223c81935a65","rule:Full K8s Administrative Access:fdc73e7ea6f6062e87e06bc3a197bbba"],"type":"macro","hash":"ea1dd8f878301676703a9f8cae5270c7"},{"file_name":"k8s_audit_rules.yaml","comment":"# This macro selects the set of Audit Events used by the below rules.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L48,L49","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kevt","macro":"kevt","condition":"(jevt.value[/stage] in (k8s_audit_stages))","tags":null,"enabled":"true","dependencies":["list:k8s_audit_stages:39538ea9b89d00871aaf74e6bc5584ae"],"used_by":["rule:Disallowed K8s User:3c7c39a2467726e0ac1db091b3fa729a","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","rule:Create Privileged Pod:70ca8c72d4fffc0c2f21c8aa705141fd","rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e","rule:Create HostNetwork Pod:f1bc06aae08495b5910b365c31f77787","rule:Create HostPid Pod:e78d3d5d025c487cd9d015e2188fbfec","rule:Create HostIPC Pod:8e8a237fa9fa5aa60170b0f32a0eb6c0","rule:Create NodePort Service:783d7200e4293a462c47478e3efe1467","rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95","rule:Anonymous Request Allowed:b54c135ef6884ef1c33c68b4603ca7b9","rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","rule:Create Disallowed Namespace:193dccbac92b3df8bc6c2c170eca7009","rule:Pod Created in Kube Namespace:651ea6360cb043d8640b29bb2da99ce1","rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:ClusterRole With Wildcard Created:072b1662de9d85736bfb01e667b95298","rule:ClusterRole With Write Privileges Created:d9b4ee032aa7d58587e3a94a2bd9b07b","rule:ClusterRole With Pod Exec Created:850e0987ba6e01744124250f0436044e","macro:kactivity:c039787987aab24bf4c158446153265c","macro:kall:49eca81243ca4a3913e6eeb4ced49ab4","rule:Full K8s Administrative Access:fdc73e7ea6f6062e87e06bc3a197bbba","rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57"],"type":"macro","hash":"3d34a33c12c8213012019ec4fa8cc532"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L51,L52","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kevt_started","macro":"kevt_started","condition":"(jevt.value[/stage]=ResponseStarted)","tags":null,"enabled":"true","used_by":["rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d"],"type":"macro","hash":"7c5a087e527e36ae6c9f13252c5354ee"},{"file_name":"k8s_audit_rules.yaml","comment":"# If you wish to restrict activity to a specific set of users, override/append to this list.\n# users created by kops are included","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L56,L57","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"vertical_pod_autoscaler_users","list":"vertical_pod_autoscaler_users","items":["vpa-recommender","vpa-updater"],"tags":null,"enabled":"true","type":"list","hash":"bc6988e81c74898f313cc4d1ba714001"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L59,L60","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_k8s_users","list":"allowed_k8s_users","items":["minikube","minikube-user","kubelet","kops","admin","kube","kube-proxy","kube-apiserver-healthcheck","kubernetes-admin","vertical_pod_autoscaler_users","cluster-autoscaler","system:addon-manager","cloud-controller-manager","system:kube-controller-manager"],"tags":null,"enabled":"true","used_by":["rule:Disallowed K8s User:3c7c39a2467726e0ac1db091b3fa729a"],"type":"list","hash":"cb2d81ac2dc103df2c60202646a557fb"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L70,L71","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"eks_allowed_k8s_users","list":"eks_allowed_k8s_users","items":["eks:node-manager","eks:certificate-controller","eks:fargate-scheduler","eks:k8s-metrics","eks:authenticator","eks:cluster-event-watcher","eks:nodewatcher","eks:pod-identity-mutating-webhook","eks:cloud-controller-manager","eks:vpc-resource-controller","eks:addon-manager"],"tags":null,"enabled":"true","used_by":["rule:Disallowed K8s User:3c7c39a2467726e0ac1db091b3fa729a"],"type":"list","hash":"619f5be94a5abf86fda0ac527b8cfb01"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L85,L86","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_sensitive_mount_images","list":"k8s_audit_sensitive_mount_images","items":["falcosecurity/falco","docker.io/falcosecurity/falco","public.ecr.aws/falcosecurity/falco","docker.io/sysdig/sysdig","sysdig/sysdig","gcr.io/google_containers/hyperkube","gcr.io/google_containers/kube-proxy","docker.io/calico/node","docker.io/rook/toolbox","docker.io/cloudnativelabs/kube-router","docker.io/consul","docker.io/datadog/docker-dd-agent","docker.io/datadog/agent","docker.io/docker/ucp-agent","docker.io/gliderlabs/logspout","docker.io/netdata/netdata","docker.io/google/cadvisor","docker.io/prom/node-exporter","amazon/amazon-ecs-agent","prom/node-exporter","amazon/cloudwatch-agent"],"tags":null,"enabled":"true","used_by":["rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e"],"type":"list","hash":"0e51d057a04979db2aefb1181523465e"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L97,L98","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_privileged_images","list":"k8s_audit_privileged_images","items":["falcosecurity/falco","docker.io/falcosecurity/falco","public.ecr.aws/falcosecurity/falco","docker.io/calico/node","calico/node","docker.io/cloudnativelabs/kube-router","docker.io/docker/ucp-agent","docker.io/mesosphere/mesos-slave","docker.io/rook/toolbox","docker.io/sysdig/sysdig","gcr.io/google_containers/kube-proxy","gcr.io/google-containers/startup-script","gcr.io/projectcalico-org/node","gke.gcr.io/kube-proxy","gke.gcr.io/gke-metadata-server","gke.gcr.io/netd-amd64","gke.gcr.io/watcher-daemonset","gcr.io/google-containers/prometheus-to-sd","registry.k8s.io/ip-masq-agent-amd64","registry.k8s.io/kube-proxy","registry.k8s.io/prometheus-to-sd","quay.io/calico/node","sysdig/sysdig","registry.k8s.io/dns/k8s-dns-node-cache","mcr.microsoft.com/oss/kubernetes/kube-proxy"],"tags":null,"enabled":"true","used_by":["rule:Create Privileged Pod:70ca8c72d4fffc0c2f21c8aa705141fd"],"type":"list","hash":"d09194c2abb1ce963de94e7db5c0068d"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L123,L129","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Disallowed K8s User","rule":"Disallowed K8s User","condition":"kevt and non_system_user and not ka.user.name in (allowed_k8s_users) and not ka.user.name in (eks_allowed_k8s_users)","desc":"Detect any k8s operation by users outside of an allowed set of users.","output":"K8s Operation performed by user not in allowed list of users (user=%ka.user.name target=%ka.target.name/%ka.target.resource verb=%ka.verb uri=%ka.uri resp=%ka.response.code)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:non_system_user:ea1dd8f878301676703a9f8cae5270c7","macro:kevt:3d34a33c12c8213012019ec4fa8cc532","list:allowed_k8s_users:cb2d81ac2dc103df2c60202646a557fb","list:eks_allowed_k8s_users:619f5be94a5abf86fda0ac527b8cfb01"],"type":"rule","hash":"3c7c39a2467726e0ac1db091b3fa729a"},{"file_name":"k8s_audit_rules.yaml","comment":"# In a local/user rules file, you could override this macro to\n# explicitly enumerate the container images that you want to run in\n# your environment. In this main falco rules file, there isn't any way\n# to know all the containers that can run, so any container is\n# allowed, by using the always_true macro. In the overridden macro, the condition\n# would look something like (ka.req.pod.containers.image.repository in (my-repo/my-image))","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L137,L138","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_k8s_containers","macro":"allowed_k8s_containers","condition":"(k8s_audit_always_true)","tags":null,"enabled":"true","dependencies":["macro:k8s_audit_always_true:21ef6651784861fced1315889d54de4f"],"used_by":["rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e"],"type":"macro","hash":"5d511025a0b51bc9c69d1f382f0d7b55"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L140,L141","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"response_successful","macro":"response_successful","condition":"(ka.response.code startswith 2)","tags":null,"enabled":"true","used_by":["rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91","rule:K8s Deployment Created:baa16ce306ed06c0c7b8da5cbf5887de","rule:K8s Deployment Deleted:d421240865854432544241d569a04af5","rule:K8s Service Created:ae0e582f7f7279f82e5fb8d9a43c3f17","rule:K8s Service Deleted:a00592c93ed63f631e0376c58e82ab9a","rule:K8s ConfigMap Created:497ce34a8a3ca7b1db976f491905bb5f","rule:K8s ConfigMap Deleted:250b126545e2f71142c4fa7044a47c85","rule:K8s Namespace Created:fd2791e0d74bc33826b59a6938c5acd3","rule:K8s Namespace Deleted:32d046d86731ba73014ef4a3e6982de3","rule:K8s Serviceaccount Created:94c6f61206c9d18c1414b83951f00810","rule:K8s Serviceaccount Deleted:f0c361075797201bf27630d538b63608","rule:K8s Role Created:8fe44d54a12b78f592606bb1865e5af1","rule:K8s Role Deleted:847dfbe8fd658637189bd8fb68ba967e","rule:K8s ClusterRole Created:b781c3e1e9a3f6cb964345b3a5e3282b","rule:K8s ClusterRole Deleted:d0dd095741c61758102fd963b21ebd6c","rule:K8s RoleBinding Created:49c2da3b769be38e2ca9d68ed7e8ff43","rule:K8s RoleBinding Deleted:34ed95040bff72fc375124045bd03b27","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d","rule:K8s Secret Created:0cfe5113b020e988115c63966a0096e3","rule:K8s Secret Deleted:5d9fab46ecddd2256510223c81935a65","rule:K8s Secret Get Successfully:cba1130d33330a09ee9ab90e949de28d","rule:K8s Secret Get Unsuccessfully Tried:a251a766f4420908cae668f0a0c08a08","rule:Ingress Object without TLS Certificate Created:f31d97edc305ecc002c782965508c07c","rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57"],"type":"macro","hash":"bc99c7e7262b779ed500f70e56121743"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L143,L144","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kget","macro":"kget","condition":"ka.verb=get","tags":null,"enabled":"true","used_by":["rule:K8s Secret Get Successfully:cba1130d33330a09ee9ab90e949de28d","rule:K8s Secret Get Unsuccessfully Tried:a251a766f4420908cae668f0a0c08a08"],"type":"macro","hash":"1551c63ba750fc9be9eebe12e7007d58"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L146,L147","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kcreate","macro":"kcreate","condition":"ka.verb=create","tags":null,"enabled":"true","used_by":["rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","rule:Create Privileged Pod:70ca8c72d4fffc0c2f21c8aa705141fd","rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e","rule:Create HostNetwork Pod:f1bc06aae08495b5910b365c31f77787","rule:Create HostPid Pod:e78d3d5d025c487cd9d015e2188fbfec","rule:Create HostIPC Pod:8e8a237fa9fa5aa60170b0f32a0eb6c0","rule:Create NodePort Service:783d7200e4293a462c47478e3efe1467","rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d","rule:Create Disallowed Namespace:193dccbac92b3df8bc6c2c170eca7009","rule:Pod Created in Kube Namespace:651ea6360cb043d8640b29bb2da99ce1","rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91","rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:ClusterRole With Wildcard Created:072b1662de9d85736bfb01e667b95298","rule:ClusterRole With Write Privileges Created:d9b4ee032aa7d58587e3a94a2bd9b07b","rule:ClusterRole With Pod Exec Created:850e0987ba6e01744124250f0436044e","rule:K8s Deployment Created:baa16ce306ed06c0c7b8da5cbf5887de","rule:K8s Service Created:ae0e582f7f7279f82e5fb8d9a43c3f17","rule:K8s ConfigMap Created:497ce34a8a3ca7b1db976f491905bb5f","rule:K8s Namespace Created:fd2791e0d74bc33826b59a6938c5acd3","rule:K8s Serviceaccount Created:94c6f61206c9d18c1414b83951f00810","rule:K8s Role Created:8fe44d54a12b78f592606bb1865e5af1","rule:K8s ClusterRole Created:b781c3e1e9a3f6cb964345b3a5e3282b","rule:K8s RoleBinding Created:49c2da3b769be38e2ca9d68ed7e8ff43","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s Secret Created:0cfe5113b020e988115c63966a0096e3","rule:Ingress Object without TLS Certificate Created:f31d97edc305ecc002c782965508c07c","rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57"],"type":"macro","hash":"37c7fc423d74cded348b39b4d2784eb4"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L149,L150","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kmodify","macro":"kmodify","condition":"(ka.verb in (create,update,patch))","tags":null,"enabled":"true","used_by":["rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe"],"type":"macro","hash":"1c3d2097993b597385dba443719c175f"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L152,L153","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kdelete","macro":"kdelete","condition":"ka.verb=delete","tags":null,"enabled":"true","used_by":["rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","rule:K8s Deployment Deleted:d421240865854432544241d569a04af5","rule:K8s Service Deleted:a00592c93ed63f631e0376c58e82ab9a","rule:K8s ConfigMap Deleted:250b126545e2f71142c4fa7044a47c85","rule:K8s Namespace Deleted:32d046d86731ba73014ef4a3e6982de3","rule:K8s Serviceaccount Deleted:f0c361075797201bf27630d538b63608","rule:K8s Role Deleted:847dfbe8fd658637189bd8fb68ba967e","rule:K8s ClusterRole Deleted:d0dd095741c61758102fd963b21ebd6c","rule:K8s RoleBinding Deleted:34ed95040bff72fc375124045bd03b27","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d","rule:K8s Secret Deleted:5d9fab46ecddd2256510223c81935a65"],"type":"macro","hash":"c0bbea75a56d965e6085f0f12ec2d5d9"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L155,L156","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"pod","macro":"pod","condition":"ka.target.resource=pods and not ka.target.subresource exists","tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:pod_subresource:ec74525d8de5f6ef77f0091dbe11f020","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","rule:Create Privileged Pod:70ca8c72d4fffc0c2f21c8aa705141fd","rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e","rule:Create HostNetwork Pod:f1bc06aae08495b5910b365c31f77787","rule:Create HostPid Pod:e78d3d5d025c487cd9d015e2188fbfec","rule:Create HostIPC Pod:8e8a237fa9fa5aa60170b0f32a0eb6c0","rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","rule:Pod Created in Kube Namespace:651ea6360cb043d8640b29bb2da99ce1","rule:ClusterRole With Pod Exec Created:850e0987ba6e01744124250f0436044e","macro:openshift_image:a963c49d809c7db284d12a2020ad26b8","macro:checkpoint_writing_state:030543659efa642294c18d47aa7fcc40"],"type":"macro","hash":"dcc0caa97588ee058c2fcd764e5f919b"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L158,L159","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"pod_subresource","macro":"pod_subresource","condition":"ka.target.resource=pods and ka.target.subresource exists","tags":null,"enabled":"true","dependencies":["macro:pod:dcc0caa97588ee058c2fcd764e5f919b"],"used_by":["rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271"],"type":"macro","hash":"ec74525d8de5f6ef77f0091dbe11f020"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L161,L162","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"deployment","macro":"deployment","condition":"ka.target.resource=deployments","tags":null,"enabled":"true","used_by":["rule:K8s Deployment Created:baa16ce306ed06c0c7b8da5cbf5887de","rule:K8s Deployment Deleted:d421240865854432544241d569a04af5","macro:openshift_image:a963c49d809c7db284d12a2020ad26b8"],"type":"macro","hash":"06e5c0d0f9eabd9525e5f9dc4f6f37cf"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L164,L165","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"service","macro":"service","condition":"ka.target.resource=services","tags":null,"enabled":"true","used_by":["rule:GCP Cloud SQL database user modified or deleted:1701d3c81ed3c11f97678576e02fd909","rule:GCP Cloud SQL database backup deleted:3bb479179a87f0a8487e0a35e7d918af","rule:GCP Cloud SQL database instance data exported:30c7ac7e5023b027ba17f60a4de546cc","rule:GCP Cloud SQL database instance deleted:2fcad4755277a549ba0ea21ee2ca0db4","rule:GCP Cloud SQL database instance modified or created:aa0fe9ea33e3d68a04b9f51fe1d56723","rule:GCP Bucket configured to be public:c72cc419c4f24905a54d688c1535b6a0","rule:GCP Bucket objects configured to be public:d48246f3978ec6722cd9eae9044325c3","rule:GCP Bucket enumerated:10eb3a11e84dfb8b7c0e6b3335539adb","rule:GCP Bucket deleted:6063c9c76c6327605e84db7dde570d5e","rule:GCP Bucket updated:f5e47bc60e7e0d03c7f87e3816530b97","rule:GCP Bucket permissions modified:33a7142c9343b70e39d2bcee044e9f99","rule:GCP BigQuery Dataset access configured to be public:1b04e6c7e89d30feeff5f4716c7ceb25","rule:GCP VM modified:20154d58930280f1f688a52a40780646","rule:GCP VM stopped:047b58b78894bf17792667d9507b6f84","rule:GCP GCE Firewall rule modified:fa5f1a0d363622db805b1da4bfbe33ae","rule:GCP WAF Network policy modified:ea9d6ae148573635aa52476eb059d08d","rule:GCP WAF rule modified or deleted:8306e720ad3a1f2cf34fad7d791fc6f5","rule:GCP CloudArmor edge security service modified:c2e9e0c777c9fd685986808198e34262","rule:GCP backend service deleted:366b06dc86b4f3012b435a9b8e09ad35","rule:GCP IAM service account created:b175add7a555476a32a006cec84a317e","rule:GCP IAM service account deleted:316af8b9eefa48cdb26c11daba8181b2","rule:GCP IAM service account modified:40a25797d027ba4839fa611dcb08435f","rule:GCP IAM service account key created:6cb3039deb4e30ef2e53da015e35a7e5","rule:GCP IAM service account key deleted:e0d1f230648dd0b6e7ceaf5e23910535","rule:GCP IAM custom role created:1f80950fdb537372d5a9530fa55336ae","rule:GCP IAM custom role modified:1d2c5dad99a9d9f5ab74539890cd643e","rule:GCP IAM policy modified:99e189954467681d2eba010890433284","rule:GCP cloud function created:96a91d7666a6ecd40e353dcf312715bd","rule:GCP cloud function deleted:3162ec8d5c7f57f79c301afba624ea91","rule:GCP cloud function modified:ffd04bce3e16a90ba30536cd72685d5d","rule:GCP KMS keyring created:5539678ad4d049348788218c065288dd","rule:GCP KMS created:77b2af37cddb31da4faa84b21de8a147","rule:GCP KMS updated:b98f92a6a672b613b5d6f183553adc85","rule:GCP KMS deleted:79bd2b031018a37614ae719b006e5f52","rule:GCP Pub/Sub topic deleted:91149d848ccf5d745884df70df35cfa6","rule:GCP Pub/Sub subscription modified:32cb0dd144a9cefdefc1f9ff82ce7dc6","rule:GCP Pub/Sub subscription deleted:04bbcf62a909e8d6b85ed6bf9a4ec7da","rule:GCP logging sink modified:ff8a3f8ceccc8b65ad17c432896a9b62","rule:GCP logging sink deleted:91013b69eed7b5f45f8189f35772a8f0","macro:serviceaccount:618c2280ccb9083ae6152f4eaec58a86","rule:Create NodePort Service:783d7200e4293a462c47478e3efe1467","rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91","rule:K8s Service Created:ae0e582f7f7279f82e5fb8d9a43c3f17","rule:K8s Service Deleted:a00592c93ed63f631e0376c58e82ab9a","rule:K8s Serviceaccount Created:94c6f61206c9d18c1414b83951f00810","rule:K8s Serviceaccount Deleted:f0c361075797201bf27630d538b63608","macro:plesk_install_writing_apache_conf:b1645f2efd8de69398708897f91f9684","macro:rancher_writing_conf:8b1f4bfa74e091fb880570e839ff8d41","macro:rancher_writing_root:687f66c964ff5e546b31a18570c553a2","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"aaabf0d39951f3e6c3e8a7911df524c2"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L167,L168","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"configmap","macro":"configmap","condition":"ka.target.resource=configmaps","tags":null,"enabled":"true","used_by":["rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95","rule:K8s ConfigMap Created:497ce34a8a3ca7b1db976f491905bb5f","rule:K8s ConfigMap Deleted:250b126545e2f71142c4fa7044a47c85"],"type":"macro","hash":"0eda34eee3148f7899d7ef2d7f1b0238"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L170,L171","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"namespace","macro":"namespace","condition":"ka.target.resource=namespaces","tags":null,"enabled":"true","used_by":["rule:Create Disallowed Namespace:193dccbac92b3df8bc6c2c170eca7009","macro:allowed_kube_namespace_pods:4014ef1df33e20f9743117da689d7033","rule:Pod Created in Kube Namespace:651ea6360cb043d8640b29bb2da99ce1","rule:K8s Namespace Created:fd2791e0d74bc33826b59a6938c5acd3","rule:K8s Namespace Deleted:32d046d86731ba73014ef4a3e6982de3","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0"],"type":"macro","hash":"89801e9e98979062e84647433a8ed3e9"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L173,L174","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"serviceaccount","macro":"serviceaccount","condition":"ka.target.resource=serviceaccounts","tags":null,"enabled":"true","dependencies":["macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"used_by":["rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91","rule:K8s Serviceaccount Created:94c6f61206c9d18c1414b83951f00810","rule:K8s Serviceaccount Deleted:f0c361075797201bf27630d538b63608","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"618c2280ccb9083ae6152f4eaec58a86"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L176,L177","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"clusterrole","macro":"clusterrole","condition":"ka.target.resource=clusterroles","tags":null,"enabled":"true","dependencies":["macro:role:29a7e96467b69a9f5a93332e29e9b0de"],"used_by":["macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:ClusterRole With Wildcard Created:072b1662de9d85736bfb01e667b95298","rule:ClusterRole With Write Privileges Created:d9b4ee032aa7d58587e3a94a2bd9b07b","rule:ClusterRole With Pod Exec Created:850e0987ba6e01744124250f0436044e","rule:K8s ClusterRole Created:b781c3e1e9a3f6cb964345b3a5e3282b","rule:K8s ClusterRole Deleted:d0dd095741c61758102fd963b21ebd6c","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d"],"type":"macro","hash":"e094bcef29e4ca88c66ca030934e97a8"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L179,L180","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"clusterrolebinding","macro":"clusterrolebinding","condition":"ka.target.resource=clusterrolebindings","tags":null,"enabled":"true","dependencies":["macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181"],"used_by":["rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d"],"type":"macro","hash":"7c84785a0576aca333974b46f1be8056"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L182,L183","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"role","macro":"role","condition":"ka.target.resource=roles","tags":null,"enabled":"true","used_by":["macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:ClusterRole With Wildcard Created:072b1662de9d85736bfb01e667b95298","rule:ClusterRole With Write Privileges Created:d9b4ee032aa7d58587e3a94a2bd9b07b","rule:ClusterRole With Pod Exec Created:850e0987ba6e01744124250f0436044e","rule:K8s Role Created:8fe44d54a12b78f592606bb1865e5af1","rule:K8s Role Deleted:847dfbe8fd658637189bd8fb68ba967e","rule:K8s ClusterRole Created:b781c3e1e9a3f6cb964345b3a5e3282b","rule:K8s ClusterRole Deleted:d0dd095741c61758102fd963b21ebd6c","rule:K8s RoleBinding Created:49c2da3b769be38e2ca9d68ed7e8ff43","rule:K8s RoleBinding Deleted:34ed95040bff72fc375124045bd03b27","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d"],"type":"macro","hash":"29a7e96467b69a9f5a93332e29e9b0de"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L185,L186","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"rolebinding","macro":"rolebinding","condition":"ka.target.resource=rolebindings","tags":null,"enabled":"true","dependencies":["macro:role:29a7e96467b69a9f5a93332e29e9b0de"],"used_by":["macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","rule:Attach to cluster-admin Role:ebe83079283dd56ef5073890d897fbb3","rule:K8s RoleBinding Created:49c2da3b769be38e2ca9d68ed7e8ff43","rule:K8s RoleBinding Deleted:34ed95040bff72fc375124045bd03b27","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d"],"type":"macro","hash":"816912b6f24b4b0a491cb852ce31d181"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L188,L189","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"secret","macro":"secret","condition":"ka.target.resource=secrets","tags":null,"enabled":"true","used_by":["macro:private_aws_credentials:9fcead5c6eef1bdbf3f1a4981a100df6","rule:K8s Secret Created:0cfe5113b020e988115c63966a0096e3","rule:K8s Secret Deleted:5d9fab46ecddd2256510223c81935a65","rule:K8s Secret Get Successfully:cba1130d33330a09ee9ab90e949de28d","rule:K8s Secret Get Unsuccessfully Tried:a251a766f4420908cae668f0a0c08a08","macro:known_aks_mount_in_privileged_containers:ca8e26ea9fbaeef65837c5ada20a66e8","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"5ebe2294ecd0e0f08eab7690d2a6ee69"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L191,L192","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"health_endpoint","macro":"health_endpoint","condition":"ka.uri=/healthz or ka.uri startswith /healthz?","tags":null,"enabled":"true","used_by":["rule:Anonymous Request Allowed:b54c135ef6884ef1c33c68b4603ca7b9"],"type":"macro","hash":"be396e21558c50330d6d104f6910e7ab"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L194,L195","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"live_endpoint","macro":"live_endpoint","condition":"ka.uri=/livez or ka.uri startswith /livez?","tags":null,"enabled":"true","used_by":["rule:Anonymous Request Allowed:b54c135ef6884ef1c33c68b4603ca7b9"],"type":"macro","hash":"3bc0977f9ebddaef348d08211fcb4ebd"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L197,L198","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ready_endpoint","macro":"ready_endpoint","condition":"ka.uri=/readyz or ka.uri startswith /readyz?","tags":null,"enabled":"true","used_by":["rule:Anonymous Request Allowed:b54c135ef6884ef1c33c68b4603ca7b9"],"type":"macro","hash":"d1faf0c342855031e203911ebacec1b9"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L200,L207","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create Disallowed Pod","rule":"Create Disallowed Pod","condition":"kevt and pod and kcreate and not allowed_k8s_containers","desc":"Detect an attempt to start a pod with a container image outside of a list of allowed images.\n","output":"Pod started with container not in allowed list (user=%ka.user.name pod=%ka.resp.name ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:allowed_k8s_containers:5d511025a0b51bc9c69d1f382f0d7b55","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"8d71d5de24654fe16db931fbda68825e"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L209,L216","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create Privileged Pod","rule":"Create Privileged Pod","condition":"kevt and pod and kcreate and ka.req.pod.containers.privileged intersects (true) and not ka.req.pod.containers.image.repository in (k8s_audit_privileged_images)","desc":"Detect an attempt to start a pod with a privileged container\n","output":"Pod started with privileged container (user=%ka.user.name pod=%ka.resp.name resource=%ka.target.resource ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","list:k8s_audit_privileged_images:d09194c2abb1ce963de94e7db5c0068d","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b"],"type":"rule","hash":"70ca8c72d4fffc0c2f21c8aa705141fd"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L218,L219","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"sensitive_vol_mount","macro":"sensitive_vol_mount","condition":"(ka.req.pod.volumes.hostpath intersects (/proc, /var/run/docker.sock, /, /etc, /root, /var/run/crio/crio.sock, /run/containerd/containerd.sock, /home/admin, /var/lib/kubelet, /var/lib/kubelet/pki, /etc/kubernetes, /etc/kubernetes/manifests))\n","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e"],"type":"macro","hash":"621cd5c512333ac20ba436785be6b179"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L222,L230","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create Sensitive Mount Pod","rule":"Create Sensitive Mount Pod","condition":"kevt and pod and kcreate and sensitive_vol_mount and not ka.req.pod.containers.image.repository in (k8s_audit_sensitive_mount_images)","desc":"Detect an attempt to start a pod with a volume from a sensitive host directory (i.e. /proc). Exceptions are made for known trusted images.\n","output":"Pod started with sensitive mount (user=%ka.user.name pod=%ka.resp.name ns=%ka.target.namespace resource=%ka.target.resource images=%ka.req.pod.containers.image volumes=%jevt.value[/requestObject/spec/volumes])","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","list:k8s_audit_sensitive_mount_images:0e51d057a04979db2aefb1181523465e","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:sensitive_vol_mount:621cd5c512333ac20ba436785be6b179","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40"],"type":"rule","hash":"754dc8b656feadac3eca6a1d5923ae2e"},{"file_name":"k8s_audit_rules.yaml","comment":"# These container images are allowed to run with hostnetwork=true\n# TODO: Remove k8s.gcr.io reference after 01/Dec/2023","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L234,L235","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_hostnetwork_images","list":"k8s_audit_hostnetwork_images","items":["gcr.io/google-containers/prometheus-to-sd","gcr.io/projectcalico-org/typha","gcr.io/projectcalico-org/node","gke.gcr.io/gke-metadata-server","gke.gcr.io/kube-proxy","gke.gcr.io/netd-amd64","registry.k8s.io/ip-masq-agent-amd64","registry.k8s.io/prometheus-to-sd"],"tags":null,"enabled":"true","used_by":["rule:Create HostNetwork Pod:f1bc06aae08495b5910b365c31f77787"],"type":"list","hash":"cbdc6053ca8c336518f2ae37f583b988"},{"file_name":"k8s_audit_rules.yaml","comment":"# Corresponds to K8s CIS Benchmark 1.7.4","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L247,L253","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create HostNetwork Pod","rule":"Create HostNetwork Pod","condition":"kevt and pod and kcreate and ka.req.pod.host_network intersects (true) and not ka.req.pod.containers.image.repository in (k8s_audit_hostnetwork_images)","desc":"Detect an attempt to start a pod using the host network.","output":"Pod started using host network (user=%ka.user.name pod=%ka.resp.name resource=%ka.target.resource ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","list:k8s_audit_hostnetwork_images:cbdc6053ca8c336518f2ae37f583b988"],"type":"rule","hash":"f1bc06aae08495b5910b365c31f77787"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L255,L256","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_hostpid_images","list":"k8s_audit_hostpid_images","tags":null,"enabled":"true","used_by":["rule:Create HostPid Pod:e78d3d5d025c487cd9d015e2188fbfec"],"type":"list","hash":"896c098ed805daec80d8a43ddabb7649"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L258,L264","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create HostPid Pod","rule":"Create HostPid Pod","condition":"kevt and pod and kcreate and ka.req.pod.host_pid intersects (true) and not ka.req.pod.containers.image.repository in (k8s_audit_hostpid_images)","desc":"Detect an attempt to start a pod using the host pid namespace.","output":"Pod started using host pid namespace (user=%ka.user.name pod=%ka.resp.name resource=%ka.target.resource ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","list:k8s_audit_hostpid_images:896c098ed805daec80d8a43ddabb7649"],"type":"rule","hash":"e78d3d5d025c487cd9d015e2188fbfec"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L266,L267","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_audit_hostipc_images","list":"k8s_audit_hostipc_images","tags":null,"enabled":"true","used_by":["rule:Create HostIPC Pod:8e8a237fa9fa5aa60170b0f32a0eb6c0"],"type":"list","hash":"ca80024e4507e56266a8e5782965f8f6"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L269,L275","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create HostIPC Pod","rule":"Create HostIPC Pod","condition":"kevt and pod and kcreate and ka.req.pod.host_ipc intersects (true) and not ka.req.pod.containers.image.repository in (k8s_audit_hostipc_images)","desc":"Detect an attempt to start a pod using the host ipc namespace.","output":"Pod started using host ipc namespace (user=%ka.user.name pod=%ka.resp.name resource=%ka.target.resource ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","list:k8s_audit_hostipc_images:ca80024e4507e56266a8e5782965f8f6"],"type":"rule","hash":"8e8a237fa9fa5aa60170b0f32a0eb6c0"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L277,L278","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_known_node_port_service","macro":"user_known_node_port_service","condition":"(k8s_audit_never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:k8s_audit_never_true:9a704dd4f5279b6d5619cb257258825a","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Create NodePort Service:783d7200e4293a462c47478e3efe1467"],"type":"macro","hash":"eef8c8cb2dddbde98acc0032c8437a1e"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L280,L287","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create NodePort Service","rule":"Create NodePort Service","condition":"kevt and service and kcreate and ka.req.service.type=NodePort and not user_known_node_port_service","desc":"Detect an attempt to start a service with a NodePort service type\n","output":"NodePort Service Created (user=%ka.user.name service=%ka.target.name resource=%ka.target.resource ns=%ka.target.namespace ports=%ka.req.service.ports)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:user_known_node_port_service:eef8c8cb2dddbde98acc0032c8437a1e","macro:node:36c4536996ca5615dcf9911f068786dc"],"type":"rule","hash":"783d7200e4293a462c47478e3efe1467"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L289,L290","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"contains_private_credentials","macro":"contains_private_credentials","condition":"(ka.req.configmap.obj contains \"aws_access_key_id\" or\n ka.req.configmap.obj contains \"aws-access-key-id\" or\n ka.req.configmap.obj contains \"aws_s3_access_key_id\" or\n ka.req.configmap.obj contains \"aws-s3-access-key-id\" or\n ka.req.configmap.obj contains \"password\" or\n ka.req.configmap.obj contains \"passphrase\")\n","tags":null,"enabled":"true","used_by":["rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95"],"type":"macro","hash":"ca44975e6e454da5b380ea34b5635e17"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L298,L305","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create/Modify Configmap With Private Credentials","rule":"Create/Modify Configmap With Private Credentials","condition":"kevt and configmap and kmodify and contains_private_credentials","desc":"Detect creating/modifying a configmap containing a private credential (aws key, password, etc.)\n","output":"K8s configmap with private credential (user=%ka.user.name verb=%ka.verb resource=%ka.target.resource configmap=%ka.req.configmap.name config=%ka.req.configmap.obj)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kmodify:1c3d2097993b597385dba443719c175f","macro:configmap:0eda34eee3148f7899d7ef2d7f1b0238","macro:contains_private_credentials:ca44975e6e454da5b380ea34b5635e17","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a"],"type":"rule","hash":"ebb29c636783c42f1280e27e47cf3e95"},{"file_name":"k8s_audit_rules.yaml","comment":"# Corresponds to K8s CIS Benchmark, 1.1.1.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L308,L315","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Anonymous Request Allowed","rule":"Anonymous Request Allowed","condition":"kevt and ka.user.name=system:anonymous and ka.auth.decision=\"allow\" and not health_endpoint and not live_endpoint and not ready_endpoint","desc":"Detect any request made by the anonymous user that was allowed\n","output":"Request by anonymous user allowed (user=%ka.user.name verb=%ka.verb uri=%ka.uri reason=%ka.auth.reason))","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:health_endpoint:be396e21558c50330d6d104f6910e7ab","macro:live_endpoint:3bc0977f9ebddaef348d08211fcb4ebd","macro:ready_endpoint:d1faf0c342855031e203911ebacec1b9"],"type":"rule","hash":"b54c135ef6884ef1c33c68b4603ca7b9"},{"file_name":"k8s_audit_rules.yaml","comment":"# Ideally, we'd add a more stringent rule that detects attaches/execs\n# to a privileged pod, but that requires the engine for k8s audit\n# events to be stateful, so it could know if a container named in an\n# attach request was created privileged or not. For now, we have a\n# less severe rule that detects attaches/execs to any pod.\n#\n# For the same reason, you can't use things like image names/prefixes,\n# as the event that creates the pod (which has the images) is a\n# separate event than the actual exec/attach to the pod.\n","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L330,L331","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_known_exec_pod_activities","macro":"user_known_exec_pod_activities","condition":"(k8s_audit_never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:k8s_audit_never_true:9a704dd4f5279b6d5619cb257258825a","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Attach/Exec Pod:9f96af4ff812f6921ca7ef17e047bc7d"],"type":"macro","hash":"654a93971e99c9f7b3bb5a8614b96d7f"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L333,L340","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Attach/Exec Pod","rule":"Attach/Exec Pod","condition":"kevt_started and pod_subresource and kcreate and ka.target.subresource in (exec,attach) and not user_known_exec_pod_activities","desc":"Detect any attempt to attach/exec to a pod\n","output":"Attach/Exec to pod (user=%ka.user.name pod=%ka.target.name resource=%ka.target.resource ns=%ka.target.namespace action=%ka.target.subresource command=%ka.uri.param[command])","priority":"NOTICE","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kevt_started:7c5a087e527e36ae6c9f13252c5354ee","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:pod_subresource:ec74525d8de5f6ef77f0091dbe11f020","macro:user_known_exec_pod_activities:654a93971e99c9f7b3bb5a8614b96d7f"],"type":"rule","hash":"9f96af4ff812f6921ca7ef17e047bc7d"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L342,L343","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_known_portforward_activities","macro":"user_known_portforward_activities","condition":"(k8s_audit_never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:k8s_audit_never_true:9a704dd4f5279b6d5619cb257258825a","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:port-forward:18569f496513a6947677d4299af4a715"],"type":"macro","hash":"c1bda959367c501d28cf34ac7b327cd5"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L345,L352","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"port-forward","rule":"port-forward","condition":"ka.target.subresource in (portforward) and not user_known_portforward_activities","desc":"Detect any attempt to portforward\n","output":"Portforward to pod (user=%ka.user.name pod=%ka.target.name ns=%ka.target.namespace action=%ka.target.subresource )","priority":"NOTICE","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:user_known_portforward_activities:c1bda959367c501d28cf34ac7b327cd5"],"type":"rule","hash":"18569f496513a6947677d4299af4a715"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L354,L355","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_known_pod_debug_activities","macro":"user_known_pod_debug_activities","condition":"(k8s_audit_never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:k8s_audit_never_true:9a704dd4f5279b6d5619cb257258825a","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271"],"type":"macro","hash":"f680ce82ade487e7d4c6d0bcf300391a"},{"file_name":"k8s_audit_rules.yaml","comment":"# Only works when feature gate EphemeralContainers is enabled","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L358,L365","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"EphemeralContainers Created","rule":"EphemeralContainers Created","condition":"kevt and pod_subresource and kmodify and ka.target.subresource in (ephemeralcontainers) and not user_known_pod_debug_activities","desc":"Detect any ephemeral container created\n","output":"Ephemeral container is created in pod (user=%ka.user.name pod=%ka.target.name resource=%ka.target.resource ns=%ka.target.namespace ephemeral_container_name=%jevt.value[/requestObject/ephemeralContainers/0/name] ephemeral_container_image=%jevt.value[/requestObject/ephemeralContainers/0/image])","priority":"NOTICE","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kmodify:1c3d2097993b597385dba443719c175f","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:pod_subresource:ec74525d8de5f6ef77f0091dbe11f020","macro:user_known_pod_debug_activities:f680ce82ade487e7d4c6d0bcf300391a","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"17704f4c40a6f889fa7fc1b666857271"},{"file_name":"k8s_audit_rules.yaml","comment":"# In a local/user rules fie, you can append to this list to add additional allowed namespaces","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L368,L369","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_namespaces","list":"allowed_namespaces","items":["kube-system","kube-public","default"],"tags":null,"enabled":"true","used_by":["rule:Create Disallowed Namespace:193dccbac92b3df8bc6c2c170eca7009"],"type":"list","hash":"7884a197e13487d6d8c732b8a8f4db2e"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L371,L377","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Create Disallowed Namespace","rule":"Create Disallowed Namespace","condition":"kevt and namespace and kcreate and not ka.target.name in (allowed_namespaces)","desc":"Detect any attempt to create a namespace outside of a set of known namespaces","output":"Disallowed namespace created (user=%ka.user.name ns=%ka.target.name resource=%ka.target.resource)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:namespace:89801e9e98979062e84647433a8ed3e9","list:allowed_namespaces:7884a197e13487d6d8c732b8a8f4db2e"],"type":"rule","hash":"193dccbac92b3df8bc6c2c170eca7009"},{"file_name":"k8s_audit_rules.yaml","comment":"# Only defined for backwards compatibility. Use the more specific\n# user_allowed_kube_namespace_image_list instead.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L381,L382","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_trusted_image_list","list":"user_trusted_image_list","tags":null,"enabled":"true","type":"list","hash":"4e89accfde6b02b0502c995884d8b93a"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L384,L385","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_allowed_kube_namespace_image_list","list":"user_allowed_kube_namespace_image_list","items":["user_trusted_image_list"],"tags":null,"enabled":"true","used_by":["macro:allowed_kube_namespace_pods:4014ef1df33e20f9743117da689d7033"],"type":"list","hash":"2028cce60db33870f0a18a7ba8752d0c"},{"file_name":"k8s_audit_rules.yaml","comment":"# Only defined for backwards compatibility. Use the more specific\n# allowed_kube_namespace_image_list instead.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L389,L390","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"k8s_image_list","list":"k8s_image_list","tags":null,"enabled":"true","type":"list","hash":"fe129c90c5991e7814454b403f9e8680"},{"file_name":"k8s_audit_rules.yaml","comment":"# TODO: Remove k8s.gcr.io reference after 01/Dec/2023","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L393,L394","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_kube_namespace_image_list","list":"allowed_kube_namespace_image_list","items":["gcr.io/google-containers/prometheus-to-sd","gcr.io/projectcalico-org/node","gke.gcr.io/addon-resizer","gke.gcr.io/heapster","gke.gcr.io/gke-metadata-server","registry.k8s.io/ip-masq-agent-amd64","registry.k8s.io/kube-apiserver","gke.gcr.io/kube-proxy","gke.gcr.io/netd-amd64","gke.gcr.io/watcher-daemonset","registry.k8s.io/addon-resizer","registry.k8s.io/prometheus-to-sd","registry.k8s.io/k8s-dns-dnsmasq-nanny-amd64","registry.k8s.io/k8s-dns-kube-dns-amd64","registry.k8s.io/k8s-dns-sidecar-amd64","registry.k8s.io/metrics-server-amd64","kope/kube-apiserver-healthcheck","k8s_image_list"],"tags":null,"enabled":"true","used_by":["macro:allowed_kube_namespace_pods:4014ef1df33e20f9743117da689d7033"],"type":"list","hash":"fc5f9c19bfc7355b344f73fe45e1aaaa"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L415,L416","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_kube_namespace_pods","macro":"allowed_kube_namespace_pods","condition":"(ka.req.pod.containers.image.repository in (user_allowed_kube_namespace_image_list) or ka.req.pod.containers.image.repository in (allowed_kube_namespace_image_list))","tags":null,"enabled":"true","dependencies":["macro:namespace:89801e9e98979062e84647433a8ed3e9","list:user_allowed_kube_namespace_image_list:2028cce60db33870f0a18a7ba8752d0c","list:allowed_kube_namespace_image_list:fc5f9c19bfc7355b344f73fe45e1aaaa"],"used_by":["rule:Pod Created in Kube Namespace:651ea6360cb043d8640b29bb2da99ce1"],"type":"macro","hash":"4014ef1df33e20f9743117da689d7033"},{"file_name":"k8s_audit_rules.yaml","comment":"# Detect any new pod created in the kube-system namespace","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L420,L426","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Pod Created in Kube Namespace","rule":"Pod Created in Kube Namespace","condition":"kevt and pod and kcreate and ka.target.namespace in (kube-system, kube-public) and not allowed_kube_namespace_pods","desc":"Detect any attempt to create a pod in the kube-system or kube-public namespaces","output":"Pod created in kube namespace (user=%ka.user.name pod=%ka.resp.name resource=%ka.target.resource ns=%ka.target.namespace images=%ka.req.pod.containers.image)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:namespace:89801e9e98979062e84647433a8ed3e9","macro:allowed_kube_namespace_pods:4014ef1df33e20f9743117da689d7033"],"type":"rule","hash":"651ea6360cb043d8640b29bb2da99ce1"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L428,L429","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"user_known_sa_list","list":"user_known_sa_list","tags":null,"enabled":"true","used_by":["macro:trusted_sa:f85f5c048bba1d62044726ad24c2317a"],"type":"list","hash":"2780d5a55020009896ad826e5731f1ba"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L431,L432","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"known_sa_list","list":"known_sa_list","items":["coredns","coredns-autoscaler","cronjob-controller","daemon-set-controller","deployment-controller","disruption-controller","endpoint-controller","endpointslice-controller","endpointslicemirroring-controller","generic-garbage-collector","horizontal-pod-autoscaler","job-controller","namespace-controller","node-controller","persistent-volume-binder","pod-garbage-collector","pv-protection-controller","pvc-protection-controller","replicaset-controller","resourcequota-controller","root-ca-cert-publisher","service-account-controller","statefulset-controller"],"tags":null,"enabled":"true","used_by":["macro:trusted_sa:f85f5c048bba1d62044726ad24c2317a"],"type":"list","hash":"2609cede5b398c9ceae918e9fe90a560"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L458,L459","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"trusted_sa","macro":"trusted_sa","condition":"(ka.target.name in (known_sa_list, user_known_sa_list))","tags":null,"enabled":"true","dependencies":["list:user_known_sa_list:2780d5a55020009896ad826e5731f1ba","list:known_sa_list:2609cede5b398c9ceae918e9fe90a560"],"used_by":["rule:Service Account Created in Kube Namespace:b5a8cad895c664de9e626483fe9bbc91"],"type":"macro","hash":"f85f5c048bba1d62044726ad24c2317a"},{"file_name":"k8s_audit_rules.yaml","comment":"# Detect creating a service account in the kube-system/kube-public namespace","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L462,L468","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Service Account Created in Kube Namespace","rule":"Service Account Created in Kube Namespace","condition":"kevt and serviceaccount and kcreate and ka.target.namespace in (kube-system, kube-public) and response_successful and not trusted_sa","desc":"Detect any attempt to create a serviceaccount in the kube-system or kube-public namespaces","output":"Service account created in kube namespace (user=%ka.user.name serviceaccount=%ka.target.name resource=%ka.target.resource ns=%ka.target.namespace)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:serviceaccount:618c2280ccb9083ae6152f4eaec58a86","macro:trusted_sa:f85f5c048bba1d62044726ad24c2317a"],"type":"rule","hash":"b5a8cad895c664de9e626483fe9bbc91"},{"file_name":"k8s_audit_rules.yaml","comment":"# Detect any modify/delete to any ClusterRole starting with\n# \"system:\". \"system:coredns\" is excluded as changes are expected in\n# normal operation.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L473,L480","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"System ClusterRole Modified/Deleted","rule":"System ClusterRole Modified/Deleted","condition":"kevt and (role or clusterrole) and (kmodify or kdelete) and (ka.target.name startswith \"system:\") and not ka.target.name in (system:coredns, system:managed-certificate-controller)","desc":"Detect any attempt to modify/delete a ClusterRole/Role starting with system","output":"System ClusterRole/Role modified or deleted (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource ns=%ka.target.namespace action=%ka.verb)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kmodify:1c3d2097993b597385dba443719c175f","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a"],"type":"rule","hash":"a7ed236dedc9cd9ba73e7d75c0296cbe"},{"file_name":"k8s_audit_rules.yaml","comment":"# Detect any attempt to create a ClusterRoleBinding to the cluster-admin user\n# (expand this to any built-in cluster role that does \"sensitive\" things)","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L484,L490","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Attach to cluster-admin Role","rule":"Attach to cluster-admin Role","condition":"kevt and clusterrolebinding and kcreate and ka.req.binding.role=cluster-admin","desc":"Detect any attempt to create a ClusterRoleBinding to the cluster-admin user","output":"Cluster Role Binding to cluster-admin role (user=%ka.user.name subject=%ka.req.binding.subjects)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181"],"type":"rule","hash":"ebe83079283dd56ef5073890d897fbb3"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L492,L498","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ClusterRole With Wildcard Created","rule":"ClusterRole With Wildcard Created","condition":"kevt and (role or clusterrole) and kcreate and (ka.req.role.rules.resources intersects (\"*\") or ka.req.role.rules.verbs intersects (\"*\"))","desc":"Detect any attempt to create a Role/ClusterRole with wildcard resources or verbs","output":"Created Role/ClusterRole with wildcard (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource rules=%ka.req.role.rules)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de"],"type":"rule","hash":"072b1662de9d85736bfb01e667b95298"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L500,L501","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"writable_verbs","macro":"writable_verbs","condition":"(ka.req.role.rules.verbs intersects (create, update, patch, delete, deletecollection))\n","tags":null,"enabled":"true","used_by":["rule:ClusterRole With Write Privileges Created:d9b4ee032aa7d58587e3a94a2bd9b07b"],"type":"macro","hash":"21f7d1d7840cc63323d9a5c60e8d9cf2"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L504,L510","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ClusterRole With Write Privileges Created","rule":"ClusterRole With Write Privileges Created","condition":"kevt and (role or clusterrole) and kcreate and writable_verbs","desc":"Detect any attempt to create a Role/ClusterRole that can perform write-related actions","output":"Created Role/ClusterRole with write privileges (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource rules=%ka.req.role.rules)","priority":"NOTICE","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:writable_verbs:21f7d1d7840cc63323d9a5c60e8d9cf2"],"type":"rule","hash":"d9b4ee032aa7d58587e3a94a2bd9b07b"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L512,L518","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ClusterRole With Pod Exec Created","rule":"ClusterRole With Pod Exec Created","condition":"kevt and (role or clusterrole) and kcreate and ka.req.role.rules.resources intersects (\"pods/exec\")","desc":"Detect any attempt to create a Role/ClusterRole that can exec to pods","output":"Created Role/ClusterRole with pod exec privileges (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource rules=%ka.req.role.rules)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de"],"type":"rule","hash":"850e0987ba6e01744124250f0436044e"},{"file_name":"k8s_audit_rules.yaml","comment":"# The rules below this point are less discriminatory and generally\n# represent a stream of activity for a cluster. If you wish to disable\n# these events, modify the following macro.","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L523,L524","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"consider_activity_events","macro":"consider_activity_events","condition":"(k8s_audit_always_true)","tags":null,"enabled":"true","dependencies":["macro:k8s_audit_always_true:21ef6651784861fced1315889d54de4f"],"used_by":["macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"macro","hash":"89419f9eea00ed54a7e7dc8be73546e0"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L526,L527","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kactivity","macro":"kactivity","condition":"(kevt and consider_activity_events)","tags":null,"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:consider_activity_events:89419f9eea00ed54a7e7dc8be73546e0"],"used_by":["rule:K8s Deployment Created:baa16ce306ed06c0c7b8da5cbf5887de","rule:K8s Deployment Deleted:d421240865854432544241d569a04af5","rule:K8s Service Created:ae0e582f7f7279f82e5fb8d9a43c3f17","rule:K8s Service Deleted:a00592c93ed63f631e0376c58e82ab9a","rule:K8s ConfigMap Created:497ce34a8a3ca7b1db976f491905bb5f","rule:K8s ConfigMap Deleted:250b126545e2f71142c4fa7044a47c85","rule:K8s Namespace Created:fd2791e0d74bc33826b59a6938c5acd3","rule:K8s Namespace Deleted:32d046d86731ba73014ef4a3e6982de3","rule:K8s Serviceaccount Created:94c6f61206c9d18c1414b83951f00810","rule:K8s Serviceaccount Deleted:f0c361075797201bf27630d538b63608","rule:K8s Role Created:8fe44d54a12b78f592606bb1865e5af1","rule:K8s Role Deleted:847dfbe8fd658637189bd8fb68ba967e","rule:K8s ClusterRole Created:b781c3e1e9a3f6cb964345b3a5e3282b","rule:K8s ClusterRole Deleted:d0dd095741c61758102fd963b21ebd6c","rule:K8s RoleBinding Created:49c2da3b769be38e2ca9d68ed7e8ff43","rule:K8s RoleBinding Deleted:34ed95040bff72fc375124045bd03b27","rule:K8s ClusterRoleBinding Created:bb846f4a99ea3d6e7e8ef5a04f695417","rule:K8s ClusterRoleBinding Deleted:c5c74bdf5037ec903841ce1d3b32642d","rule:K8s Secret Created:0cfe5113b020e988115c63966a0096e3","rule:K8s Secret Deleted:5d9fab46ecddd2256510223c81935a65","rule:K8s Secret Get Successfully:cba1130d33330a09ee9ab90e949de28d","rule:K8s Secret Get Unsuccessfully Tried:a251a766f4420908cae668f0a0c08a08","rule:Ingress Object without TLS Certificate Created:f31d97edc305ecc002c782965508c07c"],"type":"macro","hash":"c039787987aab24bf4c158446153265c"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L529,L535","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Deployment Created","rule":"K8s Deployment Created","condition":"(kactivity and kcreate and deployment and response_successful)","desc":"Detect any attempt to create a deployment","output":"K8s Deployment Created (user=%ka.user.name deployment=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:deployment:06e5c0d0f9eabd9525e5f9dc4f6f37cf","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"baa16ce306ed06c0c7b8da5cbf5887de"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L537,L543","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Deployment Deleted","rule":"K8s Deployment Deleted","condition":"(kactivity and kdelete and deployment and response_successful)","desc":"Detect any attempt to delete a deployment","output":"K8s Deployment Deleted (user=%ka.user.name deployment=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:deployment:06e5c0d0f9eabd9525e5f9dc4f6f37cf","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"d421240865854432544241d569a04af5"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L545,L551","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Service Created","rule":"K8s Service Created","condition":"(kactivity and kcreate and service and response_successful)","desc":"Detect any attempt to create a service","output":"K8s Service Created (user=%ka.user.name service=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"ae0e582f7f7279f82e5fb8d9a43c3f17"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L553,L559","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Service Deleted","rule":"K8s Service Deleted","condition":"(kactivity and kdelete and service and response_successful)","desc":"Detect any attempt to delete a service","output":"K8s Service Deleted (user=%ka.user.name service=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"a00592c93ed63f631e0376c58e82ab9a"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L561,L567","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ConfigMap Created","rule":"K8s ConfigMap Created","condition":"(kactivity and kcreate and configmap and response_successful)","desc":"Detect any attempt to create a configmap","output":"K8s ConfigMap Created (user=%ka.user.name configmap=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:configmap:0eda34eee3148f7899d7ef2d7f1b0238","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"497ce34a8a3ca7b1db976f491905bb5f"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L569,L575","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ConfigMap Deleted","rule":"K8s ConfigMap Deleted","condition":"(kactivity and kdelete and configmap and response_successful)","desc":"Detect any attempt to delete a configmap","output":"K8s ConfigMap Deleted (user=%ka.user.name configmap=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:configmap:0eda34eee3148f7899d7ef2d7f1b0238","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"250b126545e2f71142c4fa7044a47c85"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L577,L583","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Namespace Created","rule":"K8s Namespace Created","condition":"(kactivity and kcreate and namespace and response_successful)","desc":"Detect any attempt to create a namespace","output":"K8s Namespace Created (user=%ka.user.name namespace=%ka.target.name resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:namespace:89801e9e98979062e84647433a8ed3e9","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"fd2791e0d74bc33826b59a6938c5acd3"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L585,L591","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Namespace Deleted","rule":"K8s Namespace Deleted","condition":"(kactivity and non_system_user and kdelete and namespace and response_successful)","desc":"Detect any attempt to delete a namespace","output":"K8s Namespace Deleted (user=%ka.user.name namespace=%ka.target.name resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:non_system_user:ea1dd8f878301676703a9f8cae5270c7","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:namespace:89801e9e98979062e84647433a8ed3e9","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"32d046d86731ba73014ef4a3e6982de3"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L593,L599","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Serviceaccount Created","rule":"K8s Serviceaccount Created","condition":"(kactivity and kcreate and serviceaccount and response_successful)","desc":"Detect any attempt to create a service account","output":"K8s Serviceaccount Created (user=%ka.user.name serviceaccount=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:serviceaccount:618c2280ccb9083ae6152f4eaec58a86","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"94c6f61206c9d18c1414b83951f00810"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L601,L607","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Serviceaccount Deleted","rule":"K8s Serviceaccount Deleted","condition":"(kactivity and kdelete and serviceaccount and response_successful)","desc":"Detect any attempt to delete a service account","output":"K8s Serviceaccount Deleted (user=%ka.user.name serviceaccount=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:serviceaccount:618c2280ccb9083ae6152f4eaec58a86","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"f0c361075797201bf27630d538b63608"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L609,L615","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Role Created","rule":"K8s Role Created","condition":"(kactivity and kcreate and role and response_successful)","desc":"Detect any attempt to create a role","output":"K8s Role Created (user=%ka.user.name role=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource rules=%ka.req.role.rules resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"8fe44d54a12b78f592606bb1865e5af1"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L617,L623","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Role Deleted","rule":"K8s Role Deleted","condition":"(kactivity and kdelete and role and response_successful)","desc":"Detect any attempt to delete a role","output":"K8s Role Deleted (user=%ka.user.name role=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"847dfbe8fd658637189bd8fb68ba967e"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L625,L631","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ClusterRole Created","rule":"K8s ClusterRole Created","condition":"(kactivity and kcreate and clusterrole and response_successful)","desc":"Detect any attempt to create a cluster role","output":"K8s ClusterRole Created (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource rules=%ka.req.role.rules resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"b781c3e1e9a3f6cb964345b3a5e3282b"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L633,L639","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ClusterRole Deleted","rule":"K8s ClusterRole Deleted","condition":"(kactivity and kdelete and clusterrole and response_successful)","desc":"Detect any attempt to delete a cluster role","output":"K8s ClusterRole Deleted (user=%ka.user.name role=%ka.target.name resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"d0dd095741c61758102fd963b21ebd6c"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L641,L647","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s RoleBinding Created","rule":"K8s RoleBinding Created","condition":"(kactivity and kcreate and rolebinding and response_successful)","desc":"Detect any attempt to create a rolebinding","output":"K8s RoleBinding Created (user=%ka.user.name binding=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource subjects=%ka.req.binding.subjects role=%ka.req.binding.role resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"49c2da3b769be38e2ca9d68ed7e8ff43"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L649,L655","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s RoleBinding Deleted","rule":"K8s RoleBinding Deleted","condition":"(kactivity and kdelete and rolebinding and response_successful)","desc":"Detect any attempt to delete a rolebinding","output":"K8s RoleBinding Deleted (user=%ka.user.name binding=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"34ed95040bff72fc375124045bd03b27"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L657,L663","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ClusterRoleBinding Created","rule":"K8s ClusterRoleBinding Created","condition":"(kactivity and kcreate and clusterrolebinding and response_successful)","desc":"Detect any attempt to create a clusterrolebinding","output":"K8s ClusterRoleBinding Created (user=%ka.user.name binding=%ka.target.name resource=%ka.target.resource subjects=%ka.req.binding.subjects role=%ka.req.binding.role resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"bb846f4a99ea3d6e7e8ef5a04f695417"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L665,L671","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s ClusterRoleBinding Deleted","rule":"K8s ClusterRoleBinding Deleted","condition":"(kactivity and kdelete and clusterrolebinding and response_successful)","desc":"Detect any attempt to delete a clusterrolebinding","output":"K8s ClusterRoleBinding Deleted (user=%ka.user.name binding=%ka.target.name resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:clusterrole:e094bcef29e4ca88c66ca030934e97a8","macro:clusterrolebinding:7c84785a0576aca333974b46f1be8056","macro:role:29a7e96467b69a9f5a93332e29e9b0de","macro:rolebinding:816912b6f24b4b0a491cb852ce31d181","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"c5c74bdf5037ec903841ce1d3b32642d"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L673,L679","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Secret Created","rule":"K8s Secret Created","condition":"(kactivity and kcreate and secret and ka.target.namespace!=kube-system and non_system_user and response_successful)","desc":"Detect any attempt to create a secret. Service account tokens are excluded.","output":"K8s Secret Created (user=%ka.user.name secret=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:non_system_user:ea1dd8f878301676703a9f8cae5270c7","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"0cfe5113b020e988115c63966a0096e3"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L681,L687","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Secret Deleted","rule":"K8s Secret Deleted","condition":"(kactivity and kdelete and secret and ka.target.namespace!=kube-system and non_system_user and response_successful)","desc":"Detect any attempt to delete a secret. Service account tokens are excluded.","output":"K8s Secret Deleted (user=%ka.user.name secret=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"INFO","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:non_system_user:ea1dd8f878301676703a9f8cae5270c7","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kdelete:c0bbea75a56d965e6085f0f12ec2d5d9","macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"5d9fab46ecddd2256510223c81935a65"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L689,L699","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Secret Get Successfully","rule":"K8s Secret Get Successfully","condition":"secret and kget and kactivity and response_successful\n","desc":"Detect any attempt to get a secret. Service account tokens are excluded.\n","output":"K8s Secret Get Successfully (user=%ka.user.name secret=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"ERROR","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kget:1551c63ba750fc9be9eebe12e7007d58","macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"cba1130d33330a09ee9ab90e949de28d"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L701,L711","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"K8s Secret Get Unsuccessfully Tried","rule":"K8s Secret Get Unsuccessfully Tried","condition":"secret and kget and kactivity and not response_successful\n","desc":"Detect an unsuccessful attempt to get the secret. Service account tokens are excluded.\n","output":"K8s Secret Get Unsuccessfully Tried (user=%ka.user.name secret=%ka.target.name ns=%ka.target.namespace resource=%ka.target.resource resp=%ka.response.code decision=%ka.auth.decision reason=%ka.auth.reason)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kget:1551c63ba750fc9be9eebe12e7007d58","macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69","macro:kactivity:c039787987aab24bf4c158446153265c"],"type":"rule","hash":"a251a766f4420908cae668f0a0c08a08"},{"file_name":"k8s_audit_rules.yaml","comment":"# This rule generally matches all events, and as a result is disabled\n# by default. If you wish to enable these events, modify the\n# following macro.\n#  condition: (jevt.rawtime exists)","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L717,L718","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"consider_all_events","macro":"consider_all_events","condition":"(k8s_audit_never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:k8s_audit_never_true:9a704dd4f5279b6d5619cb257258825a","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:kall:49eca81243ca4a3913e6eeb4ced49ab4"],"type":"macro","hash":"38d89891d1f279c05021c92e24eee45a"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L720,L721","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"kall","macro":"kall","condition":"(kevt and consider_all_events)","tags":null,"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:consider_all_events:38d89891d1f279c05021c92e24eee45a"],"used_by":["rule:All K8s Audit Events:b75a7e2bc66eb128e92ce522de7bec02"],"type":"macro","hash":"49eca81243ca4a3913e6eeb4ced49ab4"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L723,L729","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"All K8s Audit Events","rule":"All K8s Audit Events","condition":"kall","desc":"Match all K8s Audit Events","output":"K8s Audit Event received (user=%ka.user.name verb=%ka.verb uri=%ka.uri obj=%jevt.obj)","priority":"DEBUG","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kall:49eca81243ca4a3913e6eeb4ced49ab4"],"type":"rule","hash":"b75a7e2bc66eb128e92ce522de7bec02"},{"file_name":"k8s_audit_rules.yaml","comment":"# This macro disables following rule, change to k8s_audit_never_true to enable it","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L733,L734","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_full_admin_users","macro":"allowed_full_admin_users","condition":"(k8s_audit_always_true)","tags":null,"enabled":"true","dependencies":["macro:k8s_audit_always_true:21ef6651784861fced1315889d54de4f"],"used_by":["rule:Full K8s Administrative Access:fdc73e7ea6f6062e87e06bc3a197bbba"],"type":"macro","hash":"7b1c241c01498a54f103f3d91c24fd5f"},{"file_name":"k8s_audit_rules.yaml","comment":"# This list includes some of the default user names for an administrator in several K8s installations","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L737,L738","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"full_admin_k8s_users","list":"full_admin_k8s_users","items":["admin","kubernetes-admin","kubernetes-admin@kubernetes","kubernetes-admin@cluster.local","minikube-user"],"tags":null,"enabled":"true","used_by":["rule:Full K8s Administrative Access:fdc73e7ea6f6062e87e06bc3a197bbba"],"type":"list","hash":"ac0f6f2c7cee80830da2d588560ef529"},{"file_name":"k8s_audit_rules.yaml","comment":"# # How to test:\n# # Execute any kubectl command connected using default cluster user, as:\n# kubectl create namespace rule-test\n","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L751,L761","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Full K8s Administrative Access","rule":"Full K8s Administrative Access","condition":"kevt and non_system_user and ka.user.name in (full_admin_k8s_users) and not allowed_full_admin_users\n","desc":"Detect any k8s operation by a user name that may be an administrator with full access.","output":"K8s Operation performed by full admin user (user=%ka.user.name target=%ka.target.name/%ka.target.resource verb=%ka.verb uri=%ka.uri resp=%ka.response.code)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:non_system_user:ea1dd8f878301676703a9f8cae5270c7","macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:allowed_full_admin_users:7b1c241c01498a54f103f3d91c24fd5f","list:full_admin_k8s_users:ac0f6f2c7cee80830da2d588560ef529"],"type":"rule","hash":"fdc73e7ea6f6062e87e06bc3a197bbba"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L763,L764","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ingress","macro":"ingress","condition":"ka.target.resource=ingresses","tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","rule:Ingress Object without TLS Certificate Created:f31d97edc305ecc002c782965508c07c","macro:ingress_remote_file_copy_procs:0b484aafac3e4358917b2200ea0c3db6","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","macro:nginx_writing_conf:f33ce7381e87ec371ee3892c2f4d6cbc"],"type":"macro","hash":"17f1d7a64442cda6863a4251c2eaf2ee"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L766,L767","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"ingress_tls","macro":"ingress_tls","condition":"(jevt.value[/requestObject/spec/tls] exists)","tags":null,"enabled":"true","used_by":["rule:Ingress Object without TLS Certificate Created:f31d97edc305ecc002c782965508c07c"],"type":"macro","hash":"88b4652cf5ccbf525497128da22c70d9"},{"file_name":"k8s_audit_rules.yaml","comment":"# # How to test:\n# # Create an ingress.yaml file with content:\n# apiVersion: networking.k8s.io/v1beta1\n# kind: Ingress\n# metadata:\n#   name: test-ingress\n#   annotations:\n#     nginx.ingress.kubernetes.io/rewrite-target: /\n# spec:\n#   rules:\n#   - http:\n#       paths:\n#       - path: /testpath\n#         backend:\n#           serviceName: test\n#           servicePort: 80\n# # Execute: kubectl apply -f ingress.yaml\n","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L787,L796","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Ingress Object without TLS Certificate Created","rule":"Ingress Object without TLS Certificate Created","condition":"(kactivity and kcreate and ingress and response_successful and not ingress_tls)\n","desc":"Detect any attempt to create an ingress without TLS certification.","output":"K8s Ingress Without TLS Cert Created (user=%ka.user.name ingress=%ka.target.name namespace=%ka.target.namespace resource=%ka.target.resource)\n","priority":"WARNING","source":"k8s_audit","tags":["k8s","network"],"enabled":"true","dependencies":["macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:kactivity:c039787987aab24bf4c158446153265c","macro:ingress:17f1d7a64442cda6863a4251c2eaf2ee","macro:ingress_tls:88b4652cf5ccbf525497128da22c70d9"],"type":"rule","hash":"f31d97edc305ecc002c782965508c07c"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L798,L799","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"node","macro":"node","condition":"ka.target.resource=nodes","tags":null,"enabled":"true","used_by":["macro:possibly_node_in_container:513181c67b31a65f5956a1911a700134","macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:Create NodePort Service:783d7200e4293a462c47478e3efe1467","rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:openshift_image:a963c49d809c7db284d12a2020ad26b8","macro:countly_writing_nginx_conf:9f036fc92d9d76325370070d05d88fb7","macro:calico_writing_envvars:a1d9219fdd79e0c59e841ab828134502","macro:calico_writing_conf:fb5d431d5974e4f9d0fa2072d97d0b35","macro:openshift_writing_conf:df511403cf15d1a11797346f6cf6efd0","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","macro:known_root_conditions:c3eb88c06b723b2c8512606e49498c5d","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"36c4536996ca5615dcf9911f068786dc"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L801,L802","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allow_all_k8s_nodes","macro":"allow_all_k8s_nodes","condition":"(k8s_audit_always_true)","tags":null,"enabled":"true","dependencies":["macro:k8s_audit_always_true:21ef6651784861fced1315889d54de4f"],"used_by":["rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57"],"type":"macro","hash":"dcfaad7a677bccbcaee9df174560a2af"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L804,L805","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"allowed_k8s_nodes","list":"allowed_k8s_nodes","tags":null,"enabled":"true","used_by":["rule:Untrusted Node Successfully Joined the Cluster:35e82364277453c3ce626b5f5c3585fc","rule:Untrusted Node Unsuccessfully Tried to Join the Cluster:3d7bdfd28a7d480013104a5ef2723a57"],"type":"list","hash":"8a35ef2aa9204abef6798f14eb17ab4e"},{"file_name":"k8s_audit_rules.yaml","comment":"# # How to test:\n# # Create a Falco monitored cluster with Kops\n# # Increase the number of minimum nodes with:\n# kops edit ig nodes\n# kops apply --yes\n","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L813,L825","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Untrusted Node Successfully Joined the Cluster","rule":"Untrusted Node Successfully Joined the Cluster","condition":"kevt and node and kcreate and response_successful and not allow_all_k8s_nodes and not ka.target.name in (allowed_k8s_nodes)\n","desc":"Detect a node successfully joined the cluster outside of the list of allowed nodes.\n","output":"Node not in allowed list successfully joined the cluster (user=%ka.user.name node=%ka.target.name resource=%ka.target.resource)","priority":"ERROR","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:node:36c4536996ca5615dcf9911f068786dc","macro:allow_all_k8s_nodes:dcfaad7a677bccbcaee9df174560a2af","list:allowed_k8s_nodes:8a35ef2aa9204abef6798f14eb17ab4e"],"type":"rule","hash":"35e82364277453c3ce626b5f5c3585fc"},{"file_name":"k8s_audit_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/plugins/blob/master/plugins/k8saudit/rules/k8s_audit_rules.yaml#L827,L839","required_engine_version":"15","required_plugin_versions":[{"name":"k8saudit","version":"0.7.0"},{"name":"json","version":"0.7.0"}],"name":"Untrusted Node Unsuccessfully Tried to Join the Cluster","rule":"Untrusted Node Unsuccessfully Tried to Join the Cluster","condition":"kevt and node and kcreate and not response_successful and not allow_all_k8s_nodes and not ka.target.name in (allowed_k8s_nodes)\n","desc":"Detect an unsuccessful attempt to join the cluster for a node not in the list of allowed nodes.\n","output":"Node not in allowed list tried unsuccessfully to join the cluster  (user=%ka.user.name node=%ka.target.name reason=%ka.response.reason resource=%ka.target.resource)","priority":"WARNING","source":"k8s_audit","tags":["k8s"],"enabled":"true","dependencies":["macro:kevt:3d34a33c12c8213012019ec4fa8cc532","macro:response_successful:bc99c7e7262b779ed500f70e56121743","macro:kcreate:37c7fc423d74cded348b39b4d2784eb4","macro:node:36c4536996ca5615dcf9911f068786dc","macro:allow_all_k8s_nodes:dcfaad7a677bccbcaee9df174560a2af","list:allowed_k8s_nodes:8a35ef2aa9204abef6798f14eb17ab4e"],"type":"rule","hash":"3d7bdfd28a7d480013104a5ef2723a57"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L30,L31","required_engine_version":"0.35.0","name":"open_write","macro":"open_write","condition":"(evt.type in (open,openat,openat2) and evt.is_open_write=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:truncate_shell_history:ac78bdcd5d832a2f504b6e3ce03a6868","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3"],"type":"macro","hash":"43a1a1a71582531905f162ae8757ecda","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L33,L34","required_engine_version":"0.35.0","name":"open_read","macro":"open_read","condition":"(evt.type in (open,openat,openat2) and evt.is_open_read=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","rule:Backdoored library loaded into SSHD (CVE-2024-3094):6a98bda365511a682502887ba09fb757","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"macro","hash":"fada70dac63821c34b095b962e02cb36","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L36,L37","required_engine_version":"0.35.0","name":"open_directory","macro":"open_directory","condition":"(evt.type in (open,openat,openat2) and evt.is_open_read=true and fd.typechar='d' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2"],"type":"macro","hash":"33881afcd207d86e9ec883f45c4afaf7","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This macro `never_true` is used as placeholder for tuning negative logical sub-expressions, for example\n# - macro: allowed_ssh_hosts\n#   condition: (never_true)\n# can be used in a rules' expression with double negation `and not allowed_ssh_hosts` which effectively evaluates\n# to true and does nothing, the perfect empty template for `logical` cases as opposed to list templates.\n# When tuning the rule you can override the macro with something useful, e.g.\n# - macro: allowed_ssh_hosts\n#   condition: (evt.hostname contains xyz)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L47,L48","required_engine_version":"0.35.0","name":"never_true","macro":"never_true","condition":"(evt.num=0)","tags":null,"enabled":"true","used_by":["macro:user_known_read_sensitive_files_activities:93013fdd38f628311bbd04ebd0e01436","macro:possibly_node_in_container:513181c67b31a65f5956a1911a700134","macro:possibly_parent_java_running_tomcat:ff2e34a96a3a090dab697eb7bef460f0","macro:user_known_system_user_login:c220c191248c206685113a98cf6cc4f4","macro:user_expected_terminal_shell_in_container_conditions:506bd5cc090648cf6e9411357909e53d","macro:user_shell_container_exclusions:f0b59b425c9d3204fb50ec6e436e8cd7","macro:user_known_contact_k8s_api_server_activities:4c6ed813572d74073bccdf798a240244","macro:grep_more:1f162d2b9d80645c0c17e19656463e53","macro:allowed_clear_log_files:27cabc017fb347048c5906d368af02da","macro:user_known_remove_data_activities:82aeff15fb6a39dfd18eb8a0aa4490b2","macro:user_known_stand_streams_redirect_activities:c2f8c69b4ec7a2b55cd5ce0381586875","macro:known_drop_and_execute_activities:a1a1ce54329c3cd6f627d9bdc5e50ea8","macro:user_known_node_port_service:eef8c8cb2dddbde98acc0032c8437a1e","macro:user_known_exec_pod_activities:654a93971e99c9f7b3bb5a8614b96d7f","macro:user_known_portforward_activities:c1bda959367c501d28cf34ac7b327cd5","macro:user_known_pod_debug_activities:f680ce82ade487e7d4c6d0bcf300391a","macro:consider_all_events:38d89891d1f279c05021c92e24eee45a","macro:user_known_shell_config_modifiers:6b8f57e70346a317add4e1e9046c3660","macro:user_known_cron_jobs:e19053b1c16c7ae8df45015aafbe5355","macro:user_known_read_ssh_information_activities:66b9d639d9ffb5e4aec0837ef7b1a7f2","macro:user_known_db_spawned_processes:e9782b773c4c9b7a5b5c0c30a23a0662","macro:user_known_change_thread_namespace_activities:be737247cfb371d8c20ef23aab8bed09","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_privileged_containers:605f400a686e1bec4f1e18414be552c5","macro:user_expected_system_procs_network_activity_conditions:2c633a138f025b38353d5ed0477bfd72","macro:allowed_ssh_proxy_env:ee1096508e1dd9b7b7b2a990d6fd1cb5","macro:user_known_user_management_activities:23d1a029d115829da2c3d05ddc8ba459","macro:user_known_create_files_below_dev_activities:e252bfb734f01b620917e7724e620572","macro:ec2_metadata_containers:d5f0dfcd1bb7ef57fab8910ab3796682","macro:user_known_package_manager_in_container:e9db6635f0430b51de8b303990f927a7","macro:user_known_network_tool_activities:9b807c4e0d8ba042426b117cdced8023","macro:user_known_set_setuid_or_setgid_bit_conditions:8d6a4ea3d29f9754bb194645d6826e7e","macro:user_known_remote_file_copy_activities:5847045134b24363470fbdeb3e4ddbdf","macro:user_known_mount_in_privileged_containers:aeaf73de6e782cca5767eccf444dfc86","macro:user_known_ingress_remote_file_copy_activities:4e472f54aebecefce22864525e76104b","macro:user_known_update_package_registry:9e4592918895a4946eeab7a831fd4c7c","macro:user_known_write_below_binary_dir_activities:e9327cc6148dd2254c56add6bdca831d","macro:user_known_write_monitored_dir_conditions:08d473341b14e4bbae4157a75faab7f7","macro:etckeeper_activities:1e5781086c2cc3322cf517ae6e095ccc","macro:user_known_write_below_etc_activities:1481c66148493216582035ff05ba2863","macro:user_known_write_below_root_activities:b1f944844634ff62884377a1e56fca2a","macro:user_known_write_rpm_database_activities:c772da1c64ba873faf57a17e5c0af342","macro:user_known_modify_bin_dir_activities:22c60c5fe87a748d783a1bf606652cd6","macro:user_known_mkdir_bin_dir_activities:07904727e6d103f3e4cec0b46f15466d","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_sensitive_mount_containers:f0bae3b600b45943c88848d69ff0511b","macro:nodeport_containers:d08e4abe1246be2869449a98762daa05","macro:user_known_create_hidden_file_activities:c604f50751c1133a076f8194b9f04921","macro:user_known_container_drift_activities:46ac0d3ff6fcf7d1fec5e687faf159f5"],"type":"macro","hash":"7fdab030a488289fce9f593757b50ba3","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# In some cases, such as dropped system call events, information about\n# the process name may be missing. For some rules that really depend\n# on the identity of the process performing an action such as opening\n# a file, etc., we require that the process name be known.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L65,L66","required_engine_version":"0.35.0","name":"proc_name_exists","macro":"proc_name_exists","condition":"(not proc.name in (\"\u003cNA\u003e\",\"N/A\"))","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:PTRACE attached to process:061f25635ba16ec4c05dec23396e4a6d","rule:PTRACE anti-debug attempt:2552a1ec1bd48915c8e2f2279ea7054e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"453387eaa91c2ac2bd725502766ed7d3","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L68,L69","required_engine_version":"0.35.0","name":"rename","macro":"rename","condition":"(evt.type in (rename, renameat, renameat2))","tags":null,"enabled":"true","used_by":["macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079"],"type":"macro","hash":"d7fba04fc8e17bcfc603b318a85b762c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L71,L72","required_engine_version":"0.35.0","name":"remove","macro":"remove","condition":"(evt.type in (rmdir, unlink, unlinkat))","tags":null,"enabled":"true","used_by":["rule:Remove Collaborator from Repository:943741810bf68993058924c0fa203405","macro:clear_data_procs:d1a24b75738d164999774767fb52b175","rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a"],"type":"macro","hash":"0f6969d7052da9261e31ddb6e88c136e","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L74,L75","required_engine_version":"0.35.0","name":"modify","macro":"modify","condition":"(rename or remove)","tags":null,"enabled":"true","dependencies":["macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:remove:0f6969d7052da9261e31ddb6e88c136e"],"used_by":["rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","macro:modify_shell_history:a4caae82528f2d3e827266ba74a3e115","rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"8f45a2644508b5282f57fe129f62d19a","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L77,L78","required_engine_version":"0.35.0","name":"spawned_process","macro":"spawned_process","condition":"(evt.type in (execve, execveat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","rule:Search Private Keys or Passwords:55941ff25a7d8c6253b5a17e4ed20d30","rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Find AWS Credentials:6f600d3da731ed8b36a42b3e6edc613a","rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Fileless execution via memfd_create:421925c119255e3807c6bbf9609c23cb","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7","rule:Program run with disallowed http proxy env:cf0f7f713bd9ca1baa7ef93da5ca1a3a","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Potential Local Privilege Escalation via Environment Variables Misuse:5ab919338a6e3deab238595f8895a76c","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Detect crypto miners using the Stratum protocol:b22719ac071b8de3c7e0ec92dcab21cb","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Sudo Potential Privilege Escalation:f1e70442dbd3656e78ceb11d3863b239","rule:Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034):5bc83b5d4fdd9b976dabc965dfe05fee","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81","rule:Basic Interactive Reconnaissance:f919d2aa742cf1ef21907e9e3d805ca1"],"type":"macro","hash":"b684ebf37c34399a595a3791398d95b2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L80,L81","required_engine_version":"0.35.0","name":"chmod","macro":"chmod","condition":"(evt.type in (chmod, fchmod, fchmodat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6"],"type":"macro","hash":"417e248f80c35ca0d471575a5fb951f5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L83,L84","required_engine_version":"0.35.0","name":"shell_binaries","list":"shell_binaries","items":["ash","bash","csh","ksh","sh","tcsh","zsh","dash"],"tags":null,"enabled":"true","used_by":["macro:shell_procs:8907863a6a74678a4246f35930a29fe1","rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"af03e5f14f4aa2d1505ec180e1c58caf","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L86,L87","required_engine_version":"0.35.0","name":"ssh_binaries","list":"ssh_binaries","items":["sshd","sftp-server","ssh-agent","ssh","scp","sftp","ssh-keygen","ssh-keysign","ssh-keyscan","ssh-add"],"tags":null,"enabled":"true","used_by":["rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2"],"type":"list","hash":"ec2d0b20ba5fdce37cbef587b8e2675f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L93,L94","required_engine_version":"0.35.0","name":"coreutils_binaries","list":"coreutils_binaries","items":["truncate","sha1sum","numfmt","fmt","fold","uniq","cut","who","groups","csplit","sort","expand","printf","printenv","unlink","tee","chcon","stat","basename","split","nice","yes","whoami","sha224sum","hostid","users","stdbuf","base64","unexpand","cksum","od","paste","nproc","pathchk","sha256sum","wc","test","comm","arch","du","factor","sha512sum","md5sum","tr","runcon","env","dirname","tsort","join","shuf","install","logname","pinky","nohup","expr","pr","tty","timeout","tail","[","seq","sha384sum","nl","head","id","mkfifo","sum","dircolors","ptx","shred","tac","link","chroot","vdir","chown","touch","ls","dd","uname","true","pwd","date","chgrp","chmod","mktemp","cat","mknod","sync","ln","false","rm","mv","cp","echo","readlink","sleep","stty","mkdir","df","dir","rmdir","touch"],"tags":null,"enabled":"true","used_by":["macro:system_procs:1626c650eb514b1780d01d83b1609b2f"],"type":"list","hash":"951ddcc867d00ecc5c13e9a6796c47db","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# dpkg -L login | grep bin | xargs ls -ld | grep -v '^d' | awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L108,L109","required_engine_version":"0.35.0","name":"login_binaries","list":"login_binaries","items":["login","systemd","\"(systemd)\"","systemd-logind","su","nologin","faillog","lastlog","newgrp","sg"],"tags":null,"enabled":"true","type":"list","hash":"dedbc650e5df9d28c764ee3aedae7db9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# dpkg -L passwd | grep bin | xargs ls -ld | grep -v '^d' | awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L115,L116","required_engine_version":"0.35.0","name":"passwd_binaries","list":"passwd_binaries","items":["shadowconfig","grpck","pwunconv","grpconv","pwck","groupmod","vipw","pwconv","useradd","newusers","cppw","chpasswd","usermod","groupadd","groupdel","grpunconv","chgpasswd","userdel","chage","chsh","gpasswd","chfn","expiry","passwd","vigr","cpgr","adduser","addgroup","deluser","delgroup"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"11d902c686355a4df0580d2b954301da","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# repoquery -l shadow-utils | grep bin | xargs ls -ld | grep -v '^d' |\n#     awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L125,L126","required_engine_version":"0.35.0","name":"shadowutils_binaries","list":"shadowutils_binaries","items":["chage","gpasswd","lastlog","newgrp","sg","adduser","deluser","chpasswd","groupadd","groupdel","addgroup","delgroup","groupmems","groupmod","grpck","grpconv","grpunconv","newusers","pwck","pwconv","pwunconv","useradd","userdel","usermod","vigr","vipw","unix_chkpwd"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"dd53fb0d2784a8a52ac3c20ab275de72","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L132,L133","required_engine_version":"0.35.0","name":"sysdigcloud_binaries","list":"sysdigcloud_binaries","items":["setup-backend","dragent","sdchecks"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"5cd4a552978d2b6ed446f11f8a294cbf","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L135,L136","required_engine_version":"0.35.0","name":"k8s_binaries","list":"k8s_binaries","items":["hyperkube","skydns","kube2sky","exechealthz","weave-net","loopback","bridge","openshift-sdn","openshift"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"list","hash":"52eba9972841f1a5acc644f595824d65","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L138,L139","required_engine_version":"0.35.0","name":"lxd_binaries","list":"lxd_binaries","items":["lxd","lxcfs"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"list","hash":"9f8fa9ebc7ba17e064657b840faf1603","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L141,L142","required_engine_version":"0.35.0","name":"db_server_binaries","list":"db_server_binaries","items":["mysqld","postgres","sqlplus"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7"],"type":"list","hash":"449619792d4c73357d92287273fbd164","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# The explicit quotes are needed to avoid the - characters being\n# interpreted by the filter expression.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L146,L147","required_engine_version":"0.35.0","name":"rpm_binaries","list":"rpm_binaries","items":["dnf","dnf-automatic","rpm","rpmkey","yum","\"75-system-updat\"","rhsmcertd-worke","rhsmcertd","subscription-ma","repoquery","rpmkeys","rpmq","yum-cron","yum-config-mana","yum-debug-dump","abrt-action-sav","rpmdb_stat","microdnf","rhn_check","yumdb"],"tags":null,"enabled":"true","used_by":["macro:rpm_procs:4af559147e158d724c3273c0cf781a9f"],"type":"list","hash":"7ee4dcdb218ac951a864e29417a8177c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L151,L152","required_engine_version":"0.35.0","name":"deb_binaries","list":"deb_binaries","items":["dpkg","dpkg-preconfigu","dpkg-reconfigur","dpkg-divert","apt","apt-get","aptitude","frontend","preinst","add-apt-reposit","apt-auto-remova","apt-key","apt-listchanges","unattended-upgr","apt-add-reposit","apt-cache","apt.systemd.dai"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"69ab88691c72177ecff691379ff122c4","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L156,L157","required_engine_version":"0.35.0","name":"python_package_managers","list":"python_package_managers","items":["pip","pip3","conda"],"tags":null,"enabled":"true","type":"list","hash":"a529bcd7406766c180064511628b15f3","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# The truncated dpkg-preconfigu is intentional, process names are\n# truncated at the falcosecurity-libs level.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L161,L162","required_engine_version":"0.35.0","name":"package_mgmt_binaries","list":"package_mgmt_binaries","items":["rpm_binaries","deb_binaries","update-alternat","gem","npm","python_package_managers","sane-utils.post","alternatives","chef-client","apk","snapd"],"tags":null,"enabled":"true","used_by":["macro:run_by_package_mgmt_binaries:330b541f474e818efb55c808d9f9ec6f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"cbd791c45a9d5d51118aaf6c9ce6b934","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L164,L165","required_engine_version":"0.35.0","name":"package_mgmt_procs","macro":"package_mgmt_procs","condition":"(proc.name in (package_mgmt_binaries))","tags":null,"enabled":"true","dependencies":["list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934"],"used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c"],"type":"macro","hash":"a69d5abbdc29f4dde6b8ec5c7d0209d6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L167,L168","required_engine_version":"0.35.0","name":"package_mgmt_ancestor_procs","macro":"package_mgmt_ancestor_procs","condition":"(proc.pname in (package_mgmt_binaries) or proc.aname[2] in (package_mgmt_binaries) or proc.aname[3] in (package_mgmt_binaries) or proc.aname[4] in (package_mgmt_binaries))","tags":null,"enabled":"true","dependencies":["list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934"],"used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad"],"type":"macro","hash":"b5f7b9871403d1f16226b65c823c46de","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# A canonical set of processes that run other programs with different\n# privileges or as a different user.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L175,L176","required_engine_version":"0.35.0","name":"userexec_binaries","list":"userexec_binaries","items":["sudo","su","suexec","critical-stack","dzdo"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"list","hash":"a565f19993c396a912312fc67ef23f02","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L178,L179","required_engine_version":"0.35.0","name":"known_setuid_binaries","list":"known_setuid_binaries","items":["sshd","dbus-daemon-lau","ping","ping6","critical-stack-","pmmcli","filemng","PassengerAgent","bwrap","osdetect","nginxmng","sw-engine-fpm","start-stop-daem"],"tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"list","hash":"6bcf294bfeb0e3ca956e1278b8c1d47d","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L185,L186","required_engine_version":"0.35.0","name":"user_mgmt_binaries","list":"user_mgmt_binaries","items":["login_binaries","passwd_binaries","shadowutils_binaries"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:system_procs:1626c650eb514b1780d01d83b1609b2f","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"list","hash":"2b8476e193b6319359b8500841101a95","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L188,L189","required_engine_version":"0.35.0","name":"dev_creation_binaries","list":"dev_creation_binaries","items":["blkid","rename_device","update_engine","sgdisk"],"tags":null,"enabled":"true","used_by":["rule:Create files below dev:c1ac5692e9c9d8be0dd8c387ee3fe192","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"2de5fcfae70913478022a9d4bd879f48","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L191,L192","required_engine_version":"0.35.0","name":"nomachine_binaries","list":"nomachine_binaries","items":["nxexec","nxnode.bin","nxserver.bin","nxclient.bin"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"be10dcfdff8f673dfb82d8bed97c68b9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L194,L195","required_engine_version":"0.35.0","name":"system_procs","macro":"system_procs","condition":"(proc.name in (coreutils_binaries, user_mgmt_binaries))","tags":null,"enabled":"true","dependencies":["list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95","list:coreutils_binaries:951ddcc867d00ecc5c13e9a6796c47db","list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95"],"used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55"],"type":"macro","hash":"1626c650eb514b1780d01d83b1609b2f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L197,L198","required_engine_version":"0.35.0","name":"mail_binaries","list":"mail_binaries","items":["sendmail","sendmail-msp","postfix","procmail","exim4","pickup","showq","mailq","dovecot","imap-login","imap","mailmng-core","pop3-login","dovecot-lda","pop3"],"tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"list","hash":"e80bc600472c458a1eb834ef6cc3608d","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# RFC1918 addresses were assigned for private network usage","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L205,L206","required_engine_version":"0.35.0","name":"rfc_1918_addresses","list":"rfc_1918_addresses","items":["\"10.0.0.0/8\"","\"172.16.0.0/12\"","\"192.168.0.0/16\""],"tags":null,"enabled":"true","used_by":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:network_local_subnet:7c4dcd18fe7bc3092fbc897963b579e1","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"list","hash":"748492cefb06210e27885e76e1ab8f7a","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L208,L209","required_engine_version":"0.35.0","name":"outbound","macro":"outbound","condition":"(((evt.type = connect and evt.dir=\u003c) or\n  (evt.type in (sendto,sendmsg) and evt.dir=\u003c and\n   fd.l4proto != tcp and fd.connected=false and fd.name_changed=true)) and\n (fd.typechar = 4 or fd.typechar = 6) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","dependencies":["list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a"],"used_by":["rule:Disallowed SSH Connection Non Standard Port:8d88e40d9773d500a7fb9fb5d28d0aad","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Interpreted procs outbound network activity:f44c77a690d44b9d8004d3283a63cb92","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"b5229dfdd9136d1c772f9070f3095016","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Very similar to inbound/outbound, but combines the tests together\n# for efficiency.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L219,L220","required_engine_version":"0.35.0","name":"inbound_outbound","macro":"inbound_outbound","condition":"((((evt.type in (accept,accept4,listen,connect) and evt.dir=\u003c)) and\n (fd.typechar = 4 or fd.typechar = 6)) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\") and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"5b954dcc69c9cfaf014ba8fbebce7921","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L226,L227","required_engine_version":"0.35.0","name":"bash_config_filenames","list":"bash_config_filenames","items":[".bashrc",".bash_profile",".bash_history",".bash_login",".bash_logout",".inputrc",".profile"],"tags":null,"enabled":"true","type":"list","hash":"db913d561c87670025faa7fc7396b70c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L229,L230","required_engine_version":"0.35.0","name":"bash_config_files","list":"bash_config_files","items":["/etc/profile","/etc/bashrc"],"tags":null,"enabled":"true","type":"list","hash":"0b7b8e1f3e524019209f61ac4619a676","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Covers both csh and tcsh","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L233,L234","required_engine_version":"0.35.0","name":"csh_config_filenames","list":"csh_config_filenames","items":[".cshrc",".login",".logout",".history",".tcshrc",".cshdirs"],"tags":null,"enabled":"true","type":"list","hash":"a869e10df8d46cc3b09978b58aea1ed0","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L236,L237","required_engine_version":"0.35.0","name":"csh_config_files","list":"csh_config_files","items":["/etc/csh.cshrc","/etc/csh.login"],"tags":null,"enabled":"true","type":"list","hash":"91f60a0ac21cc0e0bb708943c58935b6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L239,L240","required_engine_version":"0.35.0","name":"zsh_config_filenames","list":"zsh_config_filenames","items":[".zshenv",".zprofile",".zshrc",".zlogin",".zlogout"],"tags":null,"enabled":"true","type":"list","hash":"9fefc4e5753ca35077feb17387946a7d","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L242,L243","required_engine_version":"0.35.0","name":"shell_config_filenames","list":"shell_config_filenames","items":["bash_config_filenames","csh_config_filenames","zsh_config_filenames"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"9a1cc70e3d80e9c985b9dc47127279c7","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L245,L246","required_engine_version":"0.35.0","name":"shell_config_files","list":"shell_config_files","items":["bash_config_files","csh_config_files"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"55240f881e56a7081450b9163ca1ea28","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L248,L249","required_engine_version":"0.35.0","name":"shell_config_directories","list":"shell_config_directories","items":["/etc/zsh"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"cc7eb8ab2529db0fa344a822e8499e15","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L251,L252","required_engine_version":"0.35.0","name":"user_known_shell_config_modifiers","macro":"user_known_shell_config_modifiers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133"],"type":"macro","hash":"6b8f57e70346a317add4e1e9046c3660","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L254,L271","required_engine_version":"0.35.0","name":"Modify Shell Configuration File","rule":"Modify Shell Configuration File","condition":"open_write  and (fd.filename in (shell_config_filenames) or\n     fd.name in (shell_config_files) or\n     fd.directory in (shell_config_directories))\nand not proc.name in (shell_binaries) and not exe_running_docker_save and not user_known_shell_config_modifiers\n","desc":"Detect attempts to modify shell configuration files, primarily aimed at establishing persistence by automatically inserting  commands into scripts executed by shells. The upstream rule excludes shell processes because they often create unnecessary noise. However, this might lead to missed detections. To customize the rule for your situation, you can fine-tune it using enhanced profiling.  For example, you might want to only consider interactive shell processes (where proc.tty != 0).\n","output":"A shell configuration file has been modified (file=%fd.name pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","host","container","filesystem","mitre_persistence","T1546.004"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:open_write:43a1a1a71582531905f162ae8757ecda","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_config_filenames:9a1cc70e3d80e9c985b9dc47127279c7","list:shell_config_files:55240f881e56a7081450b9163ca1ea28","list:shell_config_directories:cc7eb8ab2529db0fa344a822e8499e15","macro:user_known_shell_config_modifiers:6b8f57e70346a317add4e1e9046c3660","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_config_filenames:9a1cc70e3d80e9c985b9dc47127279c7","list:shell_config_files:55240f881e56a7081450b9163ca1ea28","list:shell_config_directories:cc7eb8ab2529db0fa344a822e8499e15","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386"],"type":"rule","hash":"1b94739671e7836a3321a1f2a3720133","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L273,L274","required_engine_version":"0.35.0","name":"user_known_cron_jobs","macro":"user_known_cron_jobs","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842"],"type":"macro","hash":"e19053b1c16c7ae8df45015aafbe5355","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L276,L287","required_engine_version":"0.35.0","name":"Schedule Cron Jobs","rule":"Schedule Cron Jobs","condition":"((open_write and fd.name startswith /etc/cron) or\n (spawned_process and proc.name = \"crontab\")) \nand not user_known_cron_jobs\n","desc":"Detect scheduled cron jobs; this is a highly generic detection and certainly needs adjustments and profiling in your environment before  operationalization. Simultaneously, exploiting the functionality of cron jobs is among one of the oldest TTPs used by adversaries.\n","output":"Cron jobs were scheduled to run (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","filesystem","mitre_execution","T1053.003"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:user_known_cron_jobs:e19053b1c16c7ae8df45015aafbe5355","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"8dac86f3c89ab2eebddfaef6b307f842","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Use this to test whether the event occurred within a container.\n#\n# When displaying container information in the output field, use\n# %container.info, without any leading term (file=%fd.name\n# %container.info user=%user.name user_loginuid=%user.loginuid, and not file=%fd.name\n# container=%container.info user=%user.name user_loginuid=%user.loginuid). The output will change\n# based on the context and whether or not -pk/-pm/-pc was specified on\n# the command line.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L297,L298","required_engine_version":"0.35.0","name":"container","macro":"container","condition":"(container.id != host)","tags":null,"enabled":"true","used_by":["macro:user_read_sensitive_file_containers:e8df79ecac70e22ac5ac4f683bb13d24","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","macro:trusted_logging_images:321c1a70d9796565640a81b9f3701e42","macro:containerd_activities:c2ce963725cd72b3df80b07413b7e4c4","rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Packet socket created in container:59e21c1607722fe0bee894eff26d9025","rule:Redirect STDOUT/STDIN to Network Connection in Container:3448315ac2834f28f611653e79764663","rule:Linux Kernel Module Injection Detected:41258ebe4f0565b8c3c1ddd96663c1a6","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","macro:sensitive_vol_mount:621cd5c512333ac20ba436785be6b179","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Change namespace privileges via unshare:1447a5e5cc069325af45954d0d349353","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa","macro:known_user_in_container:068a3f594dcb9921289b7525ef804824","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:jboss_in_container_writing_passwd:e104575a302efede918aaae611ba6fac","macro:etcd_manager_updating_dns:b7185f0f1766ee6887147bf0d00c4500","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017","rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3","macro:user_known_k8s_client_container_parens:2fdfd506ad251627b22d33c77dee9957","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81"],"type":"macro","hash":"5f0b6ebc4bea10285ba2b8a6ce78b863","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L300,L301","required_engine_version":"0.35.0","name":"container_started","macro":"container_started","condition":"((evt.type = container or\n (spawned_process and proc.vpid=1)) and\n container.image.repository != incomplete)\n","tags":null,"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017","rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49"],"type":"macro","hash":"9c5e39660ca4df75897d1230d8dbae77","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L306,L307","required_engine_version":"0.35.0","name":"cron_binaries","list":"cron_binaries","items":["anacron","cron","crond","crontab"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"list","hash":"6f1f66d014c874287d9333b0ee22b125","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Qualys seems to run a variety of shell subprocesses, at various\n# levels. This checks at a few levels without the cost of a full\n# proc.aname, which traverses the full parent hierarchy.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L312,L313","required_engine_version":"0.35.0","name":"run_by_qualys","macro":"run_by_qualys","condition":"(proc.pname=qualys-cloud-ag or\n proc.aname[2]=qualys-cloud-ag or\n proc.aname[3]=qualys-cloud-ag or\n proc.aname[4]=qualys-cloud-ag)\n","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"a778e5b0cc0d78490f59b07c87278a0f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L319,L320","required_engine_version":"0.35.0","name":"run_by_sumologic_securefiles","macro":"run_by_sumologic_securefiles","condition":"((proc.cmdline=\"usermod -a -G sumologic_collector\" or\n  proc.cmdline=\"groupadd sumologic_collector\") and\n (proc.pname=secureFiles.sh and proc.aexe[2] endswith java))\n","tags":null,"enabled":"true","used_by":["rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"7c02e7e682f4b70adfa6973fbca21120","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L325,L326","required_engine_version":"0.35.0","name":"run_by_yum","macro":"run_by_yum","condition":"((proc.pname=sh and proc.aname[2]=yum) or (proc.aname[2]=sh and proc.aname[3]=yum))","tags":null,"enabled":"true","used_by":["rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"3330026229d460e4080c1843ca1aef1a","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L329,L330","required_engine_version":"0.35.0","name":"run_by_ms_oms","macro":"run_by_ms_oms","condition":"(proc.aname[3] startswith omsagent- or\n proc.aname[3] startswith scx-)\n","tags":null,"enabled":"true","used_by":["rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"e1538843cd208c4f97c10b5ad2d3f7b9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L334,L335","required_engine_version":"0.35.0","name":"run_by_google_accounts_daemon","macro":"run_by_google_accounts_daemon","condition":"(proc.aname[1] startswith google_accounts or\n proc.aname[2] startswith google_accounts or\n proc.aname[3] startswith google_accounts)\n","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"d6ec884ac09a5dcfa8a67fa1a5232233","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L340,L341","required_engine_version":"0.35.0","name":"java_running_sdjagent","macro":"java_running_sdjagent","condition":"(proc.exe endswith java and proc.cmdline contains sdjagent.jar)","tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"macro","hash":"481dfc4260e33ac79bc9965859a6da56","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L343,L344","required_engine_version":"0.35.0","name":"kubelet_running_loopback","macro":"kubelet_running_loopback","condition":"(proc.pname=kubelet and proc.name=loopback)","tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"macro","hash":"d9fae580000bd7262c976a96da5ebcfa","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L346,L347","required_engine_version":"0.35.0","name":"rancher_agent","macro":"rancher_agent","condition":"(proc.name=agent and container.image.repository contains \"rancher/agent\")","tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"macro","hash":"7e51aa1b4e43b0fbcf3f497f19d31ee6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L349,L350","required_engine_version":"0.35.0","name":"rancher_network_manager","macro":"rancher_network_manager","condition":"(proc.name=rancher-bridge and container.image.repository contains \"rancher/network-manager\")","tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"macro","hash":"66300ea84d87d0be9404127579c110e8","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L352,L353","required_engine_version":"0.35.0","name":"exe_running_docker_save","macro":"exe_running_docker_save","condition":"(proc.name = \"exe\" and (proc.cmdline contains \"/var/lib/docker\" or proc.cmdline contains \"/var/run/docker\") and proc.pname in (dockerd, docker, dockerd-current, docker-current))\n","tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"3870d01b317a519c449ba80c75fa2386","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L359,L360","required_engine_version":"0.35.0","name":"user_ssh_directory","macro":"user_ssh_directory","condition":"(fd.name contains '/.ssh/' and fd.name glob '/home/*/.ssh/*')","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","macro:google_accounts_daemon_writing_ssh:2b6db0ba0430fd8423be766536193b3c","macro:cloud_init_writing_ssh:4bf6d26e36510c3b6e49059baad4d129","macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093"],"type":"macro","hash":"2cd1d449c2270b4de4a69a70a37f69fb","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# The rule below is disabled by default as many system management tools\n# like ansible, etc can read these files/paths. Enable it using this macro.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L364,L365","required_engine_version":"0.35.0","name":"user_known_read_ssh_information_activities","macro":"user_known_read_ssh_information_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2"],"type":"macro","hash":"66b9d639d9ffb5e4aec0837ef7b1a7f2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L367,L382","required_engine_version":"0.35.0","name":"Read ssh information","rule":"Read ssh information","condition":"(open_read or open_directory) \n and (user_ssh_directory or fd.name startswith /root/.ssh)\n and not user_known_read_ssh_information_activities \n and not proc.name in (ssh_binaries)\n","desc":"This rule identifies attempts to read files within ssh directories using programs that are not related to ssh. It's a simple and  versatile detection method that works well alongside more specific rules focused on sensitive file access. You have a couple of  options for using this rule effectively: you can adjust the specialized rules to cover all the important scenarios and ensure  precedence in rule smatching for those, or you can analyze the combined view of ssh-related file access across various rules on  your downstream computing platform. Just like with other rules, you can narrow down monitoring to specific processes, or you can  limit it to interactive access only.\n","output":"ssh-related file/directory read by non-ssh program (file=%fd.name pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_incubating","host","container","filesystem","mitre_collection","T1005"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:open_directory:33881afcd207d86e9ec883f45c4afaf7","list:ssh_binaries:ec2d0b20ba5fdce37cbef587b8e2675f","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_known_read_ssh_information_activities:66b9d639d9ffb5e4aec0837ef7b1a7f2","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb"],"type":"rule","hash":"f7e1f0c358b9f4fb13fdb68885cf19d2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L384,L385","required_engine_version":"0.35.0","name":"calico_node","macro":"calico_node","condition":"(container.image.repository endswith calico/node and proc.name=calico-node)","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"0c80dcb500a0a30309af5fd40e9971fa","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L387,L388","required_engine_version":"0.35.0","name":"postgres_running_wal_e","macro":"postgres_running_wal_e","condition":"(proc.pname=postgres and (proc.cmdline startswith \"sh -c envdir /etc/wal-e.d/env /usr/local/bin/wal-e\" or proc.cmdline startswith \"sh -c envdir \\\"/run/etc/wal-e.d/env\\\" wal-g wal-push\"))","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7"],"type":"macro","hash":"bd23433612d1f77cb9276c6da05b3775","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L390,L391","required_engine_version":"0.35.0","name":"user_known_db_spawned_processes","macro":"user_known_db_spawned_processes","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7"],"type":"macro","hash":"e9782b773c4c9b7a5b5c0c30a23a0662","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L393,L406","required_engine_version":"0.35.0","name":"DB program spawned process","rule":"DB program spawned process","condition":"spawned_process and proc.pname in (db_server_binaries) and not proc.name in (db_server_binaries) and not postgres_running_wal_e and not user_known_db_spawned_processes\n","desc":"A program related to the database server creates an unexpected child process (other than itself).  This is not supposed to happen and often follows SQL injection attacks. This behavioral detection could  indicate potential unauthorized data extraction or tampering with the database.\n","output":"Database-related program spawned process other than itself (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","process","database","mitre_execution","T1190"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:db_server_binaries:449619792d4c73357d92287273fbd164","macro:postgres_running_wal_e:bd23433612d1f77cb9276c6da05b3775","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:db_server_binaries:449619792d4c73357d92287273fbd164","macro:postgres_running_wal_e:bd23433612d1f77cb9276c6da05b3775","macro:user_known_db_spawned_processes:e9782b773c4c9b7a5b5c0c30a23a0662","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"a277852022c3734da76c948e8bfdfaf7","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This list allows for easy additions to the set of commands allowed\n# to change thread namespace without having to copy and override the\n# entire change thread namespace rule.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L411,L412","required_engine_version":"0.35.0","name":"user_known_change_thread_namespace_binaries","list":"user_known_change_thread_namespace_binaries","items":["crio","multus"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"list","hash":"81bcafda531d9f1dfde1778cbf5075c9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L414,L415","required_engine_version":"0.35.0","name":"user_known_change_thread_namespace_activities","macro":"user_known_change_thread_namespace_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"macro","hash":"be737247cfb371d8c20ef23aab8bed09","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L417,L418","required_engine_version":"0.35.0","name":"network_plugin_binaries","list":"network_plugin_binaries","items":["aws-cni","azure-vnet"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"list","hash":"37a3a58ec3693f0c7e18f036a325fd32","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L420,L421","required_engine_version":"0.35.0","name":"weaveworks_scope","macro":"weaveworks_scope","condition":"(container.image.repository endswith weaveworks/scope and proc.name=scope)","tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61"],"type":"macro","hash":"593789bc8dbc0fda3bb2ce089d50c87d","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L423,L447","required_engine_version":"0.35.0","name":"Change thread namespace","rule":"Change thread namespace","condition":"evt.type=setns and evt.dir=\u003c and proc_name_exists and not (container.id=host and proc.name in (docker_binaries, k8s_binaries, lxd_binaries, nsenter)) and not proc.name in (sysdigcloud_binaries, sysdig, calico, oci-umount, cilium-cni, network_plugin_binaries) and not proc.name in (user_known_change_thread_namespace_binaries) and not proc.name startswith \"runc\" and not proc.cmdline startswith \"containerd\" and not proc.pname in (sysdigcloud_binaries, hyperkube, kubelet, protokube, dockerd, tini, aws) and not java_running_sdjagent and not kubelet_running_loopback and not rancher_agent and not rancher_network_manager and not calico_node and not weaveworks_scope and not user_known_change_thread_namespace_activities\n","desc":"An attempt to alter the namespace of a process (often performed while creating a container) through the setns syscall.  Conversely, the same syscall setns is triggered when an unauthorized attempt is made to break out from the container  to the host, for example, when using commands like `nsenter --target 1` and similar ones. Recommending to profile your  environment and refine this rule for effective operationalization.\n","output":"Namespace change (setns) by unexpected program (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","process","mitre_privilege_escalation","T1611"],"enabled":"true","dependencies":["macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","macro:namespace:89801e9e98979062e84647433a8ed3e9","macro:node:36c4536996ca5615dcf9911f068786dc","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:sysdigcloud_binaries:5cd4a552978d2b6ed446f11f8a294cbf","list:k8s_binaries:52eba9972841f1a5acc644f595824d65","list:lxd_binaries:9f8fa9ebc7ba17e064657b840faf1603","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:java_running_sdjagent:481dfc4260e33ac79bc9965859a6da56","macro:kubelet_running_loopback:d9fae580000bd7262c976a96da5ebcfa","macro:rancher_agent:7e51aa1b4e43b0fbcf3f497f19d31ee6","macro:rancher_network_manager:66300ea84d87d0be9404127579c110e8","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa","list:user_known_change_thread_namespace_binaries:81bcafda531d9f1dfde1778cbf5075c9","macro:user_known_change_thread_namespace_activities:be737247cfb371d8c20ef23aab8bed09","list:network_plugin_binaries:37a3a58ec3693f0c7e18f036a325fd32","macro:weaveworks_scope:593789bc8dbc0fda3bb2ce089d50c87d","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:sysdigcloud_binaries:5cd4a552978d2b6ed446f11f8a294cbf","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85"],"type":"rule","hash":"bf53659328792edf3dcb3d50994a2d61","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L449,L461","required_engine_version":"0.35.0","name":"Change namespace privileges via unshare","rule":"Change namespace privileges via unshare","condition":"evt.type=unshare and evt.dir=\u003c  and container  and not thread.cap_permitted contains CAP_SYS_ADMIN\n","desc":"Unprivileged users in containers may not have CAP_SYS_ADMIN or other elevated privileges. However, they can   use the unshare system call with CLONE_NEWNS or CLONE_NEWUSER to create or clone a namespace or user with the  necessary privileges to conduct further attacks. It is best practice to block the unshare system call via  seccomp if it is not needed. Misuse of unshare can be related to misconfigured Kubernetes clusters, for example.\n","output":"Change namespace privileges via unshare (res=%evt.res evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","container","mitre_privilege_escalation","T1611"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"1447a5e5cc069325af45954d0d349353","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L463,L464","required_engine_version":"0.35.0","name":"allowed_openshift_registry_root","macro":"allowed_openshift_registry_root","condition":"(container.image.repository startswith openshift3/ or\n container.image.repository startswith registry.redhat.io/openshift3/ or\n container.image.repository startswith registry.access.redhat.com/openshift3/)\n","tags":null,"enabled":"true","used_by":["macro:openshift_image:a963c49d809c7db284d12a2020ad26b8"],"type":"macro","hash":"b04fbe421b78a0554e24531d1a85e225","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Source: https://docs.openshift.com/enterprise/3.2/install_config/install/disconnected_install.html","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L470,L471","required_engine_version":"0.35.0","name":"openshift_image","macro":"openshift_image","condition":"(allowed_openshift_registry_root and\n  (container.image.repository endswith /logging-deployment or\n   container.image.repository endswith /logging-elasticsearch or\n   container.image.repository endswith /logging-kibana or\n   container.image.repository endswith /logging-fluentd or\n   container.image.repository endswith /logging-auth-proxy or\n   container.image.repository endswith /metrics-deployer or\n   container.image.repository endswith /metrics-hawkular-metrics or\n   container.image.repository endswith /metrics-cassandra or\n   container.image.repository endswith /metrics-heapster or\n   container.image.repository endswith /ose-haproxy-router or\n   container.image.repository endswith /ose-deployer or\n   container.image.repository endswith /ose-sti-builder or\n   container.image.repository endswith /ose-docker-builder or\n   container.image.repository endswith /ose-pod or\n   container.image.repository endswith /ose-node or\n   container.image.repository endswith /ose-docker-registry or\n   container.image.repository endswith /prometheus-node-exporter or\n   container.image.repository endswith /image-inspector))\n","tags":null,"enabled":"true","dependencies":["macro:pod:dcc0caa97588ee058c2fcd764e5f919b","macro:deployment:06e5c0d0f9eabd9525e5f9dc4f6f37cf","macro:node:36c4536996ca5615dcf9911f068786dc","macro:allowed_openshift_registry_root:b04fbe421b78a0554e24531d1a85e225"],"used_by":["macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74"],"type":"macro","hash":"a963c49d809c7db284d12a2020ad26b8","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L492,L493","required_engine_version":"0.35.0","name":"redhat_io_images_privileged","list":"redhat_io_images_privileged","items":["registry.redhat.io/openshift-logging/fluentd-rhel8","registry.redhat.io/openshift4/ose-csi-node-driver-registrar","registry.redhat.io/openshift4/ose-kubernetes-nmstate-handler-rhel8","registry.redhat.io/openshift4/ose-local-storage-diskmaker"],"tags":null,"enabled":"true","used_by":["macro:redhat_image:ee4862446552668e30ad796f2ed876ea"],"type":"list","hash":"be84461c0b8a2d3d0f6c5df6d18c956b","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L495,L496","required_engine_version":"0.35.0","name":"redhat_image","macro":"redhat_image","condition":"(container.image.repository in (redhat_io_images_privileged))\n","tags":null,"enabled":"true","dependencies":["list:redhat_io_images_privileged:be84461c0b8a2d3d0f6c5df6d18c956b"],"used_by":["rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f"],"type":"macro","hash":"ee4862446552668e30ad796f2ed876ea","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# https://docs.aws.amazon.com/eks/latest/userguide/add-ons-images.html\n#  official AWS EKS registry list. AWS has different ECR repo per region","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L501,L502","required_engine_version":"0.35.0","name":"allowed_aws_ecr_registry_root_for_eks","macro":"allowed_aws_ecr_registry_root_for_eks","condition":"(container.image.repository startswith \"602401143452.dkr.ecr\" or\n container.image.repository startswith \"877085696533.dkr.ecr\" or\n container.image.repository startswith \"800184023465.dkr.ecr\" or\n container.image.repository startswith \"918309763551.dkr.ecr\" or\n container.image.repository startswith \"961992271922.dkr.ecr\" or\n container.image.repository startswith \"590381155156.dkr.ecr\" or\n container.image.repository startswith \"558608220178.dkr.ecr\" or\n container.image.repository startswith \"151742754352.dkr.ecr\" or\n container.image.repository startswith \"013241004608.dkr.ecr\")\n","tags":null,"enabled":"true","used_by":["macro:aws_eks_core_images:6146df7a3c8fbe8fc4d8439f3675a6ce","macro:aws_eks_image_sensitive_mount:3608173c8035e2501d82c68d9c1fd252"],"type":"macro","hash":"1a39a8e2c5b37345d398dcc5754b18b6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L513,L514","required_engine_version":"0.35.0","name":"aws_eks_core_images","macro":"aws_eks_core_images","condition":"(allowed_aws_ecr_registry_root_for_eks and (container.image.repository endswith \".amazonaws.com/amazon-k8s-cni\" or\n container.image.repository endswith \".amazonaws.com/eks/kube-proxy\"))\n","tags":null,"enabled":"true","dependencies":["macro:allowed_aws_ecr_registry_root_for_eks:1a39a8e2c5b37345d398dcc5754b18b6","macro:allowed_aws_ecr_registry_root_for_eks:1a39a8e2c5b37345d398dcc5754b18b6"],"used_by":["macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74"],"type":"macro","hash":"6146df7a3c8fbe8fc4d8439f3675a6ce","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# These images are allowed both to run with --privileged and to mount\n# sensitive paths from the host filesystem.\n#\n# NOTE: This list is only provided for backwards compatibility with\n# older local falco rules files that may have been appending to\n# trusted_images. To make customizations, it's better to add images to\n# either privileged_images or falco_sensitive_mount_images.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L526,L527","required_engine_version":"0.35.0","name":"trusted_images","list":"trusted_images","tags":null,"enabled":"true","used_by":["rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","rule:Detect outbound connections to common miner pool ports:3f01c102c6d26af968d5eb6b6777085d"],"type":"list","hash":"b8b0db0ef4ed293fcc7d4192f53599fa","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to specify additional containers that are\n# trusted and therefore allowed to run privileged *and* with sensitive\n# mounts.\n#\n# Like trusted_images, this is deprecated in favor of\n# user_privileged_containers and user_sensitive_mount_containers and\n# is only provided for backwards compatibility.\n#\n# In this file, it just takes one of the images in trusted_containers\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L540,L541","required_engine_version":"0.35.0","name":"user_trusted_containers","macro":"user_trusted_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9"],"type":"macro","hash":"83dc258d4e778da799e1d75b6582f967","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L543,L544","required_engine_version":"0.35.0","name":"sematext_images","list":"sematext_images","items":["docker.io/sematext/sematext-agent-docker","docker.io/sematext/agent","docker.io/sematext/logagent","registry.access.redhat.com/sematext/sematext-agent-docker","registry.access.redhat.com/sematext/agent","registry.access.redhat.com/sematext/logagent"],"tags":null,"enabled":"true","type":"list","hash":"af95e235bec59a2fb0ccb358794c7980","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Falco containers","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L550,L552","required_engine_version":"0.35.0","name":"falco_containers","list":"falco_containers","items":["falcosecurity/falco","docker.io/falcosecurity/falco","public.ecr.aws/falcosecurity/falco","falcosecurity/falco-no-driver","docker.io/falcosecurity/falco-no-driver","public.ecr.aws/falcosecurity/falco-no-driver"],"tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3"],"type":"list","hash":"88616fd0dac29b81cc6b368ce116b9f4","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# These container images are allowed to run with --privileged and full set of capabilities","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L562,L563","required_engine_version":"0.35.0","name":"falco_privileged_images","list":"falco_privileged_images","items":["falco_containers","docker.io/calico/node","calico/node","docker.io/cloudnativelabs/kube-router","docker.io/docker/ucp-agent","docker.io/mesosphere/mesos-slave","docker.io/rook/toolbox","docker.io/sysdig/sysdig","gcr.io/google_containers/kube-proxy","gcr.io/google-containers/startup-script","gcr.io/projectcalico-org/node","gke.gcr.io/kube-proxy","gke.gcr.io/gke-metadata-server","gke.gcr.io/netd-amd64","gke.gcr.io/watcher-daemonset","gcr.io/google-containers/prometheus-to-sd","registry.k8s.io/ip-masq-agent-amd64","registry.k8s.io/kube-proxy","registry.k8s.io/prometheus-to-sd","quay.io/calico/node","sysdig/sysdig","sematext_images","registry.k8s.io/dns/k8s-dns-node-cache","mcr.microsoft.com/oss/kubernetes/kube-proxy"],"tags":null,"enabled":"true","used_by":["rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74"],"type":"list","hash":"fcbbd9234536bd53a20eb8d98e3fd443","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L590,L591","required_engine_version":"0.35.0","name":"falco_privileged_containers","macro":"falco_privileged_containers","condition":"(openshift_image or user_trusted_containers or aws_eks_core_images or container.image.repository in (trusted_images) or container.image.repository in (falco_privileged_images) or container.image.repository startswith istio/proxy_ or container.image.repository startswith quay.io/sysdig/)","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","list:falco_privileged_images:fcbbd9234536bd53a20eb8d98e3fd443","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:openshift_image:a963c49d809c7db284d12a2020ad26b8","macro:aws_eks_core_images:6146df7a3c8fbe8fc4d8439f3675a6ce","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","list:falco_privileged_images:fcbbd9234536bd53a20eb8d98e3fd443","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967"],"used_by":["rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa"],"type":"macro","hash":"9b4ba98f48c4031d87b99b489d62ca74","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to specify additional containers that are\n# allowed to run privileged\n#\n# In this file, it just takes one of the images in falco_privileged_images\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L605,L606","required_engine_version":"0.35.0","name":"user_privileged_containers","macro":"user_privileged_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa"],"type":"macro","hash":"605f400a686e1bec4f1e18414be552c5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L608,L623","required_engine_version":"0.35.0","name":"Launch Privileged Container","rule":"Launch Privileged Container","condition":"container_started  and container and container.privileged=true and not falco_privileged_containers and not user_privileged_containers and not redhat_image\n","desc":"Detect the initial process initiation within a privileged container, with exemptions for known and trusted images.  This rule primarily serves as an excellent auditing mechanism since highly privileged containers, when compromised,  can result in significant harm. For instance, if another rule triggers within such a privileged container, it could be  seen as more suspicious, prompting a closer inspection.\n","output":"Privileged container started (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_incubating","container","cis","mitre_execution","T1610","PCI_DSS_10.2.5"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:redhat_image:ee4862446552668e30ad796f2ed876ea","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:user_privileged_containers:605f400a686e1bec4f1e18414be552c5","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77"],"type":"rule","hash":"b2519a12fb87e0645a80043bd931f62f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# These capabilities were used in the past to escape from containers","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L626,L627","required_engine_version":"0.35.0","name":"excessively_capable_container","macro":"excessively_capable_container","condition":"(thread.cap_permitted contains CAP_SYS_ADMIN or thread.cap_permitted contains CAP_SYS_MODULE or thread.cap_permitted contains CAP_SYS_RAWIO or thread.cap_permitted contains CAP_SYS_PTRACE or thread.cap_permitted contains CAP_SYS_BOOT or thread.cap_permitted contains CAP_SYSLOG or thread.cap_permitted contains CAP_DAC_READ_SEARCH or thread.cap_permitted contains CAP_NET_ADMIN or thread.cap_permitted contains CAP_BPF)\n","tags":null,"enabled":"true","used_by":["rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa"],"type":"macro","hash":"a1f7d15b202929110c11b13583fe0dcf","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L638,L652","required_engine_version":"0.35.0","name":"Launch Excessively Capable Container","rule":"Launch Excessively Capable Container","condition":"container_started  and container and excessively_capable_container and not falco_privileged_containers and not user_privileged_containers\n","desc":"Identify containers that start with a powerful set of capabilities, with exceptions for recognized trusted images.  Similar to the \"Launch Privileged Container\" rule, this functions as a robust auditing rule. Compromised highly privileged  containers can lead to substantial harm. For instance, if another rule is triggered within such a container, it might  raise suspicion, prompting closer scrutiny.\n","output":"Excessively capable container started (cap_permitted=%thread.cap_permitted evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_incubating","container","cis","mitre_execution","T1610"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:user_privileged_containers:605f400a686e1bec4f1e18414be552c5","macro:excessively_capable_container:a1f7d15b202929110c11b13583fe0dcf","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77"],"type":"rule","hash":"8091ae198eef3f103d229b04597684aa","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L654,L655","required_engine_version":"0.35.0","name":"login_doing_dns_lookup","macro":"login_doing_dns_lookup","condition":"(proc.name=login and fd.l4proto=udp and fd.sport=53)","tags":null,"enabled":"true","used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55"],"type":"macro","hash":"4ec383ddc1264ee9f9b1170dbd2318a5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# sockfamily ip is to exclude certain processes (like 'groups') that communicate on unix-domain sockets\n# systemd can listen on ports to launch things like sshd on demand","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L659,L673","required_engine_version":"0.35.0","name":"System procs network activity","rule":"System procs network activity","condition":"inbound_outbound and fd.sockfamily = ip  and (system_procs or proc.name in (shell_binaries)) and not proc.name in (known_system_procs_network_activity_binaries) and not login_doing_dns_lookup and not user_expected_system_procs_network_activity_conditions\n","desc":"Detect any unexpected network activity performed by system binaries that typically shouldn't perform network activity, including  coreutils binaries (like sleep, mkdir, who, date, and others) or user management binaries (such as login, systemd, usermod, deluser,  adduser, chpasswd, and others). This serves as a valuable baseline detection for network-related activities.\n","output":"Known system binary sent/received network traffic (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:outbound:b5229dfdd9136d1c772f9070f3095016","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:system_procs:1626c650eb514b1780d01d83b1609b2f","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:login_doing_dns_lookup:4ec383ddc1264ee9f9b1170dbd2318a5","list:known_system_procs_network_activity_binaries:872a8f7e7638b9af9a7cbef871e3df37","macro:user_expected_system_procs_network_activity_conditions:2c633a138f025b38353d5ed0477bfd72","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921"],"type":"rule","hash":"ebe3e03115e4eb21a30e0e5b9e6a9f55","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This list allows easily whitelisting system proc names that are\n# expected to communicate on the network.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L677,L678","required_engine_version":"0.35.0","name":"known_system_procs_network_activity_binaries","list":"known_system_procs_network_activity_binaries","items":["systemd","hostid","id"],"tags":null,"enabled":"true","used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55"],"type":"list","hash":"872a8f7e7638b9af9a7cbef871e3df37","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This macro allows specifying conditions under which a system binary\n# is allowed to communicate on the network. For instance, only specific\n# proc.cmdline values could be allowed to be more granular in what is\n# allowed.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L684,L685","required_engine_version":"0.35.0","name":"user_expected_system_procs_network_activity_conditions","macro":"user_expected_system_procs_network_activity_conditions","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55"],"type":"macro","hash":"2c633a138f025b38353d5ed0477bfd72","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# When filled in, this should look something like:\n# (proc.env contains \"HTTP_PROXY=http://my.http.proxy.com \")\n# The trailing space is intentional so avoid matching on prefixes of\n# the actual proxy.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L691,L692","required_engine_version":"0.35.0","name":"allowed_ssh_proxy_env","macro":"allowed_ssh_proxy_env","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Program run with disallowed http proxy env:cf0f7f713bd9ca1baa7ef93da5ca1a3a"],"type":"macro","hash":"ee1096508e1dd9b7b7b2a990d6fd1cb5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L694,L695","required_engine_version":"0.35.0","name":"http_proxy_binaries","list":"http_proxy_binaries","items":["curl","wget"],"tags":null,"enabled":"true","used_by":["macro:http_proxy_procs:c4c640cf1bae6ee65b169fa54dc8639b"],"type":"list","hash":"f82dd7ac4cd57f3212ea031a63900282","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L697,L698","required_engine_version":"0.35.0","name":"http_proxy_procs","macro":"http_proxy_procs","condition":"(proc.name in (http_proxy_binaries))","tags":null,"enabled":"true","dependencies":["list:http_proxy_binaries:f82dd7ac4cd57f3212ea031a63900282"],"used_by":["rule:Program run with disallowed http proxy env:cf0f7f713bd9ca1baa7ef93da5ca1a3a"],"type":"macro","hash":"c4c640cf1bae6ee65b169fa54dc8639b","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L700,L712","required_engine_version":"0.35.0","name":"Program run with disallowed http proxy env","rule":"Program run with disallowed http proxy env","condition":"spawned_process  and http_proxy_procs  and proc.env icontains HTTP_PROXY and not allowed_ssh_proxy_env \n","desc":"Detect curl or wget usage with HTTP_PROXY environment variable. Attackers can manipulate the HTTP_PROXY variable's  value to redirect application's internal HTTP requests. This could expose sensitive information like authentication  keys and private data.\n","output":"Curl or wget run with disallowed HTTP_PROXY environment variable (env=%proc.env evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","users","mitre_execution","T1204"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:allowed_ssh_proxy_env:ee1096508e1dd9b7b7b2a990d6fd1cb5","macro:http_proxy_procs:c4c640cf1bae6ee65b169fa54dc8639b","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"cf0f7f713bd9ca1baa7ef93da5ca1a3a","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L714,L715","required_engine_version":"0.35.0","name":"openvpn_udp_ports","list":"openvpn_udp_ports","items":["1194","1197","1198","8080","9201"],"tags":null,"enabled":"true","type":"list","hash":"74086f962ebd87e799e99d11027b7888","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L717,L718","required_engine_version":"0.35.0","name":"l2tp_udp_ports","list":"l2tp_udp_ports","items":["500","1701","4500","10000"],"tags":null,"enabled":"true","type":"list","hash":"fb379d7ea4c252e5453e85fe69596a5e","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L720,L721","required_engine_version":"0.35.0","name":"statsd_ports","list":"statsd_ports","items":["8125"],"tags":null,"enabled":"true","type":"list","hash":"e230e33cc81c6b6ff638b306a49783e5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L723,L724","required_engine_version":"0.35.0","name":"ntp_ports","list":"ntp_ports","items":["123"],"tags":null,"enabled":"true","type":"list","hash":"bb4526d158554aa5a89bb22f202fc010","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Some applications will connect a udp socket to an address only to\n# test connectivity. Assuming the udp connect works, they will follow\n# up with a tcp connect that actually sends/receives data.\n#\n# With that in mind, we listed a few commonly seen ports here to avoid\n# some false positives. In addition, we make the main rule opt-in, so\n# it's disabled by default.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L733,L734","required_engine_version":"0.35.0","name":"test_connect_ports","list":"test_connect_ports","items":["0","9","80","3306"],"tags":null,"enabled":"true","type":"list","hash":"e6316d75c3531f3b22985f6269d93bb9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L736,L737","required_engine_version":"0.35.0","name":"expected_udp_ports","list":"expected_udp_ports","items":["53","openvpn_udp_ports","l2tp_udp_ports","statsd_ports","ntp_ports","test_connect_ports"],"tags":null,"enabled":"true","used_by":["macro:expected_udp_traffic:2b8e0588e46f360f53357e053067721c"],"type":"list","hash":"c7b8ee7c0e71391f22c791e8dde1d862","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L739,L740","required_engine_version":"0.35.0","name":"expected_udp_traffic","macro":"expected_udp_traffic","condition":"fd.port in (expected_udp_ports)","tags":null,"enabled":"true","dependencies":["list:expected_udp_ports:c7b8ee7c0e71391f22c791e8dde1d862"],"used_by":["rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b"],"type":"macro","hash":"2b8e0588e46f360f53357e053067721c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L742,L752","required_engine_version":"0.35.0","name":"Unexpected UDP Traffic","rule":"Unexpected UDP Traffic","condition":"inbound_outbound  and fd.l4proto=udp  and not expected_udp_traffic\n","desc":"Detecting UDP traffic on ports other than 53 (DNS) or other commonly used ports. Misusing UDP is a known TTP among attackers.  Monitoring unusual network activity is highly valuable but often generates significant noise, as is the case with this detection.\n","output":"Unexpected UDP Traffic Seen (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","network","mitre_exfiltration","TA0011"],"enabled":"true","dependencies":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:expected_udp_traffic:2b8e0588e46f360f53357e053067721c","macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921"],"type":"rule","hash":"c56289ee4fb60625edda0baff211e42b","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L754,L755","required_engine_version":"0.35.0","name":"somebody_becoming_themselves","macro":"somebody_becoming_themselves","condition":"((user.name=nobody and evt.arg.uid=nobody) or (user.name=www-data and evt.arg.uid=www-data) or (user.name=_apt and evt.arg.uid=_apt) or (user.name=postfix and evt.arg.uid=postfix) or (user.name=pki-agent and evt.arg.uid=pki-agent) or (user.name=pki-acme and evt.arg.uid=pki-acme) or (user.name=nfsnobody and evt.arg.uid=nfsnobody) or (user.name=postgres and evt.arg.uid=postgres))","tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"macro","hash":"53b9917c91d239d157d82b5c523da5f1","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L764,L765","required_engine_version":"0.35.0","name":"nrpe_becoming_nagios","macro":"nrpe_becoming_nagios","condition":"(proc.name=nrpe and evt.arg.uid=nagios)","tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"macro","hash":"a79dae27b88ba7d262d9b30e322d3966","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# In containers, the user name might be for a uid that exists in the\n# container but not on the host. (See\n# https://github.com/draios/sysdig/issues/954). So in that case, allow\n# a setuid.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L771,L772","required_engine_version":"0.35.0","name":"known_user_in_container","macro":"known_user_in_container","condition":"(container and not user.name in (\"\u003cNA\u003e\",\"N/A\",\"\"))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"macro","hash":"068a3f594dcb9921289b7525ef804824","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to allow for specific combinations of\n# programs changing users by calling setuid.\n#\n# In this file, it just takes one of the condition in the base macro\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L780,L781","required_engine_version":"0.35.0","name":"user_known_non_sudo_setuid_conditions","macro":"user_known_non_sudo_setuid_conditions","condition":"(user.name=root)","tags":null,"enabled":"true","used_by":["rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63"],"type":"macro","hash":"43d8501f711476de13c5ec689c6786ec","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# sshd, mail programs attempt to setuid to root even when running as non-root. Excluding here to avoid meaningless FPs","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L784,L804","required_engine_version":"0.35.0","name":"Non sudo setuid","rule":"Non sudo setuid","condition":"evt.type=setuid and evt.dir=\u003e and (known_user_in_container or not container) and not (user.name=root or user.uid=0) and not somebody_becoming_themselves and not proc.name in (known_setuid_binaries, userexec_binaries, mail_binaries, docker_binaries,\n                      nomachine_binaries)\nand not proc.name startswith \"runc:\" and not java_running_sdjagent and not nrpe_becoming_nagios and not user_known_non_sudo_setuid_conditions\n","desc":"Detect attempts to change users through the use of setuid, with exceptions for sudo/su.  The users \"root\" and \"nobody\" using setuid on themselves are also excluded, as setuid calls in these cases  typically involve reducing privileges. By setting the setuid bit, an attacker could execute code in a  different user's context, potentially with higher privileges. One drawback is the potential for noise,  as many applications legitimately use this approach.\n","output":"Unexpected setuid call by non-sudo, non-root program (arg_uid=%evt.arg.uid evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","users","mitre_privilege_escalation","T1548.001"],"enabled":"true","dependencies":["list:userexec_binaries:a565f19993c396a912312fc67ef23f02","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_binaries:e80bc600472c458a1eb834ef6cc3608d","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:userexec_binaries:a565f19993c396a912312fc67ef23f02","list:known_setuid_binaries:6bcf294bfeb0e3ca956e1278b8c1d47d","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_binaries:e80bc600472c458a1eb834ef6cc3608d","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:java_running_sdjagent:481dfc4260e33ac79bc9965859a6da56","macro:somebody_becoming_themselves:53b9917c91d239d157d82b5c523da5f1","macro:nrpe_becoming_nagios:a79dae27b88ba7d262d9b30e322d3966","macro:known_user_in_container:068a3f594dcb9921289b7525ef804824","macro:user_known_non_sudo_setuid_conditions:43d8501f711476de13c5ec689c6786ec","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85"],"type":"rule","hash":"7da3924afff60ec8eb7c45c5fd3fda63","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L806,L807","required_engine_version":"0.35.0","name":"user_known_user_management_activities","macro":"user_known_user_management_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"23d1a029d115829da2c3d05ddc8ba459","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L809,L810","required_engine_version":"0.35.0","name":"chage_list","macro":"chage_list","condition":"(proc.name=chage and (proc.cmdline contains \"-l\" or proc.cmdline contains \"--list\"))","tags":null,"enabled":"true","used_by":["rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898"],"type":"macro","hash":"3620a9867e0c290eb629656c08a77cba","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L812,L836","required_engine_version":"0.35.0","name":"User mgmt binaries","rule":"User mgmt binaries","condition":"spawned_process  and not container and proc.name in (user_mgmt_binaries)  and not proc.name in (su, sudo, lastlog, nologin, unix_chkpwd)   and not proc.pname in (cron_binaries, systemd, systemd.postins, udev.postinst, run-parts) and not proc.cmdline startswith \"passwd -S\"  and not proc.cmdline startswith \"useradd -D\"  and not proc.cmdline startswith \"systemd --version\"  and not run_by_qualys  and not run_by_sumologic_securefiles  and not run_by_yum  and not run_by_ms_oms  and not run_by_google_accounts_daemon  and not chage_list  and not user_known_user_management_activities\n","desc":"Detect activity by any programs that can manage users, passwords, or permissions (such as login, systemd, usermod, deluser, adduser,  chpasswd, and others). sudo and su are excluded. Activity in containers is also excluded -- some containers create custom users on  top of a base linux distribution at startup. Some innocuous command lines that don't actually change anything are excluded. You might  want to consider applying this rule to container actions as well.\n","output":"User management binary command run outside of container (gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","users","software_mgmt","mitre_persistence","T1098"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","macro:run_by_qualys:a778e5b0cc0d78490f59b07c87278a0f","macro:run_by_google_accounts_daemon:d6ec884ac09a5dcfa8a67fa1a5232233","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:user_mgmt_binaries:2b8476e193b6319359b8500841101a95","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:cron_binaries:6f1f66d014c874287d9333b0ee22b125","macro:run_by_qualys:a778e5b0cc0d78490f59b07c87278a0f","macro:run_by_sumologic_securefiles:7c02e7e682f4b70adfa6973fbca21120","macro:run_by_yum:3330026229d460e4080c1843ca1aef1a","macro:run_by_ms_oms:e1538843cd208c4f97c10b5ad2d3f7b9","macro:run_by_google_accounts_daemon:d6ec884ac09a5dcfa8a67fa1a5232233","macro:user_known_user_management_activities:23d1a029d115829da2c3d05ddc8ba459","macro:chage_list:3620a9867e0c290eb629656c08a77cba","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"64fa846d6a699ae484ef6dd7e3cea898","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L838,L839","required_engine_version":"0.35.0","name":"allowed_dev_files","list":"allowed_dev_files","items":["/dev/null","/dev/stdin","/dev/stdout","/dev/stderr","/dev/random","/dev/urandom","/dev/console","/dev/kmsg"],"tags":null,"enabled":"true","used_by":["rule:Create files below dev:c1ac5692e9c9d8be0dd8c387ee3fe192"],"type":"list","hash":"3273e4d6d4cec7471933423b256c70c8","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L844,L845","required_engine_version":"0.35.0","name":"user_known_create_files_below_dev_activities","macro":"user_known_create_files_below_dev_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Create files below dev:c1ac5692e9c9d8be0dd8c387ee3fe192"],"type":"macro","hash":"e252bfb734f01b620917e7724e620572","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# (we may need to add additional checks against false positives, see:\n# https://bugs.launchpad.net/ubuntu/+source/rkhunter/+bug/86153)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L849,L864","required_engine_version":"0.35.0","name":"Create files below dev","rule":"Create files below dev","condition":"(evt.type = creat or (evt.type in (open,openat,openat2))) and evt.arg.flags contains O_CREAT and fd.directory = /dev and not proc.name in (dev_creation_binaries) and not fd.name in (allowed_dev_files) and not fd.name startswith /dev/tty and not user_known_create_files_below_dev_activities\n","desc":"Detect the creation of files under /dev except for authorized device management programs. This can reveal rootkits hiding  files in /dev. Additionally, consider the \"Execution from /dev/shm\" rule. The upstream rule already covers some tuning  scenarios that you can further expand upon.\n","output":"File created below /dev by untrusted program (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_incubating","host","filesystem","mitre_persistence","T1543"],"enabled":"true","dependencies":["list:dev_creation_binaries:2de5fcfae70913478022a9d4bd879f48","list:allowed_dev_files:3273e4d6d4cec7471933423b256c70c8","macro:user_known_create_files_below_dev_activities:e252bfb734f01b620917e7724e620572","list:dev_creation_binaries:2de5fcfae70913478022a9d4bd879f48"],"type":"rule","hash":"c1ac5692e9c9d8be0dd8c387ee3fe192","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# In a local/user rules file, you could override this macro to\n# explicitly enumerate the container images that you want to allow\n# access to EC2 metadata. In this main falco rules file, there isn't\n# any way to know all the containers that should have access, so any\n# container is allowed, by repeating the \"container\" macro. In the\n# overridden macro, the condition would look something like\n# (container.image.repository = vendor/container-1 or\n# container.image.repository = vendor/container-2 or ...)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L874,L875","required_engine_version":"0.35.0","name":"ec2_metadata_containers","macro":"ec2_metadata_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802"],"type":"macro","hash":"d5f0dfcd1bb7ef57fab8910ab3796682","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# On EC2 instances, 169.254.169.254 is a special IP used to fetch\n# metadata about the instance. It may be desirable to prevent access\n# to this IP from containers.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L880,L891","required_engine_version":"0.35.0","name":"Contact EC2 Instance Metadata Service From Container","rule":"Contact EC2 Instance Metadata Service From Container","condition":"outbound  and container and fd.sip=\"169.254.169.254\"  and not ec2_metadata_containers\n","desc":"Detects attempts to communicate with the EC2 Instance Metadata Service from a container. This detection is narrowly focused  and might not apply to your environment. In addition, it could generate noise and require fine-tuning.\n","output":"Outbound connection to EC2 instance metadata service (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","network","aws","container","mitre_credential_access","T1552.005"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:ec2_metadata_containers:d5f0dfcd1bb7ef57fab8910ab3796682","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"ba11587ae5bd52a9b3873b053ab19802","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This rule is not enabled by default, since this rule is for cloud environment(GCP, AWS and Azure) only.\n# You can filter the container that you want to allow access to metadata by overwriting user_known_metadata_access macro.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L895,L896","required_engine_version":"0.35.0","name":"user_known_metadata_access","macro":"user_known_metadata_access","condition":"(k8s.ns.name = \"kube-system\")","tags":null,"enabled":"true","used_by":["rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d"],"type":"macro","hash":"5b070721f88bcb46c40f824af16d98e0","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# On GCP, AWS and Azure, 169.254.169.254 is a special IP used to fetch\n# metadata about the instance. The metadata could be used to get credentials by attackers.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L900,L912","required_engine_version":"0.35.0","name":"Contact cloud metadata service from container","rule":"Contact cloud metadata service from container","condition":"outbound  and container  and fd.sip=\"169.254.169.254\"  and not user_known_metadata_access\n","desc":"Detects attempts to communicate with the Cloud Instance Metadata Service from a container. This detection is narrowly focused  and might not apply to your environment. In addition, it could generate noise and require fine-tuning.\n","output":"Outbound connection to cloud instance metadata service (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","network","container","mitre_discovery","T1565"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:user_known_metadata_access:5b070721f88bcb46c40f824af16d98e0","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"8fb7d622c5da0bd431e4d6d7f7da0f9d","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L914,L915","required_engine_version":"0.35.0","name":"network_tool_binaries","list":"network_tool_binaries","items":["nc","ncat","netcat","nmap","dig","tcpdump","tshark","ngrep","telnet","mitmproxy","socat","zmap"],"tags":null,"enabled":"true","used_by":["macro:network_tool_procs:db06ef4151497e9915daaf22f822d822"],"type":"list","hash":"82c1be67dccdbeb9cb00de9c4d6e0a35","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L917,L918","required_engine_version":"0.35.0","name":"network_tool_procs","macro":"network_tool_procs","condition":"(proc.name in (network_tool_binaries))","tags":null,"enabled":"true","dependencies":["list:network_tool_binaries:82c1be67dccdbeb9cb00de9c4d6e0a35"],"used_by":["rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553"],"type":"macro","hash":"db06ef4151497e9915daaf22f822d822","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# In a local/user rules file, create a condition that matches legitimate uses\n# of a package management process inside a container.\n#\n# For example:\n# - macro: user_known_package_manager_in_container\n#   condition: proc.cmdline=\"dpkg -l\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L926,L927","required_engine_version":"0.35.0","name":"user_known_package_manager_in_container","macro":"user_known_package_manager_in_container","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f"],"type":"macro","hash":"e9db6635f0430b51de8b303990f927a7","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Container is supposed to be immutable. Package management should be done in building the image.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L930,L931","required_engine_version":"0.35.0","name":"pkg_mgmt_in_kube_proxy","macro":"pkg_mgmt_in_kube_proxy","condition":"(proc.cmdline startswith \"update-alternat\" and container.image.repository = \"registry.k8s.io/kube-proxy\")\n","tags":null,"enabled":"true","used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f"],"type":"macro","hash":"14d98ae1880c2d677a202e5c576bf15a","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L935,L951","required_engine_version":"0.35.0","name":"Launch Package Management Process in Container","rule":"Launch Package Management Process in Container","condition":"spawned_process and container and user.name != \"_apt\" and package_mgmt_procs and not package_mgmt_ancestor_procs and not user_known_package_manager_in_container and not pkg_mgmt_in_kube_proxy\n","desc":"Detect package management processes executed within containers. An excellent auditing rule to monitor general drifts  in containers. Particularly useful for newer rules like \"Drop and execute new binary in container\" during incident  response investigations. This helps identify common anti-patterns of ad-hoc debugging. Simultaneously, to maintain  optimal hygiene, it's recommended to prevent container drifts and instead opt for redeploying new containers.\n","output":"Package management process launched in container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_incubating","container","process","software_mgmt","mitre_persistence","T1505"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:user_known_package_manager_in_container:e9db6635f0430b51de8b303990f927a7","macro:pkg_mgmt_in_kube_proxy:14d98ae1880c2d677a202e5c576bf15a","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"2acaeee8988b0854328b0fbe8c9cf63f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L953,L954","required_engine_version":"0.35.0","name":"user_known_network_tool_activities","macro":"user_known_network_tool_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553"],"type":"macro","hash":"9b807c4e0d8ba042426b117cdced8023","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L956,L968","required_engine_version":"0.35.0","name":"Launch Suspicious Network Tool in Container","rule":"Launch Suspicious Network Tool in Container","condition":"spawned_process  and container  and network_tool_procs  and not user_known_network_tool_activities\n","desc":"Detect network tools (like netcat, nmap, tcpdump, socat, and more) launched within containers without any additional filters.  This serves as a valuable general detection, but it's recommended to invest engineering effort to fine-tune it and prevent a  high volume of legitimate logs. This rule complements the more specific \"Netcat Remote Code Execution in Container\" rule.\n","output":"Network tool launched in container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","container","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:network_tool_procs:db06ef4151497e9915daaf22f822d822","macro:user_known_network_tool_activities:9b807c4e0d8ba042426b117cdced8023","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"40dd680345890489ed62556af30c3fb2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L970,L982","required_engine_version":"0.35.0","name":"Launch Suspicious Network Tool on Host","rule":"Launch Suspicious Network Tool on Host","condition":"spawned_process  and not container  and network_tool_procs  and not user_known_network_tool_activities\n","desc":"Detect network tools (like netcat, nmap, tcpdump, socat, and more) launched within containers without any additional filters.  This serves as a valuable general detection, but it's recommended to invest engineering effort to fine-tune it and prevent a  high volume of legitimate logs. The host equivalent of \"Launch Suspicious Network Tool in Container.\".\n","output":"Network tool launched on host (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","network","process","mitre_execution","T1059"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:network_tool_procs:db06ef4151497e9915daaf22f822d822","macro:user_known_network_tool_activities:9b807c4e0d8ba042426b117cdced8023","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"d37b5ddbe83eb9c31c805ae5973d2553","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# here `ash_history` will match both `bash_history` and `ash_history`","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L985,L986","required_engine_version":"0.35.0","name":"modify_shell_history","macro":"modify_shell_history","condition":"(modify and (\n  evt.arg.name endswith \"ash_history\" or\n  evt.arg.name endswith \"zsh_history\" or\n  evt.arg.name contains \"fish_read_history\" or\n  evt.arg.name endswith \"fish_history\" or\n  evt.arg.oldpath endswith \"ash_history\" or\n  evt.arg.oldpath endswith \"zsh_history\" or\n  evt.arg.oldpath contains \"fish_read_history\" or\n  evt.arg.oldpath endswith \"fish_history\" or\n  evt.arg.path endswith \"ash_history\" or\n  evt.arg.path endswith \"zsh_history\" or\n  evt.arg.path contains \"fish_read_history\" or\n  evt.arg.path endswith \"fish_history\"))\n","tags":null,"enabled":"true","dependencies":["macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a"],"used_by":["rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc"],"type":"macro","hash":"a4caae82528f2d3e827266ba74a3e115","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# here `ash_history` will match both `bash_history` and `ash_history`","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1002,L1003","required_engine_version":"0.35.0","name":"truncate_shell_history","macro":"truncate_shell_history","condition":"(open_write and (\n  fd.name endswith \"ash_history\" or\n  fd.name endswith \"zsh_history\" or\n  fd.name contains \"fish_read_history\" or\n  fd.name endswith \"fish_history\") and evt.arg.flags contains \"O_TRUNC\")\n","tags":null,"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda"],"used_by":["rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc"],"type":"macro","hash":"ac78bdcd5d832a2f504b6e3ce03a6868","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1010,L1011","required_engine_version":"0.35.0","name":"var_lib_docker_filepath","macro":"var_lib_docker_filepath","condition":"(evt.arg.name startswith /var/lib/docker or fd.name startswith /var/lib/docker)","tags":null,"enabled":"true","used_by":["rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc"],"type":"macro","hash":"2fd28acdc459f5aabd676b4cae7ae123","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# todo!: the usage of `evt.arg*` filter check in the output should be avoided\n# when more than one event type is involved because some event will populate\n# the filtercheck and others will always return \u003cNA\u003e. It would be better to use\n# a more generic filter like `fs.path.*`","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1017,L1029","required_engine_version":"0.35.0","name":"Delete or rename shell history","rule":"Delete or rename shell history","condition":"(modify_shell_history or truncate_shell_history)  and not var_lib_docker_filepath  and not proc.name in (docker_binaries)\n","desc":"Detect shell history deletion, frequently used by unsophisticated adversaries to eliminate evidence.  Note that it can also trigger when exiting a Terminal shell, such as with `kubectl exec`, which  may introduce some noise.\n","output":"Shell history deleted or renamed (file=%fd.name name=%evt.arg.name path=%evt.arg.path oldpath=%evt.arg.oldpath evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","host","container","process","filesystem","mitre_defense_evasion","T1070"],"enabled":"true","dependencies":["list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify_shell_history:a4caae82528f2d3e827266ba74a3e115","macro:truncate_shell_history:ac78bdcd5d832a2f504b6e3ce03a6868","macro:var_lib_docker_filepath:2fd28acdc459f5aabd676b4cae7ae123","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","macro:modify:8f45a2644508b5282f57fe129f62d19a","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85"],"type":"rule","hash":"3fc83e2b9ee1f13d8fbba5e9ef385ffc","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1031,L1032","required_engine_version":"0.35.0","name":"user_known_chmod_applications","list":"user_known_chmod_applications","items":["hyperkube","kubelet","k3s-agent"],"tags":null,"enabled":"true","used_by":["rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433"],"type":"list","hash":"41281264935e7801c910c7c8f95f29a6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# This macro should be overridden in user rules as needed. This is useful if a given application\n# should not be ignored altogether with the user_known_chmod_applications list, but only in\n# specific conditions.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1037,L1038","required_engine_version":"0.35.0","name":"user_known_set_setuid_or_setgid_bit_conditions","macro":"user_known_set_setuid_or_setgid_bit_conditions","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433"],"type":"macro","hash":"8d6a4ea3d29f9754bb194645d6826e7e","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# todo!: the usage of `evt.arg*` filter check in the output should be avoided\n# when more than one event type is involved because some event will populate\n# the filtercheck and others will always return \u003cNA\u003e. In this specific\n# rule, 'chmod' doesn't have a `%evt.arg.fd` argument for example so\n# we will always return `\u003cNA\u003e`.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1045,L1060","required_engine_version":"0.35.0","name":"Set Setuid or Setgid bit","rule":"Set Setuid or Setgid bit","condition":"chmod  and (evt.arg.mode contains \"S_ISUID\" or evt.arg.mode contains \"S_ISGID\") and not proc.name in (user_known_chmod_applications) and not exe_running_docker_save and not user_known_set_setuid_or_setgid_bit_conditions\n","desc":"This rule is focused on detecting the use of setuid or setgid bits set via chmod. These bits, when set for an application,  result in the application running with the privileges of the owning user or group. By enabling the setuid or setgid bits,  an attacker could run code in a different user's context, possibly with elevated privileges. However, there's a trade-off  with noise, given that numerous applications legitimately run chmod. This rule is related to the \"Non sudo setuid\" rule.\n","output":"Setuid or setgid bit is set via chmod (fd=%evt.arg.fd filename=%evt.arg.filename mode=%evt.arg.mode evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","process","users","mitre_privilege_escalation","T1548.001"],"enabled":"true","dependencies":["macro:chmod:417e248f80c35ca0d471575a5fb951f5","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","list:user_known_chmod_applications:41281264935e7801c910c7c8f95f29a6","macro:user_known_set_setuid_or_setgid_bit_conditions:8d6a4ea3d29f9754bb194645d6826e7e","macro:chmod:417e248f80c35ca0d471575a5fb951f5","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386"],"type":"rule","hash":"8642f04ca66468a481a4ce95f4047433","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1062,L1063","required_engine_version":"0.35.0","name":"remote_file_copy_binaries","list":"remote_file_copy_binaries","items":["rsync","scp","sftp","dcp"],"tags":null,"enabled":"true","used_by":["macro:remote_file_copy_procs:189298174ea1bfe03807fc681aa456c1","macro:ingress_remote_file_copy_procs:0b484aafac3e4358917b2200ea0c3db6"],"type":"list","hash":"7b0c77be2327008ea0fc06339de55381","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1065,L1066","required_engine_version":"0.35.0","name":"remote_file_copy_procs","macro":"remote_file_copy_procs","condition":"(proc.name in (remote_file_copy_binaries))","tags":null,"enabled":"true","dependencies":["list:remote_file_copy_binaries:7b0c77be2327008ea0fc06339de55381"],"used_by":["rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5"],"type":"macro","hash":"189298174ea1bfe03807fc681aa456c1","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Users should overwrite this macro to specify conditions under which a\n# Custom condition for use of remote file copy tool in container","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1070,L1071","required_engine_version":"0.35.0","name":"user_known_remote_file_copy_activities","macro":"user_known_remote_file_copy_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1"],"type":"macro","hash":"5847045134b24363470fbdeb3e4ddbdf","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1073,L1084","required_engine_version":"0.35.0","name":"Launch Remote File Copy Tools in Container","rule":"Launch Remote File Copy Tools in Container","condition":"spawned_process and container and remote_file_copy_procs and not user_known_remote_file_copy_activities\n","desc":"Detect remote file copy tools (like rsync, scp, sftp, dcp) launched within a container, potentially indicating data  exfiltration. Suggest refining this rule to accommodate legitimate use cases.\n","output":"Remote file copy tool launched in container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","container","network","process","mitre_exfiltration","T1020"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:remote_file_copy_procs:189298174ea1bfe03807fc681aa456c1","macro:user_known_remote_file_copy_activities:5847045134b24363470fbdeb3e4ddbdf","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"a5e84b7971a3ef1f4e58af94ed66f4a1","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Namespaces where the rule is enforce","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1087,L1088","required_engine_version":"0.35.0","name":"namespace_scope_network_only_subnet","list":"namespace_scope_network_only_subnet","tags":null,"enabled":"true","used_by":["rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0"],"type":"list","hash":"caa9fe40880ea2c55dc4cc2e09c378e6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1090,L1091","required_engine_version":"0.35.0","name":"network_local_subnet","macro":"network_local_subnet","condition":"(fd.rnet in (rfc_1918_addresses) or fd.ip = \"0.0.0.0\" or fd.net = \"127.0.0.0/8\")\n","tags":null,"enabled":"true","dependencies":["list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a"],"used_by":["rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0"],"type":"macro","hash":"7c4dcd18fe7bc3092fbc897963b579e1","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# # The rule is disabled by default.\n# # How to test:\n# # Add 'default' to namespace_scope_network_only_subnet\n# # Run:\n# kubectl run --generator=run-pod/v1 -n default -i --tty busybox --image=busybox --rm -- wget google.com -O /var/google.html\n# # Check logs running","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1102,L1114","required_engine_version":"0.35.0","name":"Network Connection outside Local Subnet","rule":"Network Connection outside Local Subnet","condition":"inbound_outbound  and container  and k8s.ns.name in (namespace_scope_network_only_subnet)  and not network_local_subnet \n","desc":"Detect network traffic (inbound or outbound) from a container to a destination outside the local subnet.  To operationalize this rule, profile your environment and update the template macro namespace_scope_network_only_subnet.  Customizing network-related rules usually demands substantial engineering effort to ensure their functionality.\n","output":"Network connection outside local subnet (fd_rip_name=%fd.rip.name fd_lip_name=%fd.lip.name fd_cip_name=%fd.cip.name fd_sip_name=%fd.sip.name connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","container","network","mitre_discovery","T1046","PCI_DSS_6.4.2"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:namespace:89801e9e98979062e84647433a8ed3e9","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:namespace_scope_network_only_subnet:caa9fe40880ea2c55dc4cc2e09c378e6","macro:network_local_subnet:7c4dcd18fe7bc3092fbc897963b579e1","macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"206cb97c10e38d639e03767466f289e0","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1116,L1117","required_engine_version":"0.35.0","name":"mount_info","macro":"mount_info","condition":"(proc.args=\"\" or proc.args intersects (\"-V\", \"-l\", \"-h\"))","tags":null,"enabled":"true","used_by":["rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80"],"type":"macro","hash":"ae8d2ce0bfdaa318f094458d4b7a5afa","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1119,L1121","required_engine_version":"0.35.0","name":"known_gke_mount_in_privileged_containers","macro":"known_gke_mount_in_privileged_containers","condition":"(k8s.ns.name = kube-system and container.image.repository = gke.gcr.io/gcp-compute-persistent-disk-csi-driver)","tags":null,"enabled":"true","used_by":["rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80"],"type":"macro","hash":"735bd25d70bf2ce7dd0aec581761b53f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1124,L1126","required_engine_version":"0.35.0","name":"known_aks_mount_in_privileged_containers","macro":"known_aks_mount_in_privileged_containers","condition":"((k8s.ns.name = kube-system and container.image.repository in (mcr.microsoft.com/oss/kubernetes-csi/azuredisk-csi,mcr.microsoft.com/oss/kubernetes-csi/azurefile-csi)) or (k8s.ns.name = system and container.image.repository = mcr.microsoft.com/oss/kubernetes-csi/secrets-store/driver))","tags":null,"enabled":"true","dependencies":["macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69"],"used_by":["rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80"],"type":"macro","hash":"ca8e26ea9fbaeef65837c5ada20a66e8","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1129,L1130","required_engine_version":"0.35.0","name":"user_known_mount_in_privileged_containers","macro":"user_known_mount_in_privileged_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80"],"type":"macro","hash":"aeaf73de6e782cca5767eccf444dfc86","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1132,L1148","required_engine_version":"0.35.0","name":"Mount Launched in Privileged Container","rule":"Mount Launched in Privileged Container","condition":"spawned_process  and container and container.privileged=true and proc.name=mount and not mount_info and not known_gke_mount_in_privileged_containers and not known_aks_mount_in_privileged_containers and not user_known_mount_in_privileged_containers\n","desc":"Detect filesystem mounts (using the mount binary) within a privileged container. Due to the elevated privileges,  this action could be one of the TTPs used in an attempt to escape from a container to the host. This type of action  is often preceded by reconnaissance activities, for which you can also create custom rules.\n","output":"Mount was executed inside a privileged container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","container","cis","filesystem","mitre_privilege_escalation","T1611"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:mount_info:ae8d2ce0bfdaa318f094458d4b7a5afa","macro:known_gke_mount_in_privileged_containers:735bd25d70bf2ce7dd0aec581761b53f","macro:known_aks_mount_in_privileged_containers:ca8e26ea9fbaeef65837c5ada20a66e8","macro:user_known_mount_in_privileged_containers:aeaf73de6e782cca5767eccf444dfc86","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"311052adcd61d744123971225f1ccd80","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1150,L1151","required_engine_version":"0.35.0","name":"ingress_remote_file_copy_binaries","list":"ingress_remote_file_copy_binaries","items":["wget"],"tags":null,"enabled":"true","used_by":["macro:ingress_remote_file_copy_procs:0b484aafac3e4358917b2200ea0c3db6"],"type":"list","hash":"415c16a087659f48853efe1ad5c981ff","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1153,L1154","required_engine_version":"0.35.0","name":"ingress_remote_file_copy_procs","macro":"ingress_remote_file_copy_procs","condition":"(proc.name in (ingress_remote_file_copy_binaries))","tags":null,"enabled":"true","dependencies":["macro:ingress:17f1d7a64442cda6863a4251c2eaf2ee","list:remote_file_copy_binaries:7b0c77be2327008ea0fc06339de55381","list:ingress_remote_file_copy_binaries:415c16a087659f48853efe1ad5c981ff"],"used_by":["rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5"],"type":"macro","hash":"0b484aafac3e4358917b2200ea0c3db6","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# Users should overwrite this macro to specify conditions under which a\n# Custom condition for use of ingress remote file copy tool in container","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1158,L1159","required_engine_version":"0.35.0","name":"user_known_ingress_remote_file_copy_activities","macro":"user_known_ingress_remote_file_copy_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5"],"type":"macro","hash":"4e472f54aebecefce22864525e76104b","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1161,L1162","required_engine_version":"0.35.0","name":"curl_download","macro":"curl_download","condition":"(proc.name = curl and (proc.cmdline contains \" -o \" or proc.cmdline contains \" --output \" or proc.cmdline contains \" -O \" or proc.cmdline contains \" --remote-name \"))","tags":null,"enabled":"true","used_by":["rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5"],"type":"macro","hash":"5f76c74cf6027a96e668a2a6d2b29cc5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1168,L1180","required_engine_version":"0.35.0","name":"Launch Ingress Remote File Copy Tools in Container","rule":"Launch Ingress Remote File Copy Tools in Container","condition":"spawned_process  and container  and (ingress_remote_file_copy_procs or curl_download)  and not user_known_ingress_remote_file_copy_activities\n","desc":"Detect ingress remote file copy tools (such as curl or wget) launched inside containers. This rule can be  considered a valuable auditing tool, but it has the potential to generate notable noise and requires careful  profiling before full operationalization.\n","output":"Ingress remote file copy tool launched in container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","container","network","process","mitre_command_and_control","TA0011"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:ingress:17f1d7a64442cda6863a4251c2eaf2ee","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:remote_file_copy_procs:189298174ea1bfe03807fc681aa456c1","macro:ingress_remote_file_copy_procs:0b484aafac3e4358917b2200ea0c3db6","macro:user_known_ingress_remote_file_copy_activities:4e472f54aebecefce22864525e76104b","macro:curl_download:5f76c74cf6027a96e668a2a6d2b29cc5","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"bceeb580cbb40da58fb1e3045bea84a5","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1182,L1183","required_engine_version":"0.35.0","name":"docker_binaries","list":"docker_binaries","items":["docker","dockerd","containerd-shim","runc:[1:CHILD]","pause","exe","docker-compose","docker-entrypoi","docker-runc-cur","docker-current","dockerd-current"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc","macro:docker_procs:26fc5da2b4808fa032d520b261d62d9d"],"type":"list","hash":"663cca84b425c42a03acc1f2ee04be85","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1185,L1186","required_engine_version":"0.35.0","name":"known_binaries_to_read_environment_variables_from_proc_files","list":"known_binaries_to_read_environment_variables_from_proc_files","items":["scsi_id","argoexec"],"tags":null,"enabled":"true","used_by":["rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c"],"type":"list","hash":"fffe0ab983f5d2a7f632d9a08c532491","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1188,L1201","required_engine_version":"0.35.0","name":"Read environment variable from /proc files","rule":"Read environment variable from /proc files","condition":"open_read  and container  and (fd.name glob /proc/*/environ) and not proc.name in (known_binaries_to_read_environment_variables_from_proc_files)\n","desc":"An attempt to read process environment variables from /proc files. The consequences are akin to accessing traditional  sensitive files, as sensitive data, including secrets, might be stored in environment variables. Understanding your  environment, such as identifying critical namespaces, and incorporating extra filtering statements to alert exclusively  for those, can enhance the rule's effectiveness.\n","output":"Environment variables were retrieved from /proc files (file=%fd.name gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","container","filesystem","process","mitre_discovery","T1083"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:known_binaries_to_read_environment_variables_from_proc_files:fffe0ab983f5d2a7f632d9a08c532491","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"e91c2ad7d9bb08b8cbaae183f91bf00c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# The steps libcontainer performs to set up the root program for a container are:\n# - clone + exec self to a program runc:[0:PARENT]\n# - clone a program runc:[1:CHILD] which sets up all the namespaces\n# - clone a second program runc:[2:INIT] + exec to the root program.\n#   The parent of runc:[2:INIT] is runc:0:PARENT]\n# As soon as 1:CHILD is created, 0:PARENT exits, so there's a race\n#   where at the time 2:INIT execs the root program, 0:PARENT might have\n#   already exited, or might still be around. So we handle both.\n# We also let runc:[1:CHILD] count as the parent process, which can occur\n# when we lose events and lose track of state.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1213,L1214","required_engine_version":"0.35.0","name":"container_entrypoint","macro":"container_entrypoint","condition":"(not proc.pname exists or proc.pname in (runc:[0:PARENT], runc:[1:CHILD], runc, docker-runc, exe, docker-runc-cur, containerd-shim, systemd, crio))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7"],"type":"macro","hash":"26bc459b2105c039deb4460ebd89573f","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1216,L1217","required_engine_version":"0.35.0","name":"system_level_side_effect_artifacts_kubectl_cp","macro":"system_level_side_effect_artifacts_kubectl_cp","condition":"(fd.name startswith /etc or fd.name startswith /proc or fd.name startswith /lib or fd.name startswith /run or fd.name startswith /usr or fd.name=\"/\")","tags":null,"enabled":"true","used_by":["rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7"],"type":"macro","hash":"9b66f3bdfbd97813161ce5bcb86742eb","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1224,L1240","required_engine_version":"0.35.0","name":"Exfiltrating Artifacts via Kubernetes Control Plane","rule":"Exfiltrating Artifacts via Kubernetes Control Plane","condition":"open_read  and container  and proc.name=tar  and container_entrypoint  and proc.tty=0  and not system_level_side_effect_artifacts_kubectl_cp\n","desc":"Detect the copying of artifacts from a container's file system using the Kubernetes control plane (kubectl cp).  This rule can identify potential exfiltration of application secrets from containers' file systems, potentially  revealing the outcomes of unauthorized access and control plane misuse via stolen identities (such as stolen  credentials like Kubernetes serviceaccount tokens). Can be customized by the adopter to only monitor specific  artifact paths, containers, or namespaces as needed.\n","output":"Exfiltrating Artifacts via Kubernetes Control Plane (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","container","filesystem","mitre_exfiltration","TA0010"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","macro:system_level_side_effect_artifacts_kubectl_cp:9b66f3bdfbd97813161ce5bcb86742eb","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"type":"rule","hash":"895b0567a065496ab1c5e877c9afc8c7","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1242,L1257","required_engine_version":"0.35.0","name":"Adding ssh keys to authorized_keys","rule":"Adding ssh keys to authorized_keys","condition":"open_write and (user_ssh_directory or fd.name startswith /root/.ssh) and fd.name endswith authorized_keys and not proc.name in (ssh_binaries)\n","desc":"After gaining access, attackers can modify the authorized_keys file to maintain persistence on a victim host. Where authorized_keys files are modified via cloud APIs or command line interfaces, an adversary may achieve  privilege escalation on the target virtual machine if they add a key to a higher-privileged user. This rules aims at detecting any modification to the authorized_keys file, that is usually located under the .ssh directory in any user's home directory. This rule complements the more generic auditing rule \"Read ssh information\" by specifically detecting the writing of new, potentially attacker-provided keys.\n","output":"Adding ssh keys to authorized_keys (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","host","filesystem","mitre_persistence","T1098.004"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:open_write:43a1a1a71582531905f162ae8757ecda","list:ssh_binaries:ec2d0b20ba5fdce37cbef587b8e2675f","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb"],"type":"rule","hash":"a0e2c1ddd0b39a2b2f42be7646b8cfc2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"# possible use of CVE-2023-4911","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1260,L1261","required_engine_version":"0.35.0","name":"glibc_tunables_env","macro":"glibc_tunables_env","condition":"(proc.env icontains GLIBC_TUNABLES)","tags":null,"enabled":"true","used_by":["rule:Potential Local Privilege Escalation via Environment Variables Misuse:5ab919338a6e3deab238595f8895a76c"],"type":"macro","hash":"3b9bdd764924e3e1d0cd5c39ab0972d2","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1263,L1276","required_engine_version":"0.35.0","name":"Potential Local Privilege Escalation via Environment Variables Misuse","rule":"Potential Local Privilege Escalation via Environment Variables Misuse","condition":"spawned_process  and glibc_tunables_env\n","desc":"Process run with suspect environment variable that could be attempting privilege escalation. One use case is  detecting the use of the GLIBC_TUNABLES environment variable, which could be used for privilege escalation  on systems running vulnerable glibc versions. Only known and carefully profiled processes that legitimately  exhibit this behavior should be excluded from this rule. This rule is expected to trigger on every attempt,  even failed ones.\n","output":"Process run with suspect environment variable which could be attempting privilege escalation (env=%proc.env evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","users","mitre_privilege_escalation","TA0004"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:glibc_tunables_env:3b9bdd764924e3e1d0cd5c39ab0972d2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"5ab919338a6e3deab238595f8895a76c","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1278,L1286","required_engine_version":"0.35.0","name":"Backdoored library loaded into SSHD (CVE-2024-3094)","rule":"Backdoored library loaded into SSHD (CVE-2024-3094)","condition":"open_read and  proc.name=sshd and  (fd.name contains \"liblzma.so.5.6.0\" or fd.name contains \"liblzma.so.5.6.1\")\n","desc":"This rule detects possible CVE-2024-3094 exploitation when the SSH daemon process loads a vulnerable version of the liblzma library. An attacker could exploit this to interfere with authentication in sshd via systemd, potentially compromising sensitive data or escalating their privileges.","output":"SSHD loaded a backdoored version of liblzma library %fd.name with parent %proc.pname and cmdline %proc.cmdline (process=%proc.name parent=%proc.pname file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid proc_exepath=%proc.exepath command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_incubating","host","container","mitre_initial_access","T1556"],"enabled":"true","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","macro:open_read:fada70dac63821c34b095b962e02cb36","macro:open_read:fada70dac63821c34b095b962e02cb36"],"type":"rule","hash":"6a98bda365511a682502887ba09fb757","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1288,L1289","required_engine_version":"0.35.0","name":"bpf_profiled_binaries","list":"bpf_profiled_binaries","items":["falco","bpftool","systemd"],"tags":null,"enabled":"true","used_by":["macro:bpf_profiled_procs:d6dad7efb6115d15b20df68049a1e9a9"],"type":"list","hash":"8a3b11d553c5ab42204271f93f1c6877","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1291,L1292","required_engine_version":"0.35.0","name":"bpf_profiled_procs","macro":"bpf_profiled_procs","condition":"(proc.name in (bpf_profiled_binaries))","tags":null,"enabled":"true","dependencies":["list:bpf_profiled_binaries:8a3b11d553c5ab42204271f93f1c6877"],"used_by":["rule:BPF Program Not Profiled:1f6f21e3cf389d5b1970006c3acc1a92"],"type":"macro","hash":"d6dad7efb6115d15b20df68049a1e9a9","maturity":"incubating"},{"file_name":"falco-incubating_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-incubating_rules.yaml#L1294,L1307","required_engine_version":"0.35.0","name":"BPF Program Not Profiled","rule":"BPF Program Not Profiled","condition":"evt.type=bpf and evt.dir=\u003e  and evt.arg.cmd=BPF_PROG_LOAD and not bpf_profiled_procs\n","desc":"BPF is a kernel technology that can be misused for malicious purposes, like \"Linux Kernel Module Injection\". This  rule should be considered an auditing rule to notify you of any unprofiled BPF tools running in your environment.  However, it requires customization after profiling your environment. BPF-powered agents make bpf syscalls all the  time, so this rule only sends logs for BPF_PROG_LOAD calls (bpf cmd=BPF_PROG_LOAD) in the enter event. If you also want to log  whether the syscall failed or succeeded, remove the direction filter and add the evt.arg.res_or_fd output field.\n","output":"BPF Program Not Profiled (bpf_cmd=%evt.arg.cmd evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_incubating","host","container","mitre_persistence","TA0003"],"enabled":"true","dependencies":["macro:bpf_profiled_procs:d6dad7efb6115d15b20df68049a1e9a9"],"type":"rule","hash":"1f6f21e3cf389d5b1970006c3acc1a92","maturity":"incubating"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Currently disabled as read/write are ignored syscalls. The nearly\n# similar open_write/open_read check for files being opened for\n# reading/writing.\n# - macro: write\n#   condition: (syscall.type=write and fd.type in (file, directory))\n# - macro: read\n#   condition: (syscall.type=read and evt.dir=\u003e and fd.type in (file, directory))\n","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L38,L39","required_engine_version":"0.35.0","name":"open_write","macro":"open_write","condition":"(evt.type in (open,openat,openat2) and evt.is_open_write=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:truncate_shell_history:ac78bdcd5d832a2f504b6e3ce03a6868","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3"],"type":"macro","hash":"43a1a1a71582531905f162ae8757ecda","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L41,L42","required_engine_version":"0.35.0","name":"open_read","macro":"open_read","condition":"(evt.type in (open,openat,openat2) and evt.is_open_read=true and fd.typechar='f' and fd.num\u003e=0)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file trusted after startup:b75aa41834466514724e394b6983a5e6","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","rule:Backdoored library loaded into SSHD (CVE-2024-3094):6a98bda365511a682502887ba09fb757","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"macro","hash":"fada70dac63821c34b095b962e02cb36","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This macro `never_true` is used as placeholder for tuning negative logical sub-expressions, for example\n# - macro: allowed_ssh_hosts\n#   condition: (never_true)\n# can be used in a rules' expression with double negation `and not allowed_ssh_hosts` which effectively evaluates\n# to true and does nothing, the perfect empty template for `logical` cases as opposed to list templates.\n# When tuning the rule you can override the macro with something useful, e.g.\n# - macro: allowed_ssh_hosts\n#   condition: (evt.hostname contains xyz)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L52,L53","required_engine_version":"0.35.0","name":"never_true","macro":"never_true","condition":"(evt.num=0)","tags":null,"enabled":"true","used_by":["macro:user_known_read_sensitive_files_activities:93013fdd38f628311bbd04ebd0e01436","macro:possibly_node_in_container:513181c67b31a65f5956a1911a700134","macro:possibly_parent_java_running_tomcat:ff2e34a96a3a090dab697eb7bef460f0","macro:user_known_system_user_login:c220c191248c206685113a98cf6cc4f4","macro:user_expected_terminal_shell_in_container_conditions:506bd5cc090648cf6e9411357909e53d","macro:user_shell_container_exclusions:f0b59b425c9d3204fb50ec6e436e8cd7","macro:user_known_contact_k8s_api_server_activities:4c6ed813572d74073bccdf798a240244","macro:grep_more:1f162d2b9d80645c0c17e19656463e53","macro:allowed_clear_log_files:27cabc017fb347048c5906d368af02da","macro:user_known_remove_data_activities:82aeff15fb6a39dfd18eb8a0aa4490b2","macro:user_known_stand_streams_redirect_activities:c2f8c69b4ec7a2b55cd5ce0381586875","macro:known_drop_and_execute_activities:a1a1ce54329c3cd6f627d9bdc5e50ea8","macro:user_known_node_port_service:eef8c8cb2dddbde98acc0032c8437a1e","macro:user_known_exec_pod_activities:654a93971e99c9f7b3bb5a8614b96d7f","macro:user_known_portforward_activities:c1bda959367c501d28cf34ac7b327cd5","macro:user_known_pod_debug_activities:f680ce82ade487e7d4c6d0bcf300391a","macro:consider_all_events:38d89891d1f279c05021c92e24eee45a","macro:user_known_shell_config_modifiers:6b8f57e70346a317add4e1e9046c3660","macro:user_known_cron_jobs:e19053b1c16c7ae8df45015aafbe5355","macro:user_known_read_ssh_information_activities:66b9d639d9ffb5e4aec0837ef7b1a7f2","macro:user_known_db_spawned_processes:e9782b773c4c9b7a5b5c0c30a23a0662","macro:user_known_change_thread_namespace_activities:be737247cfb371d8c20ef23aab8bed09","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_privileged_containers:605f400a686e1bec4f1e18414be552c5","macro:user_expected_system_procs_network_activity_conditions:2c633a138f025b38353d5ed0477bfd72","macro:allowed_ssh_proxy_env:ee1096508e1dd9b7b7b2a990d6fd1cb5","macro:user_known_user_management_activities:23d1a029d115829da2c3d05ddc8ba459","macro:user_known_create_files_below_dev_activities:e252bfb734f01b620917e7724e620572","macro:ec2_metadata_containers:d5f0dfcd1bb7ef57fab8910ab3796682","macro:user_known_package_manager_in_container:e9db6635f0430b51de8b303990f927a7","macro:user_known_network_tool_activities:9b807c4e0d8ba042426b117cdced8023","macro:user_known_set_setuid_or_setgid_bit_conditions:8d6a4ea3d29f9754bb194645d6826e7e","macro:user_known_remote_file_copy_activities:5847045134b24363470fbdeb3e4ddbdf","macro:user_known_mount_in_privileged_containers:aeaf73de6e782cca5767eccf444dfc86","macro:user_known_ingress_remote_file_copy_activities:4e472f54aebecefce22864525e76104b","macro:user_known_update_package_registry:9e4592918895a4946eeab7a831fd4c7c","macro:user_known_write_below_binary_dir_activities:e9327cc6148dd2254c56add6bdca831d","macro:user_known_write_monitored_dir_conditions:08d473341b14e4bbae4157a75faab7f7","macro:etckeeper_activities:1e5781086c2cc3322cf517ae6e095ccc","macro:user_known_write_below_etc_activities:1481c66148493216582035ff05ba2863","macro:user_known_write_below_root_activities:b1f944844634ff62884377a1e56fca2a","macro:user_known_write_rpm_database_activities:c772da1c64ba873faf57a17e5c0af342","macro:user_known_modify_bin_dir_activities:22c60c5fe87a748d783a1bf606652cd6","macro:user_known_mkdir_bin_dir_activities:07904727e6d103f3e4cec0b46f15466d","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:user_sensitive_mount_containers:f0bae3b600b45943c88848d69ff0511b","macro:nodeport_containers:d08e4abe1246be2869449a98762daa05","macro:user_known_create_hidden_file_activities:c604f50751c1133a076f8194b9f04921","macro:user_known_container_drift_activities:46ac0d3ff6fcf7d1fec5e687faf159f5"],"type":"macro","hash":"7fdab030a488289fce9f593757b50ba3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# In some cases, such as dropped system call events, information about\n# the process name may be missing. For some rules that really depend\n# on the identity of the process performing an action such as opening\n# a file, etc., we require that the process name be known.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L70,L71","required_engine_version":"0.35.0","name":"proc_name_exists","macro":"proc_name_exists","condition":"(not proc.name in (\"\u003cNA\u003e\",\"N/A\"))","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:PTRACE attached to process:061f25635ba16ec4c05dec23396e4a6d","rule:PTRACE anti-debug attempt:2552a1ec1bd48915c8e2f2279ea7054e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"453387eaa91c2ac2bd725502766ed7d3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L73,L74","required_engine_version":"0.35.0","name":"rename","macro":"rename","condition":"(evt.type in (rename, renameat, renameat2))","tags":null,"enabled":"true","used_by":["macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079"],"type":"macro","hash":"d7fba04fc8e17bcfc603b318a85b762c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L76,L77","required_engine_version":"0.35.0","name":"mkdir","macro":"mkdir","condition":"(evt.type in (mkdir, mkdirat))","tags":null,"enabled":"true","used_by":["rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"d1c89dbbd2e4ef759c37d3e0b94e7327","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L79,L80","required_engine_version":"0.35.0","name":"remove","macro":"remove","condition":"(evt.type in (rmdir, unlink, unlinkat))","tags":null,"enabled":"true","used_by":["rule:Remove Collaborator from Repository:943741810bf68993058924c0fa203405","macro:clear_data_procs:d1a24b75738d164999774767fb52b175","rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:modify:8f45a2644508b5282f57fe129f62d19a"],"type":"macro","hash":"0f6969d7052da9261e31ddb6e88c136e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L82,L83","required_engine_version":"0.35.0","name":"modify","macro":"modify","condition":"(rename or remove)","tags":null,"enabled":"true","dependencies":["macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:remove:0f6969d7052da9261e31ddb6e88c136e","macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:remove:0f6969d7052da9261e31ddb6e88c136e"],"used_by":["rule:Create/Modify Configmap With Private Credentials:ebb29c636783c42f1280e27e47cf3e95","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","rule:System ClusterRole Modified/Deleted:a7ed236dedc9cd9ba73e7d75c0296cbe","macro:modify_shell_history:a4caae82528f2d3e827266ba74a3e115","rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"8f45a2644508b5282f57fe129f62d19a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L85,L86","required_engine_version":"0.35.0","name":"spawned_process","macro":"spawned_process","condition":"(evt.type in (execve, execveat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:System user interactive:5bdbd778450a0e3fa8c0b9c8261f5326","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","rule:Search Private Keys or Passwords:55941ff25a7d8c6253b5a17e4ed20d30","rule:Remove Bulk Data from Disk:ee50daeb936f1d2a3ecf9211b963d206","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Find AWS Credentials:6f600d3da731ed8b36a42b3e6edc613a","rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Fileless execution via memfd_create:421925c119255e3807c6bbf9609c23cb","rule:Schedule Cron Jobs:8dac86f3c89ab2eebddfaef6b307f842","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:DB program spawned process:a277852022c3734da76c948e8bfdfaf7","rule:Program run with disallowed http proxy env:cf0f7f713bd9ca1baa7ef93da5ca1a3a","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Potential Local Privilege Escalation via Environment Variables Misuse:5ab919338a6e3deab238595f8895a76c","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Detect crypto miners using the Stratum protocol:b22719ac071b8de3c7e0ec92dcab21cb","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Sudo Potential Privilege Escalation:f1e70442dbd3656e78ceb11d3863b239","rule:Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034):5bc83b5d4fdd9b976dabc965dfe05fee","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81","rule:Basic Interactive Reconnaissance:f919d2aa742cf1ef21907e9e3d805ca1"],"type":"macro","hash":"b684ebf37c34399a595a3791398d95b2","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L88,L89","required_engine_version":"0.35.0","name":"chmod","macro":"chmod","condition":"(evt.type in (chmod, fchmod, fchmodat) and evt.dir=\u003c)","tags":null,"enabled":"true","used_by":["rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6"],"type":"macro","hash":"417e248f80c35ca0d471575a5fb951f5","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# File categories","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L92,L93","required_engine_version":"0.35.0","name":"bin_dir","macro":"bin_dir","condition":"(fd.directory in (/bin, /sbin, /usr/bin, /usr/sbin))","tags":null,"enabled":"true","used_by":["rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c"],"type":"macro","hash":"d23b8731e3efa0dfa8e2c20d76fbe442","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L95,L96","required_engine_version":"0.35.0","name":"bin_dir_mkdir","macro":"bin_dir_mkdir","condition":"(evt.arg.path startswith /bin/ or evt.arg.path startswith /sbin/ or evt.arg.path startswith /usr/bin/ or evt.arg.path startswith /usr/sbin/)\n","tags":null,"enabled":"true","used_by":["rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c"],"type":"macro","hash":"f3dd593d07dba89f9350e450a35eef6b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L102,L103","required_engine_version":"0.35.0","name":"bin_dir_rename","macro":"bin_dir_rename","condition":"(evt.arg.path startswith /bin/ or evt.arg.path startswith /sbin/ or evt.arg.path startswith /usr/bin/ or evt.arg.path startswith /usr/sbin/ or evt.arg.name startswith /bin/ or evt.arg.name startswith /sbin/ or evt.arg.name startswith /usr/bin/ or evt.arg.name startswith /usr/sbin/ or evt.arg.oldpath startswith /bin/ or evt.arg.oldpath startswith /sbin/ or evt.arg.oldpath startswith /usr/bin/ or evt.arg.oldpath startswith /usr/sbin/ or evt.arg.newpath startswith /bin/ or evt.arg.newpath startswith /sbin/ or evt.arg.newpath startswith /usr/bin/ or evt.arg.newpath startswith /usr/sbin/)\n","tags":null,"enabled":"true","used_by":["rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079"],"type":"macro","hash":"b186b1e54a4d9e1f1c2b31f0628253db","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L121,L122","required_engine_version":"0.35.0","name":"etc_dir","macro":"etc_dir","condition":"(fd.name startswith /etc/)","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e750c953eb53022a0b566477ad6e8090","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This detects writes immediately below / or any write anywhere below /root","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L125,L126","required_engine_version":"0.35.0","name":"root_dir","macro":"root_dir","condition":"(fd.directory=/ or fd.name startswith /root/)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"2e9c111d3f1a2373f6f2a661b4d0d49d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L128,L129","required_engine_version":"0.35.0","name":"shell_binaries","list":"shell_binaries","items":["ash","bash","csh","ksh","sh","tcsh","zsh","dash"],"tags":null,"enabled":"true","used_by":["macro:shell_procs:8907863a6a74678a4246f35930a29fe1","rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"af03e5f14f4aa2d1505ec180e1c58caf","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L131,L132","required_engine_version":"0.35.0","name":"shell_mgmt_binaries","list":"shell_mgmt_binaries","items":["add-shell","remove-shell"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"2aa25fb259f9af8c31404e0549391a25","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# dpkg -L passwd | grep bin | xargs ls -ld | grep -v '^d' | awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L135,L136","required_engine_version":"0.35.0","name":"passwd_binaries","list":"passwd_binaries","items":["shadowconfig","grpck","pwunconv","grpconv","pwck","groupmod","vipw","pwconv","useradd","newusers","cppw","chpasswd","usermod","groupadd","groupdel","grpunconv","chgpasswd","userdel","chage","chsh","gpasswd","chfn","expiry","passwd","vigr","cpgr","adduser","addgroup","deluser","delgroup"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"11d902c686355a4df0580d2b954301da","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# repoquery -l shadow-utils | grep bin | xargs ls -ld | grep -v '^d' |\n#     awk '{print $9}' | xargs -L 1 basename | tr \"\\\\n\" \",\"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L145,L146","required_engine_version":"0.35.0","name":"shadowutils_binaries","list":"shadowutils_binaries","items":["chage","gpasswd","lastlog","newgrp","sg","adduser","deluser","chpasswd","groupadd","groupdel","addgroup","delgroup","groupmems","groupmod","grpck","grpconv","grpunconv","newusers","pwck","pwconv","pwunconv","useradd","userdel","usermod","vigr","vipw","unix_chkpwd"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"dd53fb0d2784a8a52ac3c20ab275de72","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L152,L153","required_engine_version":"0.35.0","name":"sysdigcloud_binaries","list":"sysdigcloud_binaries","items":["setup-backend","dragent","sdchecks"],"tags":null,"enabled":"true","used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"5cd4a552978d2b6ed446f11f8a294cbf","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L155,L156","required_engine_version":"0.35.0","name":"interpreted_binaries","list":"interpreted_binaries","items":["lua","node","perl","perl5","perl6","php","python","python2","python3","ruby","tcl"],"tags":null,"enabled":"true","used_by":["macro:interpreted_procs:da079be04ff9eb76c2091349ef2a40c3"],"type":"list","hash":"1b759b731251f17c488fd348c604ab1c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L158,L159","required_engine_version":"0.35.0","name":"interpreted_procs","macro":"interpreted_procs","condition":"(proc.name in (interpreted_binaries))\n","tags":null,"enabled":"true","dependencies":["list:interpreted_binaries:1b759b731251f17c488fd348c604ab1c"],"used_by":["rule:Interpreted procs inbound network activity:692f4100b04d58b3f8aed51afb8b51cd","rule:Interpreted procs outbound network activity:f44c77a690d44b9d8004d3283a63cb92"],"type":"macro","hash":"da079be04ff9eb76c2091349ef2a40c3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The explicit quotes are needed to avoid the - characters being\n# interpreted by the filter expression.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L164,L165","required_engine_version":"0.35.0","name":"rpm_binaries","list":"rpm_binaries","items":["dnf","dnf-automatic","rpm","rpmkey","yum","\"75-system-updat\"","rhsmcertd-worke","rhsmcertd","subscription-ma","repoquery","rpmkeys","rpmq","yum-cron","yum-config-mana","yum-debug-dump","abrt-action-sav","rpmdb_stat","microdnf","rhn_check","yumdb"],"tags":null,"enabled":"true","used_by":["macro:rpm_procs:4af559147e158d724c3273c0cf781a9f"],"type":"list","hash":"7ee4dcdb218ac951a864e29417a8177c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L169,L170","required_engine_version":"0.35.0","name":"openscap_rpm_binaries","list":"openscap_rpm_binaries","items":["probe_rpminfo","probe_rpmverify","probe_rpmverifyfile","probe_rpmverifypackage"],"tags":null,"enabled":"true","used_by":["macro:rpm_procs:4af559147e158d724c3273c0cf781a9f"],"type":"list","hash":"be20ee993f4afee9e24466e3049127fa","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L172,L173","required_engine_version":"0.35.0","name":"rpm_procs","macro":"rpm_procs","condition":"(proc.name in (rpm_binaries, openscap_rpm_binaries) or proc.name in (salt-call, salt-minion))","tags":null,"enabled":"true","dependencies":["list:rpm_binaries:7ee4dcdb218ac951a864e29417a8177c","list:rpm_binaries:7ee4dcdb218ac951a864e29417a8177c","list:rpm_binaries:7ee4dcdb218ac951a864e29417a8177c","list:openscap_rpm_binaries:be20ee993f4afee9e24466e3049127fa"],"used_by":["rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"4af559147e158d724c3273c0cf781a9f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L175,L176","required_engine_version":"0.35.0","name":"deb_binaries","list":"deb_binaries","items":["dpkg","dpkg-preconfigu","dpkg-reconfigur","dpkg-divert","apt","apt-get","aptitude","frontend","preinst","add-apt-reposit","apt-auto-remova","apt-key","apt-listchanges","unattended-upgr","apt-add-reposit","apt-cache","apt.systemd.dai"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"69ab88691c72177ecff691379ff122c4","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L180,L181","required_engine_version":"0.35.0","name":"python_package_managers","list":"python_package_managers","items":["pip","pip3","conda"],"tags":null,"enabled":"true","type":"list","hash":"a529bcd7406766c180064511628b15f3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The truncated dpkg-preconfigu is intentional, process names are\n# truncated at the falcosecurity-libs level.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L185,L186","required_engine_version":"0.35.0","name":"package_mgmt_binaries","list":"package_mgmt_binaries","items":["rpm_binaries","deb_binaries","update-alternat","gem","npm","python_package_managers","sane-utils.post","alternatives","chef-client","apk","snapd"],"tags":null,"enabled":"true","used_by":["macro:run_by_package_mgmt_binaries:330b541f474e818efb55c808d9f9ec6f","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"cbd791c45a9d5d51118aaf6c9ce6b934","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L188,L189","required_engine_version":"0.35.0","name":"package_mgmt_procs","macro":"package_mgmt_procs","condition":"(proc.name in (package_mgmt_binaries))","tags":null,"enabled":"true","dependencies":["list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934"],"used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c"],"type":"macro","hash":"a69d5abbdc29f4dde6b8ec5c7d0209d6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L191,L192","required_engine_version":"0.35.0","name":"package_mgmt_ancestor_procs","macro":"package_mgmt_ancestor_procs","condition":"(proc.pname in (package_mgmt_binaries) or proc.aname[2] in (package_mgmt_binaries) or proc.aname[3] in (package_mgmt_binaries) or proc.aname[4] in (package_mgmt_binaries))","tags":null,"enabled":"true","dependencies":["list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934"],"used_by":["rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad"],"type":"macro","hash":"b5f7b9871403d1f16226b65c823c46de","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L197,L198","required_engine_version":"0.35.0","name":"coreos_write_ssh_dir","macro":"coreos_write_ssh_dir","condition":"(proc.name=update-ssh-keys and fd.name startswith /home/core/.ssh)","tags":null,"enabled":"true","used_by":["rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"b0061811cd9141284dcf12fa0f09a835","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L200,L201","required_engine_version":"0.35.0","name":"ssl_mgmt_binaries","list":"ssl_mgmt_binaries","items":["ca-certificates"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"e0e9a45ab08f5ea27e6fe93ae471d074","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L203,L204","required_engine_version":"0.35.0","name":"dhcp_binaries","list":"dhcp_binaries","items":["dhclient","dhclient-script","11-dhclient"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"e590b0b0424c28ab433a99a955c907bb","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L206,L207","required_engine_version":"0.35.0","name":"dev_creation_binaries","list":"dev_creation_binaries","items":["blkid","rename_device","update_engine","sgdisk"],"tags":null,"enabled":"true","used_by":["rule:Create files below dev:c1ac5692e9c9d8be0dd8c387ee3fe192","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"2de5fcfae70913478022a9d4bd879f48","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L209,L210","required_engine_version":"0.35.0","name":"nomachine_binaries","list":"nomachine_binaries","items":["nxexec","nxnode.bin","nxserver.bin","nxclient.bin"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"be10dcfdff8f673dfb82d8bed97c68b9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L212,L213","required_engine_version":"0.35.0","name":"mail_config_binaries","list":"mail_config_binaries","items":["update_conf","parse_mc","makemap_hash","newaliases","update_mk","update_tlsm4","update_db","update_mc","ssmtp.postinst","mailq","postalias","postfix.config.","postfix.config","postfix-script","postconf"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"b7be6fc7d0d3734f0bdfda0a81accc5f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Network","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L220,L221","required_engine_version":"0.35.0","name":"inbound","macro":"inbound","condition":"(((evt.type in (accept,accept4,listen) and evt.dir=\u003c) or\n  (evt.type in (recvfrom,recvmsg) and evt.dir=\u003c and\n   fd.l4proto != tcp and fd.connected=false and fd.name_changed=true)) and\n (fd.typechar = 4 or fd.typechar = 6) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\") and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Unexpected inbound connection source:dd871cffb0f21f49cc20b71ea033700d","rule:Interpreted procs inbound network activity:692f4100b04d58b3f8aed51afb8b51cd","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"a8e6fe5b9e68f30a146cefebaa7edcc3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# RFC1918 addresses were assigned for private network usage","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L230,L231","required_engine_version":"0.35.0","name":"rfc_1918_addresses","list":"rfc_1918_addresses","items":["\"10.0.0.0/8\"","\"172.16.0.0/12\"","\"192.168.0.0/16\""],"tags":null,"enabled":"true","used_by":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:network_local_subnet:7c4dcd18fe7bc3092fbc897963b579e1","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"list","hash":"748492cefb06210e27885e76e1ab8f7a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L233,L234","required_engine_version":"0.35.0","name":"outbound","macro":"outbound","condition":"(((evt.type = connect and evt.dir=\u003c) or\n  (evt.type in (sendto,sendmsg) and evt.dir=\u003c and\n   fd.l4proto != tcp and fd.connected=false and fd.name_changed=true)) and\n (fd.typechar = 4 or fd.typechar = 6) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","dependencies":["list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a"],"used_by":["rule:Disallowed SSH Connection Non Standard Port:8d88e40d9773d500a7fb9fb5d28d0aad","rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Interpreted procs outbound network activity:f44c77a690d44b9d8004d3283a63cb92","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"b5229dfdd9136d1c772f9070f3095016","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Very similar to inbound/outbound, but combines the tests together\n# for efficiency.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L244,L245","required_engine_version":"0.35.0","name":"inbound_outbound","macro":"inbound_outbound","condition":"((((evt.type in (accept,accept4,listen,connect) and evt.dir=\u003c)) and\n (fd.typechar = 4 or fd.typechar = 6)) and\n (fd.ip != \"0.0.0.0\" and fd.net != \"127.0.0.0/8\") and\n (evt.rawres \u003e= 0 or evt.res = EINPROGRESS))\n","tags":null,"enabled":"true","used_by":["rule:System procs network activity:ebe3e03115e4eb21a30e0e5b9e6a9f55","rule:Unexpected UDP Traffic:c56289ee4fb60625edda0baff211e42b","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"5b954dcc69c9cfaf014ba8fbebce7921","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L251,L252","required_engine_version":"0.35.0","name":"allowed_inbound_source_ipaddrs","list":"allowed_inbound_source_ipaddrs","items":["\"127.0.0.1\""],"tags":null,"enabled":"true","used_by":["rule:Unexpected inbound connection source:dd871cffb0f21f49cc20b71ea033700d"],"type":"list","hash":"e438534edc23bd0b03a66b7f2ff7b4ce","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L254,L255","required_engine_version":"0.35.0","name":"allowed_inbound_source_networks","list":"allowed_inbound_source_networks","items":["\"127.0.0.1/8\"","\"10.0.0.0/8\""],"tags":null,"enabled":"true","used_by":["rule:Unexpected inbound connection source:dd871cffb0f21f49cc20b71ea033700d"],"type":"list","hash":"b18e6f6bcbe2968bda5d0717042f285b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L257,L258","required_engine_version":"0.35.0","name":"allowed_inbound_source_domains","list":"allowed_inbound_source_domains","items":["google.com"],"tags":null,"enabled":"true","used_by":["rule:Unexpected inbound connection source:dd871cffb0f21f49cc20b71ea033700d"],"type":"list","hash":"7cce24857d861af6aefb62df36686cae","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L260,L274","required_engine_version":"0.35.0","name":"Unexpected inbound connection source","rule":"Unexpected inbound connection source","condition":"inbound  and not ((fd.cip in (allowed_inbound_source_ipaddrs)) or\n         (fd.cnet in (allowed_inbound_source_networks)) or\n         (fd.cip.name in (allowed_inbound_source_domains)))\n","desc":"Detect any inbound connection from a source outside of an allowed set of ips, networks, or domain names.  This rule absolutely requires profiling your environment beforehand. Network-based rules are extremely crucial  in any security program, as they can often provide the only definitive evidence. However, effectively operationalizing  them can be challenging due to the potential for noise.\n","output":"Disallowed inbound connection source (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","network","mitre_command_and_control","TA0011"],"enabled":"false","dependencies":["macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3","list:allowed_inbound_source_ipaddrs:e438534edc23bd0b03a66b7f2ff7b4ce","list:allowed_inbound_source_networks:b18e6f6bcbe2968bda5d0717042f285b","list:allowed_inbound_source_domains:7cce24857d861af6aefb62df36686cae"],"type":"rule","hash":"dd871cffb0f21f49cc20b71ea033700d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L276,L277","required_engine_version":"0.35.0","name":"bash_config_filenames","list":"bash_config_filenames","items":[".bashrc",".bash_profile",".bash_history",".bash_login",".bash_logout",".inputrc",".profile"],"tags":null,"enabled":"true","type":"list","hash":"db913d561c87670025faa7fc7396b70c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L279,L280","required_engine_version":"0.35.0","name":"bash_config_files","list":"bash_config_files","items":["/etc/profile","/etc/bashrc"],"tags":null,"enabled":"true","type":"list","hash":"0b7b8e1f3e524019209f61ac4619a676","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Covers both csh and tcsh","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L283,L284","required_engine_version":"0.35.0","name":"csh_config_filenames","list":"csh_config_filenames","items":[".cshrc",".login",".logout",".history",".tcshrc",".cshdirs"],"tags":null,"enabled":"true","type":"list","hash":"a869e10df8d46cc3b09978b58aea1ed0","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L286,L287","required_engine_version":"0.35.0","name":"csh_config_files","list":"csh_config_files","items":["/etc/csh.cshrc","/etc/csh.login"],"tags":null,"enabled":"true","type":"list","hash":"91f60a0ac21cc0e0bb708943c58935b6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L289,L290","required_engine_version":"0.35.0","name":"zsh_config_filenames","list":"zsh_config_filenames","items":[".zshenv",".zprofile",".zshrc",".zlogin",".zlogout"],"tags":null,"enabled":"true","type":"list","hash":"9fefc4e5753ca35077feb17387946a7d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L292,L293","required_engine_version":"0.35.0","name":"shell_config_filenames","list":"shell_config_filenames","items":["bash_config_filenames","csh_config_filenames","zsh_config_filenames"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"9a1cc70e3d80e9c985b9dc47127279c7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L295,L296","required_engine_version":"0.35.0","name":"shell_config_files","list":"shell_config_files","items":["bash_config_files","csh_config_files"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"55240f881e56a7081450b9163ca1ea28","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L298,L299","required_engine_version":"0.35.0","name":"shell_config_directories","list":"shell_config_directories","items":["/etc/zsh"],"tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Read Shell Configuration File:7a5c3150bd06401c28d7ffdf198cde56"],"type":"list","hash":"cc7eb8ab2529db0fa344a822e8499e15","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This rule is not enabled by default, as there are many legitimate\n# readers of shell config files.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L303,L318","required_engine_version":"0.35.0","name":"Read Shell Configuration File","rule":"Read Shell Configuration File","condition":"open_read and (fd.filename in (shell_config_filenames) or\n     fd.name in (shell_config_files) or\n     fd.directory in (shell_config_directories)) \nand not proc.name in (shell_binaries)\n","desc":"This rule detects attempts made by non-shell programs to read shell configuration files. It offers additional generic auditing.  It serves as a baseline detection alert for unusual shell configuration file accesses. The rule \"Modify Shell Configuration File\"  might be more relevant and adequate for your specific cases.\n","output":"A shell configuration file was read by a non-shell program (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_discovery","T1546.004"],"enabled":"false","dependencies":["macro:open_read:fada70dac63821c34b095b962e02cb36","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","macro:open_read:fada70dac63821c34b095b962e02cb36","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_config_filenames:9a1cc70e3d80e9c985b9dc47127279c7","list:shell_config_files:55240f881e56a7081450b9163ca1ea28","list:shell_config_directories:cc7eb8ab2529db0fa344a822e8499e15","macro:open_read:fada70dac63821c34b095b962e02cb36","list:shell_binaries:af03e5f14f4aa2d1505ec180e1c58caf","list:shell_config_filenames:9a1cc70e3d80e9c985b9dc47127279c7","list:shell_config_files:55240f881e56a7081450b9163ca1ea28","list:shell_config_directories:cc7eb8ab2529db0fa344a822e8499e15"],"type":"rule","hash":"7a5c3150bd06401c28d7ffdf198cde56","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Use this to test whether the event occurred within a container.\n# When displaying container information in the output field, use\n# %container.info, without any leading term (file=%fd.name\n# %container.info user=%user.name user_loginuid=%user.loginuid, and not file=%fd.name\n# container=%container.info user=%user.name user_loginuid=%user.loginuid). The output will change\n# based on the context and whether or not -pk/-pm/-pc was specified on\n# the command line.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L327,L328","required_engine_version":"0.35.0","name":"container","macro":"container","condition":"(container.id != host)","tags":null,"enabled":"true","used_by":["macro:user_read_sensitive_file_containers:e8df79ecac70e22ac5ac4f683bb13d24","rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","rule:Run shell untrusted:551646aedeb1120e4db55fddbd6aff15","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Terminal shell in container:1a24c2ccf3a790d0c04e3858f7439ab4","macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","rule:Contact K8S API Server From Container:d067eb11f0680c4f94e83770bd307c27","rule:Netcat Remote Code Execution in Container:b1be8adba840b7e237a11c3744fc2a3e","macro:trusted_logging_images:321c1a70d9796565640a81b9f3701e42","macro:containerd_activities:c2ce963725cd72b3df80b07413b7e4c4","rule:Clear Log Activities:791121642c2a993b9c4b71e1dc53dcf4","rule:Packet socket created in container:59e21c1607722fe0bee894eff26d9025","rule:Redirect STDOUT/STDIN to Network Connection in Container:3448315ac2834f28f611653e79764663","rule:Linux Kernel Module Injection Detected:41258ebe4f0565b8c3c1ddd96663c1a6","rule:Debugfs Launched in Privileged Container:6a074afb1d46b7c8e242bf8390fc101c","rule:Detect release_agent File Container Escapes:d55778da6b1e973e75c07a0379882547","rule:Drop and execute new binary in container:ea1bc081c535967ed009cd4b0a4d9df6","rule:Create Disallowed Pod:8d71d5de24654fe16db931fbda68825e","macro:sensitive_vol_mount:621cd5c512333ac20ba436785be6b179","rule:EphemeralContainers Created:17704f4c40a6f889fa7fc1b666857271","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Change namespace privileges via unshare:1447a5e5cc069325af45954d0d349353","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa","macro:known_user_in_container:068a3f594dcb9921289b7525ef804824","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:User mgmt binaries:64fa846d6a699ae484ef6dd7e3cea898","rule:Contact EC2 Instance Metadata Service From Container:ba11587ae5bd52a9b3873b053ab19802","rule:Contact cloud metadata service from container:8fb7d622c5da0bd431e4d6d7f7da0f9d","rule:Launch Package Management Process in Container:2acaeee8988b0854328b0fbe8c9cf63f","rule:Launch Suspicious Network Tool in Container:40dd680345890489ed62556af30c3fb2","rule:Launch Suspicious Network Tool on Host:d37b5ddbe83eb9c31c805ae5973d2553","rule:Launch Remote File Copy Tools in Container:a5e84b7971a3ef1f4e58af94ed66f4a1","rule:Network Connection outside Local Subnet:206cb97c10e38d639e03767466f289e0","rule:Mount Launched in Privileged Container:311052adcd61d744123971225f1ccd80","rule:Launch Ingress Remote File Copy Tools in Container:bceeb580cbb40da58fb1e3045bea84a5","rule:Read environment variable from /proc files:e91c2ad7d9bb08b8cbaae183f91bf00c","macro:container_entrypoint:26bc459b2105c039deb4460ebd89573f","rule:Exfiltrating Artifacts via Kubernetes Control Plane:895b0567a065496ab1c5e877c9afc8c7","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:jboss_in_container_writing_passwd:e104575a302efede918aaae611ba6fac","macro:etcd_manager_updating_dns:b7185f0f1766ee6887147bf0d00c4500","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017","rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49","rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3","macro:user_known_k8s_client_container_parens:2fdfd506ad251627b22d33c77dee9957","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22","rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3","rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3","rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81"],"type":"macro","hash":"5f0b6ebc4bea10285ba2b8a6ce78b863","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L330,L331","required_engine_version":"0.35.0","name":"container_started","macro":"container_started","condition":"((evt.type = container or\n (spawned_process and proc.vpid=1)) and\n container.image.repository != incomplete)\n","tags":null,"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Launch Privileged Container:b2519a12fb87e0645a80043bd931f62f","rule:Launch Excessively Capable Container:8091ae198eef3f103d229b04597684aa","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017","rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49"],"type":"macro","hash":"9c5e39660ca4df75897d1230d8dbae77","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Possible scripts run by sshkit","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L337,L338","required_engine_version":"0.35.0","name":"sshkit_script_binaries","list":"sshkit_script_binaries","items":["10_etc_sudoers.","10_passwd_group"],"tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"ce44254edc701be4dd47f06f9052328d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L340,L341","required_engine_version":"0.35.0","name":"plesk_binaries","list":"plesk_binaries","items":["sw-engine","sw-engine-fpm","sw-engine-kv","filemng","f2bmng"],"tags":null,"enabled":"true","used_by":["macro:plesk_writing_keys:4da16c23c5ff08f7d7d5746a31b4c73f","macro:plesk_running_mktemp:8a74ab2db773d17eb5f84197a8845e82"],"type":"list","hash":"2bb4a140a43b81a2b7ec6a6e601a2e07","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L343,L344","required_engine_version":"0.35.0","name":"httpd_writing_ssl_conf","macro":"httpd_writing_ssl_conf","condition":"(proc.pname=run-httpd and\n (proc.cmdline startswith \"sed -ri\" or proc.cmdline startswith \"sed -i\") and\n (fd.name startswith /etc/httpd/conf.d/ or fd.name startswith /etc/httpd/conf))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"7717b6e122b01d443ae2430e68910510","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L349,L350","required_engine_version":"0.35.0","name":"userhelper_writing_etc_security","macro":"userhelper_writing_etc_security","condition":"(proc.name=userhelper and fd.name startswith /etc/security)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"5b54daec63358f270e55637b64058af8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L352,L353","required_engine_version":"0.35.0","name":"ansible_running_python","macro":"ansible_running_python","condition":"(proc.name in (python, pypy, python3) and proc.cmdline contains ansible)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"32953f9f3a0f3f017f72d291abad0fd5","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L355,L356","required_engine_version":"0.35.0","name":"python_running_chef","macro":"python_running_chef","condition":"(proc.name=python and (proc.cmdline contains yum-dump.py or proc.cmdline=\"python /usr/bin/chef-monitor.py\"))","tags":null,"enabled":"true","used_by":["rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"73eaeb68ecea5a4c89f0489e055d5c08","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L358,L359","required_engine_version":"0.35.0","name":"python_running_denyhosts","macro":"python_running_denyhosts","condition":"(proc.name=python and (proc.cmdline contains /usr/sbin/denyhosts or\n proc.cmdline contains /usr/local/bin/denyhosts.py))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"fc718637fdaec732d1d810a48d8d21a2","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L364,L365","required_engine_version":"0.35.0","name":"run_by_chef","macro":"run_by_chef","condition":"(proc.aname[2]=chef_command_wr or proc.aname[3]=chef_command_wr or proc.aname[2]=chef-client or proc.aname[3]=chef-client or proc.name=chef-client)","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e3aec37896453ee7f73bca485d8c4ef1","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L369,L370","required_engine_version":"0.35.0","name":"run_by_adclient","macro":"run_by_adclient","condition":"(proc.aname[2]=adclient or proc.aname[3]=adclient or proc.aname[4]=adclient)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b9538321da350a8ebba6eeca9441af8c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L372,L373","required_engine_version":"0.35.0","name":"run_by_centrify","macro":"run_by_centrify","condition":"(proc.aname[2]=centrify or proc.aname[3]=centrify or proc.aname[4]=centrify)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"317d5a77526cd1786085501d5e019590","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L375,L376","required_engine_version":"0.35.0","name":"parent_supervise_running_multilog","macro":"parent_supervise_running_multilog","condition":"(proc.name=multilog and proc.pname=supervise)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b21cbc58e8ae87e459675a159a044c55","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L378,L379","required_engine_version":"0.35.0","name":"supervise_writing_status","macro":"supervise_writing_status","condition":"(proc.name in (supervise,svc) and fd.name startswith \"/etc/sb/\")","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"6da103ad88e2609cb304cc6a45a9c68e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L381,L382","required_engine_version":"0.35.0","name":"pki_realm_writing_realms","macro":"pki_realm_writing_realms","condition":"(proc.cmdline startswith \"bash /usr/local/lib/pki/pki-realm\" and fd.name startswith /etc/pki/realms)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"01852a4c5ee43c97951446afa9e29845","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L384,L385","required_engine_version":"0.35.0","name":"htpasswd_writing_passwd","macro":"htpasswd_writing_passwd","condition":"(proc.name=htpasswd and fd.name=/etc/nginx/.htpasswd)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"6f77f31249e611d878bfe1fc7b6442e6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L387,L388","required_engine_version":"0.35.0","name":"lvprogs_writing_conf","macro":"lvprogs_writing_conf","condition":"(proc.name in (dmeventd,lvcreate,pvscan,lvs) and\n (fd.name startswith /etc/lvm/archive or\n  fd.name startswith /etc/lvm/backup or\n  fd.name startswith /etc/lvm/cache))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"82d246081a521d9cb8e300313391dfa8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L394,L395","required_engine_version":"0.35.0","name":"ovsdb_writing_openvswitch","macro":"ovsdb_writing_openvswitch","condition":"(proc.name=ovsdb-server and fd.directory=/etc/openvswitch)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b2d310885a097b33ff0d871f1f3c0d3c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L397,L398","required_engine_version":"0.35.0","name":"parent_ucf_writing_conf","macro":"parent_ucf_writing_conf","condition":"(proc.pname=ucf and proc.aname[2]=frontend)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"70f4b154b854dd439720ac1d4bc64455","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L400,L401","required_engine_version":"0.35.0","name":"consul_template_writing_conf","macro":"consul_template_writing_conf","condition":"((proc.name=consul-template and fd.name startswith /etc/haproxy) or\n (proc.name=reload.sh and proc.aname[2]=consul-template and fd.name startswith /etc/ssl))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"2dfcdb71f28b194e3ec22c43e2c8615e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L405,L406","required_engine_version":"0.35.0","name":"countly_writing_nginx_conf","macro":"countly_writing_nginx_conf","condition":"(proc.cmdline startswith \"nodejs /opt/countly/bin\" and fd.name startswith /etc/nginx)","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"9f036fc92d9d76325370070d05d88fb7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L408,L409","required_engine_version":"0.35.0","name":"ms_oms_binaries","list":"ms_oms_binaries","items":["omi.postinst","omsconfig.posti","scx.postinst","omsadmin.sh","omiagent"],"tags":null,"enabled":"true","used_by":["macro:ms_oms_writing_conf:f2738c65b1491db569e64832b156a9ee"],"type":"list","hash":"6e2e333b8d6e5a41c98d7049885db9e6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L411,L412","required_engine_version":"0.35.0","name":"ms_oms_writing_conf","macro":"ms_oms_writing_conf","condition":"((proc.name in (omiagent,omsagent,in_heartbeat_r*,omsadmin.sh,PerformInventor,dsc_host)\n   or proc.pname in (ms_oms_binaries)\n   or proc.aname[2] in (ms_oms_binaries))\n and (fd.name startswith /etc/opt/omi or fd.name startswith /etc/opt/microsoft/omsagent))\n","tags":null,"enabled":"true","dependencies":["list:ms_oms_binaries:6e2e333b8d6e5a41c98d7049885db9e6"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"f2738c65b1491db569e64832b156a9ee","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L418,L419","required_engine_version":"0.35.0","name":"ms_scx_writing_conf","macro":"ms_scx_writing_conf","condition":"(proc.name in (GetLinuxOS.sh) and fd.name startswith /etc/opt/microsoft/scx)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"8a6043ec2a3e7a50cd250515c22d60b4","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L421,L422","required_engine_version":"0.35.0","name":"azure_scripts_writing_conf","macro":"azure_scripts_writing_conf","condition":"(proc.pname startswith \"bash /var/lib/waagent/\" and fd.name startswith /etc/azure)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"cd53fa26b221d483142cd4dfa1f3fb6f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L424,L425","required_engine_version":"0.35.0","name":"azure_networkwatcher_writing_conf","macro":"azure_networkwatcher_writing_conf","condition":"(proc.name in (NetworkWatcherA) and fd.name=/etc/init.d/AzureNetworkWatcherAgent)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"c2a3e488810dc8a28b0127329946eaf8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L427,L428","required_engine_version":"0.35.0","name":"couchdb_writing_conf","macro":"couchdb_writing_conf","condition":"(proc.name=beam.smp and proc.cmdline contains couchdb and fd.name startswith /etc/couchdb)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"508faea2c7a0bdad8e813f9bf5698bb7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L430,L431","required_engine_version":"0.35.0","name":"update_texmf_writing_conf","macro":"update_texmf_writing_conf","condition":"(proc.name=update-texmf and fd.name startswith /etc/texmf)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"f49be0b28965ef5c2d1fa3bf265317bf","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L433,L434","required_engine_version":"0.35.0","name":"slapadd_writing_conf","macro":"slapadd_writing_conf","condition":"(proc.name=slapadd and fd.name startswith /etc/ldap)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"7d6b890322d361fbc828a93304a2450e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L436,L437","required_engine_version":"0.35.0","name":"openldap_writing_conf","macro":"openldap_writing_conf","condition":"(proc.pname=run-openldap.sh and fd.name startswith /etc/openldap)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"9f5ee55505c0b31fbfd6556343cc2c5a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L439,L440","required_engine_version":"0.35.0","name":"ucpagent_writing_conf","macro":"ucpagent_writing_conf","condition":"(proc.name=apiserver and container.image.repository=docker/ucp-agent and fd.name=/etc/authorization_config.cfg)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"2572465a9fd53c70a26f6e87b70267bb","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L442,L443","required_engine_version":"0.35.0","name":"iscsi_writing_conf","macro":"iscsi_writing_conf","condition":"(proc.name=iscsiadm and fd.name startswith /etc/iscsi)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"560f8cfa3cb01ba4c67a54ab0006a07b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L445,L446","required_engine_version":"0.35.0","name":"istio_writing_conf","macro":"istio_writing_conf","condition":"(proc.name=pilot-agent and fd.name startswith /etc/istio)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"67a1b2bc6b0ef2f677d05a2a2d5351d6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L448,L449","required_engine_version":"0.35.0","name":"symantec_writing_conf","macro":"symantec_writing_conf","condition":"((proc.name=symcfgd and fd.name startswith /etc/symantec) or\n (proc.name=navdefutil and fd.name=/etc/symc-defutils.conf))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"9cfb24ca20d7b9d3b5ce575ff8234278","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L453,L454","required_engine_version":"0.35.0","name":"liveupdate_writing_conf","macro":"liveupdate_writing_conf","condition":"(proc.cmdline startswith \"java LiveUpdate\" and fd.name in (/etc/liveupdate.conf, /etc/Product.Catalog.JavaLiveUpdate))","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e4c9b34ef4563531a648d2d56a06651f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L456,L457","required_engine_version":"0.35.0","name":"sosreport_writing_files","macro":"sosreport_writing_files","condition":"(proc.name=urlgrabber-ext- and proc.aname[3]=sosreport and\n (fd.name startswith /etc/pkt/nssdb or fd.name startswith /etc/pki/nssdb))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"bf1147eeb6acc741699e7491043b7f76","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L461,L462","required_engine_version":"0.35.0","name":"pkgmgmt_progs_writing_pki","macro":"pkgmgmt_progs_writing_pki","condition":"(proc.name=urlgrabber-ext- and proc.pname in (yum, yum-cron, repoquery) and\n (fd.name startswith /etc/pkt/nssdb or fd.name startswith /etc/pki/nssdb))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"ff9f2c85b3bcbae333e2aef5592cdd5c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L466,L467","required_engine_version":"0.35.0","name":"update_ca_trust_writing_pki","macro":"update_ca_trust_writing_pki","condition":"(proc.pname=update-ca-trust and proc.name=trust and fd.name startswith /etc/pki)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"72ae981865076595ab733f6186c786dd","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L469,L470","required_engine_version":"0.35.0","name":"brandbot_writing_os_release","macro":"brandbot_writing_os_release","condition":"(proc.name=brandbot and fd.name=/etc/os-release)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"1d4ce89967a2889d5b5ef1859927bef8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L472,L473","required_engine_version":"0.35.0","name":"selinux_writing_conf","macro":"selinux_writing_conf","condition":"(proc.name in (semodule,genhomedircon,sefcontext_comp) and fd.name startswith /etc/selinux)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"ed2fd71ea501c9fd97255024435b7639","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L475,L476","required_engine_version":"0.35.0","name":"veritas_binaries","list":"veritas_binaries","items":["vxconfigd","sfcache","vxclustadm","vxdctl","vxprint","vxdmpadm","vxdisk","vxdg","vxassist","vxtune"],"tags":null,"enabled":"true","used_by":["macro:veritas_progs:2c0c8010c4e0e4adb53d4dec2e5be024"],"type":"list","hash":"c5a2d9d80f115c32b97159687ff6af1d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L478,L479","required_engine_version":"0.35.0","name":"veritas_driver_script","macro":"veritas_driver_script","condition":"(proc.cmdline startswith \"perl /opt/VRTSsfmh/bin/mh_driver.pl\")","tags":null,"enabled":"true","used_by":["rule:Read sensitive file untrusted:5116b3ca0c5fad246cc41ca67938a315","macro:veritas_progs:2c0c8010c4e0e4adb53d4dec2e5be024"],"type":"macro","hash":"289a40694621cf340ededcb65e4c6d3b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L481,L482","required_engine_version":"0.35.0","name":"veritas_progs","macro":"veritas_progs","condition":"(proc.name in (veritas_binaries) or veritas_driver_script)","tags":null,"enabled":"true","dependencies":["macro:veritas_driver_script:289a40694621cf340ededcb65e4c6d3b","list:veritas_binaries:c5a2d9d80f115c32b97159687ff6af1d","macro:veritas_driver_script:289a40694621cf340ededcb65e4c6d3b"],"used_by":["macro:veritas_writing_config:42f6753f53d60fcb82cd743a945acdc6"],"type":"macro","hash":"2c0c8010c4e0e4adb53d4dec2e5be024","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L484,L485","required_engine_version":"0.35.0","name":"veritas_writing_config","macro":"veritas_writing_config","condition":"(veritas_progs and (fd.name startswith /etc/vx or fd.name startswith /etc/opt/VRTS or fd.name startswith /etc/vom))","tags":null,"enabled":"true","dependencies":["macro:veritas_progs:2c0c8010c4e0e4adb53d4dec2e5be024"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"42f6753f53d60fcb82cd743a945acdc6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L487,L488","required_engine_version":"0.35.0","name":"nginx_writing_conf","macro":"nginx_writing_conf","condition":"(proc.name in (nginx,nginx-ingress-c,nginx-ingress) and (fd.name startswith /etc/nginx or fd.name startswith /etc/ingress-controller))","tags":null,"enabled":"true","dependencies":["macro:ingress:17f1d7a64442cda6863a4251c2eaf2ee"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"f33ce7381e87ec371ee3892c2f4d6cbc","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L490,L491","required_engine_version":"0.35.0","name":"nginx_writing_certs","macro":"nginx_writing_certs","condition":"(((proc.name=openssl and proc.pname=nginx-launch.sh) or proc.name=nginx-launch.sh) and fd.name startswith /etc/nginx/certs)\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"ba187a3491276839d106d7782397efa9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L494,L495","required_engine_version":"0.35.0","name":"chef_client_writing_conf","macro":"chef_client_writing_conf","condition":"(proc.pcmdline startswith \"chef-client /opt/gitlab\" and fd.name startswith /etc/gitlab)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"22505d8038e267d010c12cbfa342ebd7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L497,L498","required_engine_version":"0.35.0","name":"centrify_writing_krb","macro":"centrify_writing_krb","condition":"(proc.name in (adjoin,addns) and fd.name startswith /etc/krb5)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"9602026ca828beabf63e4ca0d7c1b161","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L500,L501","required_engine_version":"0.35.0","name":"sssd_writing_krb","macro":"sssd_writing_krb","condition":"(proc.name=adcli and proc.aname[2]=sssd and fd.name startswith /etc/krb5)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"2f70fea669d4fd29a1bf3f4f88cab857","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L503,L504","required_engine_version":"0.35.0","name":"cockpit_writing_conf","macro":"cockpit_writing_conf","condition":"((proc.pname=cockpit-kube-la or proc.aname[2]=cockpit-kube-la)\n and fd.name startswith /etc/cockpit)\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"2920d2837bdec4fb86f1c80206ea5ef3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L508,L509","required_engine_version":"0.35.0","name":"ipsec_writing_conf","macro":"ipsec_writing_conf","condition":"(proc.name=start-ipsec.sh and fd.directory=/etc/ipsec)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"ecf6783879f0d8b479cbf0b1ee887b3d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L511,L512","required_engine_version":"0.35.0","name":"exe_running_docker_save","macro":"exe_running_docker_save","condition":"(proc.name = \"exe\" and (proc.cmdline contains \"/var/lib/docker\" or proc.cmdline contains \"/var/run/docker\") and proc.pname in (dockerd, docker, dockerd-current, docker-current))\n","tags":null,"enabled":"true","used_by":["rule:Modify Shell Configuration File:1b94739671e7836a3321a1f2a3720133","rule:Set Setuid or Setgid bit:8642f04ca66468a481a4ce95f4047433","rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad","rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726","rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95","rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079","rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c","rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"3870d01b317a519c449ba80c75fa2386","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Ideally we'd have a length check here as well but\n# filterchecks don't have operators like len()","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L520,L521","required_engine_version":"0.35.0","name":"sed_temporary_file","macro":"sed_temporary_file","condition":"(proc.name=sed and fd.name startswith \"/etc/sed\")","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"3fcd003bf8b6c46f2514dcc68b96a647","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L523,L524","required_engine_version":"0.35.0","name":"python_running_get_pip","macro":"python_running_get_pip","condition":"(proc.cmdline startswith \"python get-pip.py\")","tags":null,"enabled":"true","used_by":["rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"21da1ad49b484af942265ce077c901a3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L526,L527","required_engine_version":"0.35.0","name":"python_running_ms_oms","macro":"python_running_ms_oms","condition":"(proc.cmdline startswith \"python /var/lib/waagent/\")","tags":null,"enabled":"true","used_by":["rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971","rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"2da890ae6a700678d7e222629fe8a522","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L529,L530","required_engine_version":"0.35.0","name":"gugent_writing_guestagent_log","macro":"gugent_writing_guestagent_log","condition":"(proc.name=gugent and fd.name=GuestAgent.log)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"732313d0524586dd1df2b07b7f95d918","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L532,L533","required_engine_version":"0.35.0","name":"dse_writing_tmp","macro":"dse_writing_tmp","condition":"(proc.name=dse-entrypoint and fd.name=/root/tmp__)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"23d387a1dee0900bb17e8f6e09b3ec2d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L535,L536","required_engine_version":"0.35.0","name":"zap_writing_state","macro":"zap_writing_state","condition":"(proc.exe endswith java and proc.cmdline contains \"jar /zap\" and fd.name startswith /root/.ZAP)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"2609644f099cd058da317521636e7835","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L538,L539","required_engine_version":"0.35.0","name":"airflow_writing_state","macro":"airflow_writing_state","condition":"(proc.name=airflow and fd.name startswith /root/airflow)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"11df0d8eeaffbf5bee34cad073a6ceae","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L541,L542","required_engine_version":"0.35.0","name":"rpm_writing_root_rpmdb","macro":"rpm_writing_root_rpmdb","condition":"(proc.name=rpm and fd.directory=/root/.rpmdb)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"1191964954c946fe2f5ad7d598a4bd7a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L544,L545","required_engine_version":"0.35.0","name":"maven_writing_groovy","macro":"maven_writing_groovy","condition":"(proc.exe endswith java and proc.cmdline contains \"classpath /usr/local/apache-maven\" and fd.name startswith /root/.groovy)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"16e9f1ef0343f1839fb9b3deb7c4a98b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L547,L548","required_engine_version":"0.35.0","name":"chef_writing_conf","macro":"chef_writing_conf","condition":"(proc.name=chef-client and fd.name startswith /root/.chef)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"80fe25029c408ef56a9c70d77b9b2704","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L550,L551","required_engine_version":"0.35.0","name":"kubectl_writing_state","macro":"kubectl_writing_state","condition":"(proc.name in (kubectl,oc) and fd.name startswith /root/.kube)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"1957e60e3aaac0e9c51f09481a82a016","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L553,L554","required_engine_version":"0.35.0","name":"java_running_cassandra","macro":"java_running_cassandra","condition":"(proc.exe endswith java and proc.cmdline contains \"cassandra.jar\")","tags":null,"enabled":"true","used_by":["macro:protected_shell_spawner:289d0fac7ddcc0b55530dce34e2f574f","macro:cassandra_writing_state:a25a8f9fb7ff7b5377a8aff172c6450d"],"type":"macro","hash":"4007e4b4c8d21c944cab57c742f7544e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L556,L557","required_engine_version":"0.35.0","name":"cassandra_writing_state","macro":"cassandra_writing_state","condition":"(java_running_cassandra and fd.directory=/root/.cassandra)","tags":null,"enabled":"true","dependencies":["macro:java_running_cassandra:4007e4b4c8d21c944cab57c742f7544e"],"used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"a25a8f9fb7ff7b5377a8aff172c6450d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Istio","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L560,L561","required_engine_version":"0.35.0","name":"galley_writing_state","macro":"galley_writing_state","condition":"(proc.name=galley and fd.name in (known_istio_files))","tags":null,"enabled":"true","dependencies":["list:known_istio_files:3a21006d883897d6dd31d3bc30c656b3"],"used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"c21e33532a7a909818b76a705a359186","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L563,L564","required_engine_version":"0.35.0","name":"known_istio_files","list":"known_istio_files","items":["/healthready","/healthliveness"],"tags":null,"enabled":"true","used_by":["macro:galley_writing_state:c21e33532a7a909818b76a705a359186"],"type":"list","hash":"3a21006d883897d6dd31d3bc30c656b3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L566,L567","required_engine_version":"0.35.0","name":"calico_writing_state","macro":"calico_writing_state","condition":"(proc.name=kube-controller and fd.name startswith /status.json and k8s.pod.name startswith calico)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"28f51d87e4222736e8be77a05e18897e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L569,L570","required_engine_version":"0.35.0","name":"calico_writing_envvars","macro":"calico_writing_envvars","condition":"(proc.name=start_runit and fd.name startswith \"/etc/envvars\" and container.image.repository endswith \"calico/node\")","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"a1d9219fdd79e0c59e841ab828134502","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L572,L573","required_engine_version":"0.35.0","name":"repository_files","list":"repository_files","items":["sources.list"],"tags":null,"enabled":"true","used_by":["macro:access_repositories:bd582307256c69d8ce3281d92fe6a3a0"],"type":"list","hash":"5e745ef1bd8517731d8223c490782202","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L575,L576","required_engine_version":"0.35.0","name":"repository_directories","list":"repository_directories","items":["/etc/apt/sources.list.d","/etc/yum.repos.d","/etc/apt"],"tags":null,"enabled":"true","used_by":["macro:access_repositories:bd582307256c69d8ce3281d92fe6a3a0","macro:modify_repositories:681d18f94ead757b085b96d9ce501ea8"],"type":"list","hash":"02cb4704f9f994ab8e7fe6089d04610d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L578,L579","required_engine_version":"0.35.0","name":"access_repositories","macro":"access_repositories","condition":"(fd.directory in (repository_directories) or (fd.name pmatch (repository_directories) and fd.filename in (repository_files)))","tags":null,"enabled":"true","dependencies":["list:repository_files:5e745ef1bd8517731d8223c490782202","list:repository_directories:02cb4704f9f994ab8e7fe6089d04610d"],"used_by":["rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad"],"type":"macro","hash":"bd582307256c69d8ce3281d92fe6a3a0","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L583,L584","required_engine_version":"0.35.0","name":"modify_repositories","macro":"modify_repositories","condition":"(evt.arg.newpath pmatch (repository_directories))","tags":null,"enabled":"true","dependencies":["list:repository_directories:02cb4704f9f994ab8e7fe6089d04610d"],"used_by":["rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad"],"type":"macro","hash":"681d18f94ead757b085b96d9ce501ea8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L586,L587","required_engine_version":"0.35.0","name":"user_known_update_package_registry","macro":"user_known_update_package_registry","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Update Package Repository:aa330ca219f2fbf3fa0b6bf13c3eb9ad"],"type":"macro","hash":"9e4592918895a4946eeab7a831fd4c7c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# todo!: the usage of `evt.arg*` filter check in the output should be avoided\n# when more than one event type is involved because some event will populate\n# the filtercheck and others will always return \u003cNA\u003e. In this specific\n# rule, 'open_write' events don't have a `%evt.arg.newpath` argument for example so\n# we will always return `\u003cNA\u003e`.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L594,L607","required_engine_version":"0.35.0","name":"Update Package Repository","rule":"Update Package Repository","condition":"((open_write and access_repositories) or (modify and modify_repositories)) and not package_mgmt_procs and not package_mgmt_ancestor_procs and not exe_running_docker_save and not user_known_update_package_registry\n","desc":"This rule generically detects updates to package repositories and can be seen as an auditing measure.  Recommend evaluating its relevance for your specific environment.\n","output":"Repository files get updated (newpath=%evt.arg.newpath file=%fd.name pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_execution","T1072"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:package_mgmt_ancestor_procs:b5f7b9871403d1f16226b65c823c46de","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:access_repositories:bd582307256c69d8ce3281d92fe6a3a0","macro:modify_repositories:681d18f94ead757b085b96d9ce501ea8","macro:user_known_update_package_registry:9e4592918895a4946eeab7a831fd4c7c"],"type":"rule","hash":"aa330ca219f2fbf3fa0b6bf13c3eb9ad","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Users should overwrite this macro to specify conditions under which a\n# write under the binary dir is ignored. For example, it may be okay to\n# install a binary in the context of a ci/cd build.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L612,L613","required_engine_version":"0.35.0","name":"user_known_write_below_binary_dir_activities","macro":"user_known_write_below_binary_dir_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Write below binary dir:03b03b01f1c97dd7200fc23d49003971"],"type":"macro","hash":"e9327cc6148dd2254c56add6bdca831d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L615,L631","required_engine_version":"0.35.0","name":"Write below binary dir","rule":"Write below binary dir","condition":"open_write and evt.dir=\u003c  and bin_dir and not package_mgmt_procs and not exe_running_docker_save and not python_running_get_pip and not python_running_ms_oms and not user_known_write_below_binary_dir_activities\n","desc":"Trying to write to any file below specific binary directories can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"File below a known binary directory opened for writing (file=%fd.name pcmdline=%proc.pcmdline gparent=%proc.aname[2] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_persistence","T1543"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:bin_dir:d23b8731e3efa0dfa8e2c20d76fbe442","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:python_running_get_pip:21da1ad49b484af942265ce077c901a3","macro:python_running_ms_oms:2da890ae6a700678d7e222629fe8a522","macro:user_known_write_below_binary_dir_activities:e9327cc6148dd2254c56add6bdca831d"],"type":"rule","hash":"03b03b01f1c97dd7200fc23d49003971","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# If you'd like to generally monitor a wider set of directories on top\n# of the ones covered by the rule Write below binary dir, you can use\n# the following rule and lists.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L636,L637","required_engine_version":"0.35.0","name":"monitored_directories","list":"monitored_directories","items":["/boot","/lib","/lib64","/usr/lib","/usr/local/lib","/usr/local/sbin","/usr/local/bin","/root/.ssh"],"tags":null,"enabled":"true","used_by":["macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093"],"type":"list","hash":"56738cb6512762b3030762420cf280d0","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L639,L640","required_engine_version":"0.35.0","name":"user_ssh_directory","macro":"user_ssh_directory","condition":"(fd.name contains '/.ssh/' and fd.name glob '/home/*/.ssh/*')","tags":null,"enabled":"true","used_by":["rule:Directory traversal monitored file read:7c55139e8c139d003d1c3355efc40c3f","rule:Read ssh information:f7e1f0c358b9f4fb13fdb68885cf19d2","rule:Adding ssh keys to authorized_keys:a0e2c1ddd0b39a2b2f42be7646b8cfc2","macro:google_accounts_daemon_writing_ssh:2b6db0ba0430fd8423be766536193b3c","macro:cloud_init_writing_ssh:4bf6d26e36510c3b6e49059baad4d129","macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093"],"type":"macro","hash":"2cd1d449c2270b4de4a69a70a37f69fb","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# google_accounts_(daemon)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L643,L644","required_engine_version":"0.35.0","name":"google_accounts_daemon_writing_ssh","macro":"google_accounts_daemon_writing_ssh","condition":"(proc.name=google_accounts and user_ssh_directory)","tags":null,"enabled":"true","dependencies":["macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb"],"used_by":["rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"2b6db0ba0430fd8423be766536193b3c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L646,L647","required_engine_version":"0.35.0","name":"cloud_init_writing_ssh","macro":"cloud_init_writing_ssh","condition":"(proc.name=cloud-init and user_ssh_directory)","tags":null,"enabled":"true","dependencies":["macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb"],"used_by":["rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"4bf6d26e36510c3b6e49059baad4d129","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L649,L650","required_engine_version":"0.35.0","name":"mkinitramfs_writing_boot","macro":"mkinitramfs_writing_boot","condition":"(proc.pname in (mkinitramfs, update-initramf) and fd.directory=/boot)","tags":null,"enabled":"true","used_by":["macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093"],"type":"macro","hash":"0369c954206c68c6675e23c2c906d9d9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L652,L653","required_engine_version":"0.35.0","name":"monitored_dir","macro":"monitored_dir","condition":"(fd.directory in (monitored_directories)\n or user_ssh_directory)\nand not mkinitramfs_writing_boot\n","tags":null,"enabled":"true","dependencies":["macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","list:monitored_directories:56738cb6512762b3030762420cf280d0","macro:user_ssh_directory:2cd1d449c2270b4de4a69a70a37f69fb","macro:mkinitramfs_writing_boot:0369c954206c68c6675e23c2c906d9d9"],"used_by":["rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"91ff7b477466d2d58de50a490a7a8093","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to allow for specific combinations of\n# programs writing below monitored directories.\n#\n# Its default value is an expression that always is false, which\n# becomes true when the \"not ...\" in the rule is applied.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L664,L665","required_engine_version":"0.35.0","name":"user_known_write_monitored_dir_conditions","macro":"user_known_write_monitored_dir_conditions","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Write below monitored dir:311a06226782dbc56d6e23a3aa921672"],"type":"macro","hash":"08d473341b14e4bbae4157a75faab7f7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L667,L686","required_engine_version":"0.35.0","name":"Write below monitored dir","rule":"Write below monitored dir","condition":"open_write and evt.dir=\u003c and monitored_dir and not package_mgmt_procs and not coreos_write_ssh_dir and not exe_running_docker_save and not python_running_get_pip and not python_running_ms_oms and not google_accounts_daemon_writing_ssh and not cloud_init_writing_ssh and not user_known_write_monitored_dir_conditions\n","desc":"Trying to write to any file below a set of monitored directories can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"File below a monitored directory opened for writing (file=%fd.name pcmdline=%proc.pcmdline gparent=%proc.aname[2] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_persistence","T1543"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:coreos_write_ssh_dir:b0061811cd9141284dcf12fa0f09a835","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:python_running_get_pip:21da1ad49b484af942265ce077c901a3","macro:python_running_ms_oms:2da890ae6a700678d7e222629fe8a522","macro:google_accounts_daemon_writing_ssh:2b6db0ba0430fd8423be766536193b3c","macro:cloud_init_writing_ssh:4bf6d26e36510c3b6e49059baad4d129","macro:monitored_dir:91ff7b477466d2d58de50a490a7a8093","macro:user_known_write_monitored_dir_conditions:08d473341b14e4bbae4157a75faab7f7"],"type":"rule","hash":"311a06226782dbc56d6e23a3aa921672","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L688,L689","required_engine_version":"0.35.0","name":"safe_etc_dirs","list":"safe_etc_dirs","items":["/etc/cassandra","/etc/ssl/certs/java","/etc/logstash","/etc/nginx/conf.d","/etc/container_environment","/etc/hrmconfig","/etc/fluent/configs.d. /etc/alertmanager"],"tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"list","hash":"19f15eda5a54bfa6551c446d53bb6d7d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L691,L692","required_engine_version":"0.35.0","name":"fluentd_writing_conf_files","macro":"fluentd_writing_conf_files","condition":"(proc.name=start-fluentd and fd.name in (/etc/fluent/fluent.conf, /etc/td-agent/td-agent.conf))","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"21b48348dea7e566495ec1d15951129d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L694,L695","required_engine_version":"0.35.0","name":"qualys_writing_conf_files","macro":"qualys_writing_conf_files","condition":"(proc.name=qualys-cloud-ag and fd.name=/etc/qualys/cloud-agent/qagent-log.conf)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"274ba8802a00652cb183bcfc751318c9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L697,L698","required_engine_version":"0.35.0","name":"git_writing_nssdb","macro":"git_writing_nssdb","condition":"(proc.name=git-remote-http and fd.directory=/etc/pki/nssdb)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"a02f6f8e8f04ad4d8bda39383ea0eac9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L700,L701","required_engine_version":"0.35.0","name":"plesk_writing_keys","macro":"plesk_writing_keys","condition":"(proc.name in (plesk_binaries) and fd.name startswith /etc/sw/keys)","tags":null,"enabled":"true","dependencies":["list:plesk_binaries:2bb4a140a43b81a2b7ec6a6e601a2e07"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"4da16c23c5ff08f7d7d5746a31b4c73f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L703,L704","required_engine_version":"0.35.0","name":"plesk_install_writing_apache_conf","macro":"plesk_install_writing_apache_conf","condition":"(proc.cmdline startswith \"bash -hB /usr/lib/plesk-9.0/services/webserver.apache configure\" and fd.name=\"/etc/apache2/apache2.conf.tmp\")","tags":null,"enabled":"true","dependencies":["macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b1645f2efd8de69398708897f91f9684","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L707,L708","required_engine_version":"0.35.0","name":"plesk_running_mktemp","macro":"plesk_running_mktemp","condition":"(proc.name=mktemp and proc.aname[3] in (plesk_binaries))","tags":null,"enabled":"true","dependencies":["list:plesk_binaries:2bb4a140a43b81a2b7ec6a6e601a2e07"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"8a74ab2db773d17eb5f84197a8845e82","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L710,L711","required_engine_version":"0.35.0","name":"networkmanager_writing_resolv_conf","macro":"networkmanager_writing_resolv_conf","condition":"(proc.aname[2]=nm-dispatcher and fd.name=/etc/resolv.conf)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"81b1d609f080d36d693367ea4fd9747b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L713,L714","required_engine_version":"0.35.0","name":"add_shell_writing_shells_tmp","macro":"add_shell_writing_shells_tmp","condition":"(proc.name=add-shell and fd.name=/etc/shells.tmp)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"db49b924fa80a852f8b7cbd1c2ce3c05","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L716,L717","required_engine_version":"0.35.0","name":"duply_writing_exclude_files","macro":"duply_writing_exclude_files","condition":"(proc.name=touch and proc.pcmdline startswith \"bash /usr/bin/duply\" and fd.name startswith \"/etc/duply\")","tags":null,"enabled":"true","dependencies":["macro:dup:0e9f1e8e40bb79e800b0cc9433830cf4"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"7e582f2eb2af9630a1c3cfd1c715fd18","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L719,L720","required_engine_version":"0.35.0","name":"xmlcatalog_writing_files","macro":"xmlcatalog_writing_files","condition":"(proc.name=update-xmlcatal and fd.directory=/etc/xml)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"30103ce6f9bed986c1da7c3909bb9197","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L722,L723","required_engine_version":"0.35.0","name":"datadog_writing_conf","macro":"datadog_writing_conf","condition":"((proc.cmdline startswith \"python /opt/datadog-agent\" or proc.cmdline startswith \"entrypoint.sh /entrypoint.sh datadog start\" or proc.cmdline startswith \"agent.py /opt/datadog-agent\") and fd.name startswith \"/etc/dd-agent\")","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"ab0b00093dfe41fcd2e23ba0f6ee9f3f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L728,L729","required_engine_version":"0.35.0","name":"rancher_writing_conf","macro":"rancher_writing_conf","condition":"((proc.name in (healthcheck, lb-controller, rancher-dns)) and (container.image.repository contains \"rancher/healthcheck\" or container.image.repository contains \"rancher/lb-service-haproxy\" or container.image.repository contains \"rancher/dns\") and (fd.name startswith \"/etc/haproxy\" or fd.name startswith \"/etc/rancher-dns\"))","tags":null,"enabled":"true","dependencies":["macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"8b1f4bfa74e091fb880570e839ff8d41","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L735,L736","required_engine_version":"0.35.0","name":"rancher_writing_root","macro":"rancher_writing_root","condition":"(proc.name=rancher-metadat and (container.image.repository contains \"rancher/metadata\" or container.image.repository contains \"rancher/lb-service-haproxy\") and fd.name startswith \"/answers.json\")","tags":null,"enabled":"true","dependencies":["macro:service:aaabf0d39951f3e6c3e8a7911df524c2"],"used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"687f66c964ff5e546b31a18570c553a2","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L740,L741","required_engine_version":"0.35.0","name":"checkpoint_writing_state","macro":"checkpoint_writing_state","condition":"(proc.name=checkpoint and container.image.repository contains \"coreos/pod-checkpointer\" and fd.name startswith \"/etc/kubernetes\")","tags":null,"enabled":"true","dependencies":["macro:pod:dcc0caa97588ee058c2fcd764e5f919b"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"030543659efa642294c18d47aa7fcc40","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L745,L746","required_engine_version":"0.35.0","name":"jboss_in_container_writing_passwd","macro":"jboss_in_container_writing_passwd","condition":"((proc.cmdline=\"run-java.sh /opt/jboss/container/java/run/run-java.sh\"\n  or proc.cmdline=\"run-java.sh /opt/run-java/run-java.sh\")\n and container\n and fd.name=/etc/passwd)\n","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"e104575a302efede918aaae611ba6fac","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L752,L753","required_engine_version":"0.35.0","name":"curl_writing_pki_db","macro":"curl_writing_pki_db","condition":"(proc.name=curl and fd.directory=/etc/pki/nssdb)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"561df73ccb5172d7164ad7e42b7ffe71","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L755,L756","required_engine_version":"0.35.0","name":"haproxy_writing_conf","macro":"haproxy_writing_conf","condition":"((proc.name in (update-haproxy-,haproxy_reload.) or proc.pname in (update-haproxy-,haproxy_reload,haproxy_reload.)) and (fd.name=/etc/openvpn/client.map or fd.name startswith /etc/haproxy))","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b66d59f8de2e3a3f6fa9f1f9b70c3e80","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L759,L760","required_engine_version":"0.35.0","name":"java_writing_conf","macro":"java_writing_conf","condition":"(proc.exe endswith java and fd.name=/etc/.java/.systemPrefs/.system.lock)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"7d99db523f6d601218d16d4ebcc4b5c5","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L762,L763","required_engine_version":"0.35.0","name":"rabbitmq_writing_conf","macro":"rabbitmq_writing_conf","condition":"(proc.name=rabbitmq-server and fd.directory=/etc/rabbitmq)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"06d81ac4ca65ddadf3444e1714a51da5","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L765,L766","required_engine_version":"0.35.0","name":"rook_writing_conf","macro":"rook_writing_conf","condition":"(proc.name=toolbox.sh and container.image.repository=rook/toolbox and fd.directory=/etc/ceph)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"614afd80c1f79ead045f455f66c921a2","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L769,L770","required_engine_version":"0.35.0","name":"httpd_writing_conf_logs","macro":"httpd_writing_conf_logs","condition":"(proc.name=httpd and fd.name startswith /etc/httpd/)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"818ee313d210d65a9dbeee107fb66d90","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L772,L773","required_engine_version":"0.35.0","name":"mysql_writing_conf","macro":"mysql_writing_conf","condition":"((proc.name in (start-mysql.sh, run-mysqld) or proc.pname=start-mysql.sh) and\n (fd.name startswith /etc/mysql or fd.directory=/etc/my.cnf.d))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"625dd47184b82bf4bec3d566962dd430","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L777,L778","required_engine_version":"0.35.0","name":"redis_writing_conf","macro":"redis_writing_conf","condition":"(proc.name in (run-redis, redis-launcher.) and (fd.name=/etc/redis.conf or fd.name startswith /etc/redis))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"a901edd045ee0e7597eef5fcf133043b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L781,L782","required_engine_version":"0.35.0","name":"openvpn_writing_conf","macro":"openvpn_writing_conf","condition":"(proc.name in (openvpn,openvpn-entrypo) and fd.name startswith /etc/openvpn)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"d428826792d22085abee4a5b7fb96195","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L784,L785","required_engine_version":"0.35.0","name":"php_handlers_writing_conf","macro":"php_handlers_writing_conf","condition":"(proc.name=php_handlers_co and fd.name=/etc/psa/php_versions.json)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"5e0d13ac7f509af8cff0ce9cb268fb0f","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L787,L788","required_engine_version":"0.35.0","name":"sed_writing_temp_file","macro":"sed_writing_temp_file","condition":"((proc.aname[3]=cron_start.sh and fd.name startswith /etc/security/sed) or\n (proc.name=sed and (fd.name startswith /etc/apt/sources.list.d/sed or\n                     fd.name startswith /etc/apt/sed or\n                     fd.name startswith /etc/apt/apt.conf.d/sed)))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"685fed60dc978304a1e497788d4d71a7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L794,L795","required_engine_version":"0.35.0","name":"cron_start_writing_pam_env","macro":"cron_start_writing_pam_env","condition":"(proc.cmdline=\"bash /usr/sbin/start-cron\" and fd.name=/etc/security/pam_env.conf)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"a1ce9663b50cdb8d111513a092015386","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# In some cases dpkg-reconfigur runs commands that modify /etc. Not\n# putting the full set of package management programs yet.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L799,L800","required_engine_version":"0.35.0","name":"dpkg_scripting","macro":"dpkg_scripting","condition":"(proc.aname[2] in (dpkg-reconfigur, dpkg-preconfigu))","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"3553acf980466204b4c57a6f426865e9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L802,L803","required_engine_version":"0.35.0","name":"ufw_writing_conf","macro":"ufw_writing_conf","condition":"(proc.name=ufw and fd.directory=/etc/ufw)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"04ade91384da94d9c65985422829393b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L805,L806","required_engine_version":"0.35.0","name":"calico_writing_conf","macro":"calico_writing_conf","condition":"(((proc.name = calico-node) or\n  (container.image.repository=gcr.io/projectcalico-org/node and proc.name in (start_runit, cp)) or\n  (container.image.repository=gcr.io/projectcalico-org/cni and proc.name=sed))\n and fd.name startswith /etc/calico)\n","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"fb5d431d5974e4f9d0fa2072d97d0b35","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L812,L813","required_engine_version":"0.35.0","name":"prometheus_conf_writing_conf","macro":"prometheus_conf_writing_conf","condition":"(proc.name=prometheus-conf and fd.name startswith /etc/prometheus/config_out)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"da4dd39078c116ddaf157d974182c2c3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L815,L816","required_engine_version":"0.35.0","name":"openshift_writing_conf","macro":"openshift_writing_conf","condition":"(proc.name=oc and fd.name startswith /etc/origin/node)","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"df511403cf15d1a11797346f6cf6efd0","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L818,L819","required_engine_version":"0.35.0","name":"keepalived_writing_conf","macro":"keepalived_writing_conf","condition":"(proc.name in (keepalived, kube-keepalived) and fd.name=/etc/keepalived/keepalived.conf)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"c5484c875db4d3a493f0c2899110e2e8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L821,L822","required_engine_version":"0.35.0","name":"etcd_manager_updating_dns","macro":"etcd_manager_updating_dns","condition":"(container and proc.name=etcd-manager and fd.name=/etc/hosts)","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"b7185f0f1766ee6887147bf0d00c4500","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L824,L825","required_engine_version":"0.35.0","name":"automount_using_mtab","macro":"automount_using_mtab","condition":"(proc.pname = automount and fd.name startswith /etc/mtab)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"55d040454646420d840cafa7184e1c3e","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L827,L828","required_engine_version":"0.35.0","name":"mcafee_writing_cma_d","macro":"mcafee_writing_cma_d","condition":"(proc.name=macompatsvc and fd.directory=/etc/cma.d)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"0b753f47d192cab4ca77b3f8fffd6bcc","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L830,L831","required_engine_version":"0.35.0","name":"avinetworks_supervisor_writing_ssh","macro":"avinetworks_supervisor_writing_ssh","condition":"(proc.cmdline=\"se_supervisor.p /opt/avi/scripts/se_supervisor.py -d\" and\n  (fd.name startswith /etc/ssh/known_host_ or\n   fd.name startswith /etc/ssh/ssh_monitor_config_ or\n   fd.name startswith /etc/ssh/ssh_config_))\n","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"5104f9e306a250e9bd681bbabc24b416","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L837,L838","required_engine_version":"0.35.0","name":"etckeeper_activities","macro":"etckeeper_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:etckeeper:7b5e20e26d41ffd177d7c66abc5bcb1a"],"type":"macro","hash":"1e5781086c2cc3322cf517ae6e095ccc","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L840,L841","required_engine_version":"0.35.0","name":"etckeeper","macro":"etckeeper","condition":"(proc.aname = etckeeper\n or (proc.aname in (50vcs-commit, 30store-metadata, 50uncommitted-c))\nand (fd.name startswith /etc/.git/\n     or fd.name = /etc/.etckeeper)\nand etckeeper_activities)\n","tags":null,"enabled":"true","dependencies":["macro:etckeeper_activities:1e5781086c2cc3322cf517ae6e095ccc"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"7b5e20e26d41ffd177d7c66abc5bcb1a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L848,L849","required_engine_version":"0.35.0","name":"multipath_writing_conf","macro":"multipath_writing_conf","condition":"(proc.name = multipath and fd.name startswith /etc/multipath/)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"a41f372e44d66f6251083d6a6b345835","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to allow for specific combinations of\n# programs writing below specific directories below\n# /etc. fluentd_writing_conf_files is a good example to follow, as it\n# specifies both the program doing the writing as well as the specific\n# files it is allowed to modify.\n#\n# In this file, it just takes one of the programs in the base macro\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L860,L861","required_engine_version":"0.35.0","name":"user_known_write_etc_conditions","macro":"user_known_write_etc_conditions","condition":"(proc.name=confd)","tags":null,"enabled":"true","used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"1048595dcb5c5925590a8ef893eeef36","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This is a placeholder for user to extend the whitelist for write below etc rule","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L864,L865","required_engine_version":"0.35.0","name":"user_known_write_below_etc_activities","macro":"user_known_write_below_etc_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"1481c66148493216582035ff05ba2863","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L867,L868","required_engine_version":"0.35.0","name":"calico_node","macro":"calico_node","condition":"(container.image.repository endswith calico/node and proc.name=calico-node)","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"macro","hash":"0c80dcb500a0a30309af5fd40e9971fa","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L870,L871","required_engine_version":"0.35.0","name":"write_etc_common","macro":"write_etc_common","condition":"(open_write  and etc_dir and evt.dir=\u003c  and proc_name_exists and not proc.name in (passwd_binaries, shadowutils_binaries, sysdigcloud_binaries,\n                      package_mgmt_binaries, ssl_mgmt_binaries, dhcp_binaries,\n                      dev_creation_binaries, shell_mgmt_binaries,\n                      mail_config_binaries,\n                      sshkit_script_binaries,\n                      ldconfig.real, ldconfig, confd, gpg, insserv,\n                      apparmor_parser, update-mime, tzdata.config, tzdata.postinst,\n                      systemd, systemd-machine, systemd-sysuser,\n                      debconf-show, rollerd, bind9.postinst, sv,\n                      gen_resolvconf., update-ca-certi, certbot, runsv,\n                      qualys-cloud-ag, locales.postins, nomachine_binaries,\n                      adclient, certutil, crlutil, pam-auth-update, parallels_insta,\n                      openshift-launc, update-rc.d, puppet, falcoctl)\nand not (container and proc.cmdline in (\"cp /run/secrets/kubernetes.io/serviceaccount/ca.crt /etc/pki/ca-trust/source/anchors/openshift-ca.crt\")) and not proc.pname in (sysdigcloud_binaries, mail_config_binaries, hddtemp.postins, sshkit_script_binaries, locales.postins, deb_binaries, dhcp_binaries) and not fd.name pmatch (safe_etc_dirs) and not fd.name in (/etc/container_environment.sh, /etc/container_environment.json, /etc/motd, /etc/motd.svc) and not sed_temporary_file and not exe_running_docker_save and not ansible_running_python and not python_running_denyhosts and not fluentd_writing_conf_files and not user_known_write_etc_conditions and not run_by_centrify and not run_by_adclient and not qualys_writing_conf_files and not git_writing_nssdb and not plesk_writing_keys and not plesk_install_writing_apache_conf and not plesk_running_mktemp and not networkmanager_writing_resolv_conf and not run_by_chef and not add_shell_writing_shells_tmp and not duply_writing_exclude_files and not xmlcatalog_writing_files and not parent_supervise_running_multilog and not supervise_writing_status and not pki_realm_writing_realms and not htpasswd_writing_passwd and not lvprogs_writing_conf and not ovsdb_writing_openvswitch and not datadog_writing_conf and not curl_writing_pki_db and not haproxy_writing_conf and not java_writing_conf and not dpkg_scripting and not parent_ucf_writing_conf and not rabbitmq_writing_conf and not rook_writing_conf and not php_handlers_writing_conf and not sed_writing_temp_file and not cron_start_writing_pam_env and not httpd_writing_conf_logs and not mysql_writing_conf and not openvpn_writing_conf and not consul_template_writing_conf and not countly_writing_nginx_conf and not ms_oms_writing_conf and not ms_scx_writing_conf and not azure_scripts_writing_conf and not azure_networkwatcher_writing_conf and not couchdb_writing_conf and not update_texmf_writing_conf and not slapadd_writing_conf and not symantec_writing_conf and not liveupdate_writing_conf and not sosreport_writing_files and not selinux_writing_conf and not veritas_writing_config and not nginx_writing_conf and not nginx_writing_certs and not chef_client_writing_conf and not centrify_writing_krb and not sssd_writing_krb and not cockpit_writing_conf and not ipsec_writing_conf and not httpd_writing_ssl_conf and not userhelper_writing_etc_security and not pkgmgmt_progs_writing_pki and not update_ca_trust_writing_pki and not brandbot_writing_os_release and not redis_writing_conf and not openldap_writing_conf and not ucpagent_writing_conf and not iscsi_writing_conf and not istio_writing_conf and not ufw_writing_conf and not calico_writing_conf and not calico_writing_envvars and not prometheus_conf_writing_conf and not openshift_writing_conf and not keepalived_writing_conf and not rancher_writing_conf and not checkpoint_writing_state and not jboss_in_container_writing_passwd and not etcd_manager_updating_dns and not user_known_write_below_etc_activities and not automount_using_mtab and not mcafee_writing_cma_d and not avinetworks_supervisor_writing_ssh and not etckeeper and not multipath_writing_conf and not calico_node)\n","tags":null,"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:dup:0e9f1e8e40bb79e800b0cc9433830cf4","macro:etc_dir:e750c953eb53022a0b566477ad6e8090","list:passwd_binaries:11d902c686355a4df0580d2b954301da","list:shadowutils_binaries:dd53fb0d2784a8a52ac3c20ab275de72","list:deb_binaries:69ab88691c72177ecff691379ff122c4","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_config_binaries:b7be6fc7d0d3734f0bdfda0a81accc5f","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:sshkit_script_binaries:ce44254edc701be4dd47f06f9052328d","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:run_by_chef:e3aec37896453ee7f73bca485d8c4ef1","macro:service:aaabf0d39951f3e6c3e8a7911df524c2","macro:serviceaccount:618c2280ccb9083ae6152f4eaec58a86","macro:secret:5ebe2294ecd0e0f08eab7690d2a6ee69","macro:node:36c4536996ca5615dcf9911f068786dc","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","list:passwd_binaries:11d902c686355a4df0580d2b954301da","list:shadowutils_binaries:dd53fb0d2784a8a52ac3c20ab275de72","list:sysdigcloud_binaries:5cd4a552978d2b6ed446f11f8a294cbf","list:deb_binaries:69ab88691c72177ecff691379ff122c4","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:dev_creation_binaries:2de5fcfae70913478022a9d4bd879f48","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:etc_dir:e750c953eb53022a0b566477ad6e8090","list:shell_mgmt_binaries:2aa25fb259f9af8c31404e0549391a25","list:passwd_binaries:11d902c686355a4df0580d2b954301da","list:shadowutils_binaries:dd53fb0d2784a8a52ac3c20ab275de72","list:sysdigcloud_binaries:5cd4a552978d2b6ed446f11f8a294cbf","list:deb_binaries:69ab88691c72177ecff691379ff122c4","list:package_mgmt_binaries:cbd791c45a9d5d51118aaf6c9ce6b934","list:ssl_mgmt_binaries:e0e9a45ab08f5ea27e6fe93ae471d074","list:dhcp_binaries:e590b0b0424c28ab433a99a955c907bb","list:dev_creation_binaries:2de5fcfae70913478022a9d4bd879f48","list:nomachine_binaries:be10dcfdff8f673dfb82d8bed97c68b9","list:mail_config_binaries:b7be6fc7d0d3734f0bdfda0a81accc5f","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:sshkit_script_binaries:ce44254edc701be4dd47f06f9052328d","macro:httpd_writing_ssl_conf:7717b6e122b01d443ae2430e68910510","macro:userhelper_writing_etc_security:5b54daec63358f270e55637b64058af8","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:python_running_denyhosts:fc718637fdaec732d1d810a48d8d21a2","macro:run_by_chef:e3aec37896453ee7f73bca485d8c4ef1","macro:run_by_adclient:b9538321da350a8ebba6eeca9441af8c","macro:run_by_centrify:317d5a77526cd1786085501d5e019590","macro:parent_supervise_running_multilog:b21cbc58e8ae87e459675a159a044c55","macro:supervise_writing_status:6da103ad88e2609cb304cc6a45a9c68e","macro:pki_realm_writing_realms:01852a4c5ee43c97951446afa9e29845","macro:htpasswd_writing_passwd:6f77f31249e611d878bfe1fc7b6442e6","macro:lvprogs_writing_conf:82d246081a521d9cb8e300313391dfa8","macro:ovsdb_writing_openvswitch:b2d310885a097b33ff0d871f1f3c0d3c","macro:parent_ucf_writing_conf:70f4b154b854dd439720ac1d4bc64455","macro:consul_template_writing_conf:2dfcdb71f28b194e3ec22c43e2c8615e","macro:countly_writing_nginx_conf:9f036fc92d9d76325370070d05d88fb7","macro:ms_oms_writing_conf:f2738c65b1491db569e64832b156a9ee","macro:ms_scx_writing_conf:8a6043ec2a3e7a50cd250515c22d60b4","macro:azure_scripts_writing_conf:cd53fa26b221d483142cd4dfa1f3fb6f","macro:azure_networkwatcher_writing_conf:c2a3e488810dc8a28b0127329946eaf8","macro:couchdb_writing_conf:508faea2c7a0bdad8e813f9bf5698bb7","macro:update_texmf_writing_conf:f49be0b28965ef5c2d1fa3bf265317bf","macro:slapadd_writing_conf:7d6b890322d361fbc828a93304a2450e","macro:openldap_writing_conf:9f5ee55505c0b31fbfd6556343cc2c5a","macro:ucpagent_writing_conf:2572465a9fd53c70a26f6e87b70267bb","macro:iscsi_writing_conf:560f8cfa3cb01ba4c67a54ab0006a07b","macro:istio_writing_conf:67a1b2bc6b0ef2f677d05a2a2d5351d6","macro:symantec_writing_conf:9cfb24ca20d7b9d3b5ce575ff8234278","macro:liveupdate_writing_conf:e4c9b34ef4563531a648d2d56a06651f","macro:sosreport_writing_files:bf1147eeb6acc741699e7491043b7f76","macro:pkgmgmt_progs_writing_pki:ff9f2c85b3bcbae333e2aef5592cdd5c","macro:update_ca_trust_writing_pki:72ae981865076595ab733f6186c786dd","macro:brandbot_writing_os_release:1d4ce89967a2889d5b5ef1859927bef8","macro:selinux_writing_conf:ed2fd71ea501c9fd97255024435b7639","macro:veritas_writing_config:42f6753f53d60fcb82cd743a945acdc6","macro:nginx_writing_conf:f33ce7381e87ec371ee3892c2f4d6cbc","macro:nginx_writing_certs:ba187a3491276839d106d7782397efa9","macro:chef_client_writing_conf:22505d8038e267d010c12cbfa342ebd7","macro:centrify_writing_krb:9602026ca828beabf63e4ca0d7c1b161","macro:sssd_writing_krb:2f70fea669d4fd29a1bf3f4f88cab857","macro:cockpit_writing_conf:2920d2837bdec4fb86f1c80206ea5ef3","macro:ipsec_writing_conf:ecf6783879f0d8b479cbf0b1ee887b3d","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:sed_temporary_file:3fcd003bf8b6c46f2514dcc68b96a647","macro:calico_writing_envvars:a1d9219fdd79e0c59e841ab828134502","list:safe_etc_dirs:19f15eda5a54bfa6551c446d53bb6d7d","macro:fluentd_writing_conf_files:21b48348dea7e566495ec1d15951129d","macro:qualys_writing_conf_files:274ba8802a00652cb183bcfc751318c9","macro:git_writing_nssdb:a02f6f8e8f04ad4d8bda39383ea0eac9","macro:plesk_writing_keys:4da16c23c5ff08f7d7d5746a31b4c73f","macro:plesk_install_writing_apache_conf:b1645f2efd8de69398708897f91f9684","macro:plesk_running_mktemp:8a74ab2db773d17eb5f84197a8845e82","macro:networkmanager_writing_resolv_conf:81b1d609f080d36d693367ea4fd9747b","macro:add_shell_writing_shells_tmp:db49b924fa80a852f8b7cbd1c2ce3c05","macro:duply_writing_exclude_files:7e582f2eb2af9630a1c3cfd1c715fd18","macro:xmlcatalog_writing_files:30103ce6f9bed986c1da7c3909bb9197","macro:datadog_writing_conf:ab0b00093dfe41fcd2e23ba0f6ee9f3f","macro:rancher_writing_conf:8b1f4bfa74e091fb880570e839ff8d41","macro:checkpoint_writing_state:030543659efa642294c18d47aa7fcc40","macro:jboss_in_container_writing_passwd:e104575a302efede918aaae611ba6fac","macro:curl_writing_pki_db:561df73ccb5172d7164ad7e42b7ffe71","macro:haproxy_writing_conf:b66d59f8de2e3a3f6fa9f1f9b70c3e80","macro:java_writing_conf:7d99db523f6d601218d16d4ebcc4b5c5","macro:rabbitmq_writing_conf:06d81ac4ca65ddadf3444e1714a51da5","macro:rook_writing_conf:614afd80c1f79ead045f455f66c921a2","macro:httpd_writing_conf_logs:818ee313d210d65a9dbeee107fb66d90","macro:mysql_writing_conf:625dd47184b82bf4bec3d566962dd430","macro:redis_writing_conf:a901edd045ee0e7597eef5fcf133043b","macro:openvpn_writing_conf:d428826792d22085abee4a5b7fb96195","macro:php_handlers_writing_conf:5e0d13ac7f509af8cff0ce9cb268fb0f","macro:sed_writing_temp_file:685fed60dc978304a1e497788d4d71a7","macro:cron_start_writing_pam_env:a1ce9663b50cdb8d111513a092015386","macro:dpkg_scripting:3553acf980466204b4c57a6f426865e9","macro:ufw_writing_conf:04ade91384da94d9c65985422829393b","macro:calico_writing_conf:fb5d431d5974e4f9d0fa2072d97d0b35","macro:prometheus_conf_writing_conf:da4dd39078c116ddaf157d974182c2c3","macro:openshift_writing_conf:df511403cf15d1a11797346f6cf6efd0","macro:keepalived_writing_conf:c5484c875db4d3a493f0c2899110e2e8","macro:etcd_manager_updating_dns:b7185f0f1766ee6887147bf0d00c4500","macro:automount_using_mtab:55d040454646420d840cafa7184e1c3e","macro:mcafee_writing_cma_d:0b753f47d192cab4ca77b3f8fffd6bcc","macro:avinetworks_supervisor_writing_ssh:5104f9e306a250e9bd681bbabc24b416","macro:etckeeper:7b5e20e26d41ffd177d7c66abc5bcb1a","macro:multipath_writing_conf:a41f372e44d66f6251083d6a6b345835","macro:user_known_write_etc_conditions:1048595dcb5c5925590a8ef893eeef36","macro:user_known_write_below_etc_activities:1481c66148493216582035ff05ba2863","macro:calico_node:0c80dcb500a0a30309af5fd40e9971fa"],"used_by":["rule:Write below etc:c8c11ba077e4a8a62b93ed1136eb79b8"],"type":"macro","hash":"43c4c0ef98f61b5250120719de06b726","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L979,L988","required_engine_version":"0.35.0","name":"Write below etc","rule":"Write below etc","condition":"write_etc_common","desc":"Trying to write to any file below /etc can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"File below /etc opened for writing (file=%fd.name pcmdline=%proc.pcmdline gparent=%proc.aname[2] ggparent=%proc.aname[3] gggparent=%proc.aname[4] evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_persistence","T1098"],"enabled":"true","dependencies":["macro:write_etc_common:43c4c0ef98f61b5250120719de06b726"],"type":"rule","hash":"c8c11ba077e4a8a62b93ed1136eb79b8","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L990,L991","required_engine_version":"0.35.0","name":"known_root_files","list":"known_root_files","items":["/root/.monit.state","/root/.auth_tokens","/root/.bash_history","/root/.ash_history","/root/.aws/credentials","/root/.viminfo.tmp","/root/.lesshst","/root/.bzr.log","/root/.gitconfig.lock","/root/.babel.json","/root/.localstack","/root/.node_repl_history","/root/.mongorc.js","/root/.dbshell","/root/.augeas/history","/root/.rnd","/root/.wget-hsts","/health","/exec.fifo"],"tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"list","hash":"153debbfc42bcb707aa6c660776d9199","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L995,L996","required_engine_version":"0.35.0","name":"known_root_directories","list":"known_root_directories","items":["/root/.oracle_jre_usage","/root/.ssh","/root/.subversion","/root/.nami"],"tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"list","hash":"e27518da86043f462c95924d3fea63a7","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L998,L999","required_engine_version":"0.35.0","name":"known_root_conditions","macro":"known_root_conditions","condition":"(fd.name startswith /root/orcexec. or fd.name startswith /root/.m2 or fd.name startswith /root/.npm or fd.name startswith /root/.pki or fd.name startswith /root/.ivy2 or fd.name startswith /root/.config/Cypress or fd.name startswith /root/.config/pulse or fd.name startswith /root/.config/configstore or fd.name startswith /root/jenkins/workspace or fd.name startswith /root/.jenkins or fd.name startswith /root/.cache or fd.name startswith /root/.sbt or fd.name startswith /root/.java or fd.name startswith /root/.glide or fd.name startswith /root/.sonar or fd.name startswith /root/.v8flag or fd.name startswith /root/infaagent or fd.name startswith /root/.local/lib/python or fd.name startswith /root/.pm2 or fd.name startswith /root/.gnupg or fd.name startswith /root/.pgpass or fd.name startswith /root/.theano or fd.name startswith /root/.gradle or fd.name startswith /root/.android or fd.name startswith /root/.ansible or fd.name startswith /root/.crashlytics or fd.name startswith /root/.dbus or fd.name startswith /root/.composer or fd.name startswith /root/.gconf or fd.name startswith /root/.nv or fd.name startswith /root/.local/share/jupyter or fd.name startswith /root/oradiag_root or fd.name startswith /root/workspace or fd.name startswith /root/jvm or fd.name startswith /root/.node-gyp)","tags":null,"enabled":"true","dependencies":["macro:node:36c4536996ca5615dcf9911f068786dc"],"used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"c3eb88c06b723b2c8512606e49498c5d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to allow for specific combinations of\n# programs writing below specific directories below\n# / or /root.\n#\n# In this file, it just takes one of the condition in the base macro\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1042,L1043","required_engine_version":"0.35.0","name":"user_known_write_root_conditions","macro":"user_known_write_root_conditions","condition":"(fd.name=/root/.bash_history)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"5a5df0f573869913f6a73a5b67583c85","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This is a placeholder for user to extend the whitelist for write below root rule","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1046,L1047","required_engine_version":"0.35.0","name":"user_known_write_below_root_activities","macro":"user_known_write_below_root_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"b1f944844634ff62884377a1e56fca2a","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1049,L1050","required_engine_version":"0.35.0","name":"runc_writing_exec_fifo","macro":"runc_writing_exec_fifo","condition":"(proc.cmdline=\"runc:[1:CHILD] init\" and fd.name=/exec.fifo)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4","rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22"],"type":"macro","hash":"02aceef22907814c7c6d346464be2cf9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1052,L1053","required_engine_version":"0.35.0","name":"runc_writing_var_lib_docker","macro":"runc_writing_var_lib_docker","condition":"(proc.cmdline=\"runc:[1:CHILD] init\" and evt.arg.filename startswith /var/lib/docker)","tags":null,"enabled":"true","used_by":["rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22"],"type":"macro","hash":"b777a4da7476b667e5c97c94dba354fe","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1055,L1056","required_engine_version":"0.35.0","name":"mysqlsh_writing_state","macro":"mysqlsh_writing_state","condition":"(proc.name=mysqlsh and fd.directory=/root/.mysqlsh)","tags":null,"enabled":"true","used_by":["rule:Write below root:160ac2096b913f3a2ab1891192cd68e4"],"type":"macro","hash":"efa063cd5808ead6ab58b25bf9cc610b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1058,L1091","required_engine_version":"0.35.0","name":"Write below root","rule":"Write below root","condition":"open_write and evt.dir=\u003c and root_dir and proc_name_exists and not fd.name in (known_root_files) and not fd.directory pmatch (known_root_directories) and not exe_running_docker_save and not gugent_writing_guestagent_log and not dse_writing_tmp and not zap_writing_state and not airflow_writing_state and not rpm_writing_root_rpmdb and not maven_writing_groovy and not chef_writing_conf and not kubectl_writing_state and not cassandra_writing_state and not galley_writing_state and not calico_writing_state and not rancher_writing_root and not runc_writing_exec_fifo and not mysqlsh_writing_state and not known_root_conditions and not user_known_write_root_conditions and not user_known_write_below_root_activities\n","desc":"Trying to write to any file directly below / or /root can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases. Lastly, this rule stands out as potentially the noisiest one among rules related  to \"write below.\n","output":"File below / or /root opened for writing (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_persistence","TA0003"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:proc_name_exists:453387eaa91c2ac2bd725502766ed7d3","macro:root_dir:2e9c111d3f1a2373f6f2a661b4d0d49d","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:gugent_writing_guestagent_log:732313d0524586dd1df2b07b7f95d918","macro:dse_writing_tmp:23d387a1dee0900bb17e8f6e09b3ec2d","macro:zap_writing_state:2609644f099cd058da317521636e7835","macro:airflow_writing_state:11df0d8eeaffbf5bee34cad073a6ceae","macro:rpm_writing_root_rpmdb:1191964954c946fe2f5ad7d598a4bd7a","macro:maven_writing_groovy:16e9f1ef0343f1839fb9b3deb7c4a98b","macro:chef_writing_conf:80fe25029c408ef56a9c70d77b9b2704","macro:kubectl_writing_state:1957e60e3aaac0e9c51f09481a82a016","macro:cassandra_writing_state:a25a8f9fb7ff7b5377a8aff172c6450d","macro:galley_writing_state:c21e33532a7a909818b76a705a359186","macro:calico_writing_state:28f51d87e4222736e8be77a05e18897e","macro:rancher_writing_root:687f66c964ff5e546b31a18570c553a2","list:known_root_files:153debbfc42bcb707aa6c660776d9199","list:known_root_directories:e27518da86043f462c95924d3fea63a7","macro:known_root_conditions:c3eb88c06b723b2c8512606e49498c5d","macro:user_known_write_root_conditions:5a5df0f573869913f6a73a5b67583c85","macro:user_known_write_below_root_activities:b1f944844634ff62884377a1e56fca2a","macro:runc_writing_exec_fifo:02aceef22907814c7c6d346464be2cf9","macro:mysqlsh_writing_state:efa063cd5808ead6ab58b25bf9cc610b"],"type":"rule","hash":"160ac2096b913f3a2ab1891192cd68e4","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1093,L1094","required_engine_version":"0.35.0","name":"amazon_linux_running_python_yum","macro":"amazon_linux_running_python_yum","condition":"(proc.name = python and\n proc.pcmdline = \"python -m amazon_linux_extras system_motd\" and\n proc.cmdline startswith \"python -c import yum;\")\n","tags":null,"enabled":"true","used_by":["rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"2463344650ac502af0f765bb901e5c0c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1099,L1100","required_engine_version":"0.35.0","name":"user_known_write_rpm_database_activities","macro":"user_known_write_rpm_database_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Write below rpm database:6c69bfa0636d717f06c4913931ad8d95"],"type":"macro","hash":"c772da1c64ba873faf57a17e5c0af342","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Only let rpm-related programs write to the rpm database","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1103,L1120","required_engine_version":"0.35.0","name":"Write below rpm database","rule":"Write below rpm database","condition":"open_write and fd.name startswith /var/lib/rpm and not rpm_procs and not ansible_running_python and not python_running_chef and not exe_running_docker_save and not amazon_linux_running_python_yum and not user_known_write_rpm_database_activities\n","desc":"Trying to write to the rpm database by any non-rpm related program can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"rpm database opened for writing by a non-rpm program (file=%fd.name pcmdline=%proc.pcmdline evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","software_mgmt","mitre_persistence","T1072"],"enabled":"true","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:rpm_procs:4af559147e158d724c3273c0cf781a9f","macro:ansible_running_python:32953f9f3a0f3f017f72d291abad0fd5","macro:python_running_chef:73eaeb68ecea5a4c89f0489e055d5c08","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:amazon_linux_running_python_yum:2463344650ac502af0f765bb901e5c0c","macro:user_known_write_rpm_database_activities:c772da1c64ba873faf57a17e5c0af342"],"type":"rule","hash":"6c69bfa0636d717f06c4913931ad8d95","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1122,L1123","required_engine_version":"0.35.0","name":"user_known_modify_bin_dir_activities","macro":"user_known_modify_bin_dir_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Modify binary dirs:da761eca8eb4f7b26076d0f4b139f079"],"type":"macro","hash":"22c60c5fe87a748d783a1bf606652cd6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1125,L1139","required_engine_version":"0.35.0","name":"Modify binary dirs","rule":"Modify binary dirs","condition":"modify  and bin_dir_rename and not package_mgmt_procs  and not exe_running_docker_save  and not user_known_modify_bin_dir_activities\n","desc":"Trying to modify any file below a set of binary directories can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"File below known binary directory renamed/removed (file=%fd.name pcmdline=%proc.pcmdline evt_args=%evt.args evt_type=%evt.type evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_defense_evasion","T1222.002"],"enabled":"true","dependencies":["macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:rename:d7fba04fc8e17bcfc603b318a85b762c","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:bin_dir:d23b8731e3efa0dfa8e2c20d76fbe442","macro:bin_dir_rename:b186b1e54a4d9e1f1c2b31f0628253db","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:user_known_modify_bin_dir_activities:22c60c5fe87a748d783a1bf606652cd6"],"type":"rule","hash":"da761eca8eb4f7b26076d0f4b139f079","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1141,L1142","required_engine_version":"0.35.0","name":"user_known_mkdir_bin_dir_activities","macro":"user_known_mkdir_bin_dir_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Mkdir binary dirs:d7977f4987d5627ea9f04e1b0d946f2c"],"type":"macro","hash":"07904727e6d103f3e4cec0b46f15466d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1144,L1158","required_engine_version":"0.35.0","name":"Mkdir binary dirs","rule":"Mkdir binary dirs","condition":"mkdir and bin_dir_mkdir and not package_mgmt_procs and not user_known_mkdir_bin_dir_activities and not exe_running_docker_save\n","desc":"Trying to create a directory below a set of binary directories can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"Directory below known binary directory created (directory=%evt.arg.path evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_persistence","T1222.002"],"enabled":"true","dependencies":["macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:mkdir:d1c89dbbd2e4ef759c37d3e0b94e7327","macro:bin_dir:d23b8731e3efa0dfa8e2c20d76fbe442","macro:bin_dir_mkdir:f3dd593d07dba89f9350e450a35eef6b","macro:package_mgmt_procs:a69d5abbdc29f4dde6b8ec5c7d0209d6","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:user_known_mkdir_bin_dir_activities:07904727e6d103f3e4cec0b46f15466d"],"type":"rule","hash":"d7977f4987d5627ea9f04e1b0d946f2c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# https://docs.aws.amazon.com/eks/latest/userguide/add-ons-images.html\n#  official AWS EKS registry list. AWS has different ECR repo per region","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1162,L1163","required_engine_version":"0.35.0","name":"allowed_aws_ecr_registry_root_for_eks","macro":"allowed_aws_ecr_registry_root_for_eks","condition":"(container.image.repository startswith \"602401143452.dkr.ecr\" or\n container.image.repository startswith \"877085696533.dkr.ecr\" or\n container.image.repository startswith \"800184023465.dkr.ecr\" or\n container.image.repository startswith \"918309763551.dkr.ecr\" or\n container.image.repository startswith \"961992271922.dkr.ecr\" or\n container.image.repository startswith \"590381155156.dkr.ecr\" or\n container.image.repository startswith \"558608220178.dkr.ecr\" or\n container.image.repository startswith \"151742754352.dkr.ecr\" or\n container.image.repository startswith \"013241004608.dkr.ecr\")\n","tags":null,"enabled":"true","used_by":["macro:aws_eks_core_images:6146df7a3c8fbe8fc4d8439f3675a6ce","macro:aws_eks_image_sensitive_mount:3608173c8035e2501d82c68d9c1fd252"],"type":"macro","hash":"1a39a8e2c5b37345d398dcc5754b18b6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1174,L1175","required_engine_version":"0.35.0","name":"aws_eks_image_sensitive_mount","macro":"aws_eks_image_sensitive_mount","condition":"(allowed_aws_ecr_registry_root_for_eks and container.image.repository endswith \".amazonaws.com/amazon-k8s-cni\")\n","tags":null,"enabled":"true","dependencies":["macro:allowed_aws_ecr_registry_root_for_eks:1a39a8e2c5b37345d398dcc5754b18b6","macro:allowed_aws_ecr_registry_root_for_eks:1a39a8e2c5b37345d398dcc5754b18b6"],"used_by":["macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9"],"type":"macro","hash":"3608173c8035e2501d82c68d9c1fd252","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# These images are allowed both to run with --privileged and to mount\n# sensitive paths from the host filesystem.\n#\n# NOTE: This list is only provided for backwards compatibility with\n# older local falco rules files that may have been appending to\n# trusted_images. To make customizations, it's better to add images to\n# either privileged_images or falco_sensitive_mount_images.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1185,L1186","required_engine_version":"0.35.0","name":"trusted_images","list":"trusted_images","tags":null,"enabled":"true","used_by":["rule:Execution from /dev/shm:d11fc15d58c80066743faeab957a1684","macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","rule:Detect outbound connections to common miner pool ports:3f01c102c6d26af968d5eb6b6777085d"],"type":"list","hash":"b8b0db0ef4ed293fcc7d4192f53599fa","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to specify additional containers that are\n# trusted and therefore allowed to run privileged *and* with sensitive\n# mounts.\n#\n# Like trusted_images, this is deprecated in favor of\n# user_privileged_containers and user_sensitive_mount_containers and\n# is only provided for backwards compatibility.\n#\n# In this file, it just takes one of the images in trusted_containers\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1199,L1200","required_engine_version":"0.35.0","name":"user_trusted_containers","macro":"user_trusted_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["macro:falco_privileged_containers:9b4ba98f48c4031d87b99b489d62ca74","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9"],"type":"macro","hash":"83dc258d4e778da799e1d75b6582f967","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Falco containers","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1203,L1205","required_engine_version":"0.35.0","name":"falco_containers","list":"falco_containers","items":["falcosecurity/falco","docker.io/falcosecurity/falco","public.ecr.aws/falcosecurity/falco","falcosecurity/falco-no-driver","docker.io/falcosecurity/falco-no-driver","public.ecr.aws/falcosecurity/falco-no-driver"],"tags":null,"enabled":"true","used_by":["macro:k8s_containers:d8bdacbfed1ae82231bffc00d31c49e3","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3"],"type":"list","hash":"88616fd0dac29b81cc6b368ce116b9f4","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# These container images are allowed to mount sensitive paths from the\n# host filesystem.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1216,L1217","required_engine_version":"0.35.0","name":"falco_sensitive_mount_images","list":"falco_sensitive_mount_images","items":["falco_containers","docker.io/sysdig/sysdig","sysdig/sysdig","gcr.io/google_containers/hyperkube","gcr.io/google_containers/kube-proxy","docker.io/calico/node","docker.io/rook/toolbox","docker.io/cloudnativelabs/kube-router","docker.io/consul","docker.io/datadog/docker-dd-agent","docker.io/datadog/agent","docker.io/docker/ucp-agent","docker.io/gliderlabs/logspout","docker.io/netdata/netdata","docker.io/google/cadvisor","docker.io/prom/node-exporter","amazon/amazon-ecs-agent","prom/node-exporter","amazon/cloudwatch-agent"],"tags":null,"enabled":"true","used_by":["macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9"],"type":"list","hash":"b9e19fd16576e5fc4fbb3507fc7bc452","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1228,L1229","required_engine_version":"0.35.0","name":"falco_sensitive_mount_containers","macro":"falco_sensitive_mount_containers","condition":"(user_trusted_containers or aws_eks_image_sensitive_mount or container.image.repository in (trusted_images) or container.image.repository in (falco_sensitive_mount_images) or container.image.repository startswith quay.io/sysdig/ or container.image.repository=k8scloudprovider/cinder-csi-plugin)","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:aws_eks_image_sensitive_mount:3608173c8035e2501d82c68d9c1fd252","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:user_trusted_containers:83dc258d4e778da799e1d75b6582f967","list:falco_sensitive_mount_images:b9e19fd16576e5fc4fbb3507fc7bc452","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40"],"used_by":["rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017"],"type":"macro","hash":"cb4f45a3a0c7e25807950729fa0583e9","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add conditions to this macro (probably in a separate file,\n# overwriting this macro) to specify additional containers that are\n# allowed to perform sensitive mounts.\n#\n# In this file, it just takes one of the images in falco_sensitive_mount_images\n# and repeats it.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1242,L1243","required_engine_version":"0.35.0","name":"user_sensitive_mount_containers","macro":"user_sensitive_mount_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017"],"type":"macro","hash":"f0bae3b600b45943c88848d69ff0511b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# For now, only considering a full mount of /etc as\n# sensitive. Ideally, this would also consider all subdirectories\n# below /etc as well, but the globbing mechanism\n# doesn't allow exclusions of a full pattern, only single characters.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1249,L1250","required_engine_version":"0.35.0","name":"sensitive_mount","macro":"sensitive_mount","condition":"(not container.mount.dest[/proc*] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/var/run/docker.sock] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/var/run/crio/crio.sock] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/run/containerd/containerd.sock] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/var/lib/kubelet] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/var/lib/kubelet/pki] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/home/admin] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/etc] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/etc/kubernetes] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/etc/kubernetes/manifests] in (\"\u003cNA\u003e\",\"N/A\") or not container.mount.dest[/root*] in (\"\u003cNA\u003e\",\"N/A\"))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863"],"used_by":["rule:Create Sensitive Mount Pod:754dc8b656feadac3eca6a1d5923ae2e","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","rule:Launch Sensitive Mount Container:25f080f38071f3f9f37a2475ddee8017"],"type":"macro","hash":"0137f89a3bc9f6d0ad2b73f4f983bf40","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1263,L1276","required_engine_version":"0.35.0","name":"Launch Sensitive Mount Container","rule":"Launch Sensitive Mount Container","condition":"container_started  and container and sensitive_mount and not falco_sensitive_mount_containers and not user_sensitive_mount_containers\n","desc":"Detect the initial process launched within a container that has a mount from a sensitive host directory (e.g. /proc).  Exceptions are made for known trusted images. This rule holds value for generic auditing; however, its noisiness  varies based on your environment.\n","output":"Container with sensitive mount started (mounts=%container.mounts evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_sandbox","container","cis","mitre_execution","T1610"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:falco_sensitive_mount_containers:cb4f45a3a0c7e25807950729fa0583e9","macro:user_sensitive_mount_containers:f0bae3b600b45943c88848d69ff0511b","macro:sensitive_mount:0137f89a3bc9f6d0ad2b73f4f983bf40"],"type":"rule","hash":"25f080f38071f3f9f37a2475ddee8017","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# In a local/user rules file, you could override this macro to\n# explicitly enumerate the container images that you want to run in\n# your environment. In this main falco rules file, there isn't any way\n# to know all the containers that can run, so any container is\n# allowed, by using a filter that is guaranteed to evaluate to true.\n# In the overridden macro, the condition would look something like\n# (container.image.repository = vendor/container-1 or\n# container.image.repository = vendor/container-2 or ...)","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1286,L1287","required_engine_version":"0.35.0","name":"allowed_containers","macro":"allowed_containers","condition":"(container.id exists)","tags":null,"enabled":"true","used_by":["rule:Launch Disallowed Container:ae4f6c0ee9508cea28f4a8b9b2034b49"],"type":"macro","hash":"3853afa25aa203914c863c8818848499","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1289,L1301","required_engine_version":"0.35.0","name":"Launch Disallowed Container","rule":"Launch Disallowed Container","condition":"container_started  and container  and not allowed_containers\n","desc":"Detect the initial process launched within a container that is not in a list of allowed containers.  This rule holds value for generic auditing; however, this rule requires a good understanding of your  setup and consistent effort to keep the list of allowed containers current. In some situations,  this can be challenging to manage.\n","output":"Container started and not in allowed list (evt_type=%evt.type user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_sandbox","container","mitre_lateral_movement","T1610"],"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container_started:9c5e39660ca4df75897d1230d8dbae77","macro:allowed_containers:3853afa25aa203914c863c8818848499"],"type":"rule","hash":"ae4f6c0ee9508cea28f4a8b9b2034b49","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# In some environments, any attempt by a interpreted program (perl,\n# python, ruby, etc) to listen for incoming connections or perform\n# outgoing connections might be suspicious. These rules are not\n# enabled by default.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1307,L1318","required_engine_version":"0.35.0","name":"Interpreted procs inbound network activity","rule":"Interpreted procs inbound network activity","condition":"inbound  and interpreted_procs\n","desc":"Any inbound network activity performed by any interpreted program (perl, python, ruby, etc.). While it offers broad coverage and behavioral  insights, operationalizing it effectively requires significant time and might result in a moderate level of noise. Suggesting customizing  this rule to be more specific. For example, you could set it up to alert only for important namespaces after studying their usual behavior.\n","output":"Interpreted program received/listened for network traffic (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","network","mitre_exfiltration","TA0011"],"enabled":"false","dependencies":["macro:interpreted_procs:da079be04ff9eb76c2091349ef2a40c3","macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3"],"type":"rule","hash":"692f4100b04d58b3f8aed51afb8b51cd","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1320,L1331","required_engine_version":"0.35.0","name":"Interpreted procs outbound network activity","rule":"Interpreted procs outbound network activity","condition":"outbound  and interpreted_procs\n","desc":"Any outbound network activity performed by any interpreted program (perl, python, ruby, etc.). While it offers broad coverage and behavioral  insights, operationalizing it effectively requires significant time and might result in a moderate level of noise. Suggesting customizing  this rule to be more specific. For example, you could set it up to alert only for important namespaces after studying their usual behavior.\n","output":"Interpreted program performed outgoing network connection (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","network","mitre_exfiltration","TA0011"],"enabled":"false","dependencies":["macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:interpreted_procs:da079be04ff9eb76c2091349ef2a40c3","macro:outbound:b5229dfdd9136d1c772f9070f3095016"],"type":"rule","hash":"f44c77a690d44b9d8004d3283a63cb92","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# In a local/user rules file, list the container images that are\n# allowed to contact NodePort services from within a container. This\n# might cover cases where the K8s infrastructure itself is running\n# within a container.\n#\n# By default, all containers are allowed to contact NodePort services.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1339,L1340","required_engine_version":"0.35.0","name":"nodeport_containers","macro":"nodeport_containers","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Unexpected K8s NodePort Connection:102da798591e75d1c7fc9ec3e9370169"],"type":"macro","hash":"d08e4abe1246be2869449a98762daa05","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1342,L1357","required_engine_version":"0.35.0","name":"Unexpected K8s NodePort Connection","rule":"Unexpected K8s NodePort Connection","condition":"inbound_outbound  and container  and fd.sport \u003e= 30000  and fd.sport \u003c= 32767  and not nodeport_containers\n","desc":"Detect attempts to utilize K8s NodePorts from a container. K8s NodePorts are accessible on the eth0 interface of  each node, and they facilitate external traffic into a Kubernetes cluster. Attackers could misuse them for  unauthorized access. The rule uses default port ranges, but check for custom ranges and make necessary adjustments.  Also, consider tuning this rule as needed.\n","output":"Unexpected K8s NodePort Connection (connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","network","k8s","container","mitre_persistence","T1205.001","NIST_800-53_AC-6"],"enabled":"false","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:node:36c4536996ca5615dcf9911f068786dc","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:inbound:a8e6fe5b9e68f30a146cefebaa7edcc3","macro:outbound:b5229dfdd9136d1c772f9070f3095016","macro:inbound_outbound:5b954dcc69c9cfaf014ba8fbebce7921","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:nodeport_containers:d08e4abe1246be2869449a98762daa05"],"type":"rule","hash":"102da798591e75d1c7fc9ec3e9370169","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1359,L1360","required_engine_version":"0.35.0","name":"exclude_hidden_directories","list":"exclude_hidden_directories","items":["/root/.cassandra"],"tags":null,"enabled":"true","used_by":["rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"list","hash":"c6d67f75dc2ff1e98b2d209476ce421b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The rule is disabled by default.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1363,L1364","required_engine_version":"0.35.0","name":"user_known_create_hidden_file_activities","macro":"user_known_create_hidden_file_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Create Hidden Files or Directories:11d6e72bcaca173e61a9239889053a84"],"type":"macro","hash":"c604f50751c1133a076f8194b9f04921","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1366,L1382","required_engine_version":"0.35.0","name":"Create Hidden Files or Directories","rule":"Create Hidden Files or Directories","condition":"((modify and evt.arg.newpath contains \"/.\") or\n (mkdir and evt.arg.path contains \"/.\") or\n (open_write and evt.arg.flags contains \"O_CREAT\" and fd.name contains \"/.\" and not fd.name pmatch (exclude_hidden_directories))) \nand not user_known_create_hidden_file_activities and not exe_running_docker_save\n","desc":"Detecting hidden files or directories creation can serve as an auditing rule to track general system changes.  Such rules can be noisy and challenging to interpret, particularly if your system frequently undergoes updates. However, careful  profiling of your environment can transform this rule into an effective rule for detecting unusual behavior associated with system  changes, including compliance-related cases.\n","output":"Hidden file or directory created (file=%fd.name newpath=%evt.arg.newpath evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","mitre_defense_evasion","T1564.001"],"enabled":"false","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:mkdir:d1c89dbbd2e4ef759c37d3e0b94e7327","macro:modify:8f45a2644508b5282f57fe129f62d19a","macro:exe_running_docker_save:3870d01b317a519c449ba80c75fa2386","list:exclude_hidden_directories:c6d67f75dc2ff1e98b2d209476ce421b","macro:user_known_create_hidden_file_activities:c604f50751c1133a076f8194b9f04921"],"type":"rule","hash":"11d6e72bcaca173e61a9239889053a84","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1384,L1385","required_engine_version":"0.35.0","name":"miner_ports","list":"miner_ports","items":["25","3333","3334","3335","3336","3357","4444","5555","5556","5588","5730","6099","6666","7777","7778","8000","8001","8008","8080","8118","8333","8888","8899","9332","9999","14433","14444","45560","45700"],"tags":null,"enabled":"true","used_by":["macro:minerpool_other:5e85bae2ec959252aa6b103da561c541"],"type":"list","hash":"d21573a4543b4998520917d2a101a972","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1393,L1394","required_engine_version":"0.35.0","name":"miner_domains","list":"miner_domains","items":["asia1.ethpool.org","ca.minexmr.com","cn.stratum.slushpool.com","de.minexmr.com","eth-ar.dwarfpool.com","eth-asia.dwarfpool.com","eth-asia1.nanopool.org","eth-au.dwarfpool.com","eth-au1.nanopool.org","eth-br.dwarfpool.com","eth-cn.dwarfpool.com","eth-cn2.dwarfpool.com","eth-eu.dwarfpool.com","eth-eu1.nanopool.org","eth-eu2.nanopool.org","eth-hk.dwarfpool.com","eth-jp1.nanopool.org","eth-ru.dwarfpool.com","eth-ru2.dwarfpool.com","eth-sg.dwarfpool.com","eth-us-east1.nanopool.org","eth-us-west1.nanopool.org","eth-us.dwarfpool.com","eth-us2.dwarfpool.com","eu.stratum.slushpool.com","eu1.ethermine.org","eu1.ethpool.org","fr.minexmr.com","mine.moneropool.com","mine.xmrpool.net","pool.minexmr.com","pool.monero.hashvault.pro","pool.supportxmr.com","sg.minexmr.com","sg.stratum.slushpool.com","stratum-eth.antpool.com","stratum-ltc.antpool.com","stratum-zec.antpool.com","stratum.antpool.com","us-east.stratum.slushpool.com","us1.ethermine.org","us1.ethpool.org","us2.ethermine.org","us2.ethpool.org","xmr-asia1.nanopool.org","xmr-au1.nanopool.org","xmr-eu1.nanopool.org","xmr-eu2.nanopool.org","xmr-jp1.nanopool.org","xmr-us-east1.nanopool.org","xmr-us-west1.nanopool.org","xmr.crypto-pool.fr","xmr.pool.minergate.com","rx.unmineable.com","ss.antpool.com","dash.antpool.com","eth.antpool.com","zec.antpool.com","xmc.antpool.com","btm.antpool.com","stratum-dash.antpool.com","stratum-xmc.antpool.com","stratum-btm.antpool.com"],"tags":null,"enabled":"true","used_by":["macro:minerpool_https:1253ad0f8832f1c85817b74a4d1c9580","macro:minerpool_http:39bf1eb564009cb9f3609fcd658970d3","macro:minerpool_other:5e85bae2ec959252aa6b103da561c541"],"type":"list","hash":"3d20d68ce0e96c200f13742b71e3b044","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1429,L1430","required_engine_version":"0.35.0","name":"https_miner_domains","list":"https_miner_domains","items":["ca.minexmr.com","cn.stratum.slushpool.com","de.minexmr.com","fr.minexmr.com","mine.moneropool.com","mine.xmrpool.net","pool.minexmr.com","sg.minexmr.com","stratum-eth.antpool.com","stratum-ltc.antpool.com","stratum-zec.antpool.com","stratum.antpool.com","xmr.crypto-pool.fr","ss.antpool.com","stratum-dash.antpool.com","stratum-xmc.antpool.com","stratum-btm.antpool.com","btm.antpool.com"],"tags":null,"enabled":"true","used_by":["macro:minerpool_https:1253ad0f8832f1c85817b74a4d1c9580"],"type":"list","hash":"80f9c40341ea327996b3717486880494","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1451,L1452","required_engine_version":"0.35.0","name":"http_miner_domains","list":"http_miner_domains","items":["ca.minexmr.com","de.minexmr.com","fr.minexmr.com","mine.moneropool.com","mine.xmrpool.net","pool.minexmr.com","sg.minexmr.com","xmr.crypto-pool.fr"],"tags":null,"enabled":"true","used_by":["macro:minerpool_http:39bf1eb564009cb9f3609fcd658970d3"],"type":"list","hash":"ffd4d65b12a26b2a38fe9eab7c0edfe6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Add rule based on crypto mining IOCs","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1464,L1465","required_engine_version":"0.35.0","name":"minerpool_https","macro":"minerpool_https","condition":"(fd.sport=\"443\" and fd.sip.name in (https_miner_domains))","tags":null,"enabled":"true","dependencies":["list:miner_domains:3d20d68ce0e96c200f13742b71e3b044","list:https_miner_domains:80f9c40341ea327996b3717486880494"],"used_by":["macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"macro","hash":"1253ad0f8832f1c85817b74a4d1c9580","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1467,L1468","required_engine_version":"0.35.0","name":"minerpool_http","macro":"minerpool_http","condition":"(fd.sport=\"80\" and fd.sip.name in (http_miner_domains))","tags":null,"enabled":"true","dependencies":["list:miner_domains:3d20d68ce0e96c200f13742b71e3b044","list:http_miner_domains:ffd4d65b12a26b2a38fe9eab7c0edfe6"],"used_by":["macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"macro","hash":"39bf1eb564009cb9f3609fcd658970d3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1470,L1471","required_engine_version":"0.35.0","name":"minerpool_other","macro":"minerpool_other","condition":"(fd.sport in (miner_ports) and fd.sip.name in (miner_domains))","tags":null,"enabled":"true","dependencies":["list:miner_ports:d21573a4543b4998520917d2a101a972","list:miner_domains:3d20d68ce0e96c200f13742b71e3b044"],"used_by":["macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc"],"type":"macro","hash":"5e85bae2ec959252aa6b103da561c541","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1473,L1474","required_engine_version":"0.35.0","name":"net_miner_pool","macro":"net_miner_pool","condition":"(evt.type in (sendto, sendmsg, connect) and evt.dir=\u003c and (fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and ((minerpool_http) or (minerpool_https) or (minerpool_other)))","tags":null,"enabled":"true","dependencies":["list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","list:rfc_1918_addresses:748492cefb06210e27885e76e1ab8f7a","macro:minerpool_https:1253ad0f8832f1c85817b74a4d1c9580","macro:minerpool_http:39bf1eb564009cb9f3609fcd658970d3","macro:minerpool_other:5e85bae2ec959252aa6b103da561c541"],"used_by":["rule:Detect outbound connections to common miner pool ports:3f01c102c6d26af968d5eb6b6777085d"],"type":"macro","hash":"b9fc9175ce3dc6b857d0b77567a05ccc","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1476,L1477","required_engine_version":"0.35.0","name":"trusted_images_query_miner_domain_dns","macro":"trusted_images_query_miner_domain_dns","condition":"(container.image.repository in (falco_containers))","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:falco_containers:88616fd0dac29b81cc6b368ce116b9f4"],"used_by":["rule:Detect outbound connections to common miner pool ports:3f01c102c6d26af968d5eb6b6777085d"],"type":"macro","hash":"09520dcb5b734826bb1a346b6e5d8be3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The rule is disabled by default.\n# Note: falco will send DNS request to resolve miner pool domain which may trigger alerts in your environment.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1481,L1492","required_engine_version":"0.35.0","name":"Detect outbound connections to common miner pool ports","rule":"Detect outbound connections to common miner pool ports","condition":"net_miner_pool  and not trusted_images_query_miner_domain_dns\n","desc":"Miners usually connect to miner pools using standard ports, and this rule flags such activity. Important: Falco currently sends DNS  requests to resolve miner pool domains, which could trigger other alerts. Prior to enabling this rule, it's advised to ensure whether  this is acceptable for your environment. This rule is specifically disabled for that reason.\n","output":"Outbound connection to IP/Port flagged by https://cryptoioc.ch (ip=%fd.rip connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","network","mitre_impact","T1496"],"enabled":"false","dependencies":["list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","list:trusted_images:b8b0db0ef4ed293fcc7d4192f53599fa","macro:net_miner_pool:b9fc9175ce3dc6b857d0b77567a05ccc","macro:trusted_images_query_miner_domain_dns:09520dcb5b734826bb1a346b6e5d8be3"],"type":"rule","hash":"3f01c102c6d26af968d5eb6b6777085d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1494,L1506","required_engine_version":"0.35.0","name":"Detect crypto miners using the Stratum protocol","rule":"Detect crypto miners using the Stratum protocol","condition":"spawned_process  and (proc.cmdline contains \"stratum+tcp\" or \n     proc.cmdline contains \"stratum2+tcp\" or \n     proc.cmdline contains \"stratum+ssl\" or \n     proc.cmdline contains \"stratum2+ssl\")\n","desc":"Miners commonly specify the mining pool to connect to using a URI that starts with \"stratum+tcp\". However, this rule is highly specific to  this technique, and matching command-line arguments can generally be bypassed quite easily.\n","output":"Possible miner running (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","process","mitre_impact","T1496"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"b22719ac071b8de3c7e0ec92dcab21cb","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1508,L1509","required_engine_version":"0.35.0","name":"k8s_client_binaries","list":"k8s_client_binaries","items":["docker","kubectl","crictl"],"tags":null,"enabled":"true","used_by":["rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66"],"type":"list","hash":"4a93546ebd9ae6cb7a6bfee03e63792c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1511,L1512","required_engine_version":"0.35.0","name":"user_known_k8s_ns_kube_system_images","list":"user_known_k8s_ns_kube_system_images","items":["registry.k8s.io/fluentd-gcp-scaler","registry.k8s.io/node-problem-detector/node-problem-detector"],"tags":null,"enabled":"true","used_by":["macro:user_known_k8s_client_container:3fe640b1f7a9eea1ac982bd3f68f241b"],"type":"list","hash":"5a089872fa08e5f481daaff0331a9f68","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1517,L1518","required_engine_version":"0.35.0","name":"user_known_k8s_images","list":"user_known_k8s_images","items":["mcr.microsoft.com/aks/hcp/hcp-tunnel-front"],"tags":null,"enabled":"true","used_by":["macro:user_known_k8s_client_container:3fe640b1f7a9eea1ac982bd3f68f241b"],"type":"list","hash":"724cb45caceb7302d7d14c5dc5aafec4","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Whitelist for known docker client binaries run inside container\n# - registry.k8s.io/fluentd-gcp-scaler in GCP/GKE","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1524,L1525","required_engine_version":"0.35.0","name":"user_known_k8s_client_container","macro":"user_known_k8s_client_container","condition":"(k8s.ns.name=\"kube-system\" and container.image.repository in (user_known_k8s_ns_kube_system_images)) or container.image.repository in (user_known_k8s_images)\n","tags":null,"enabled":"true","dependencies":["list:user_known_k8s_ns_kube_system_images:5a089872fa08e5f481daaff0331a9f68","list:user_known_k8s_images:724cb45caceb7302d7d14c5dc5aafec4"],"used_by":["macro:user_known_k8s_client_container_parens:2fdfd506ad251627b22d33c77dee9957","rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66"],"type":"macro","hash":"3fe640b1f7a9eea1ac982bd3f68f241b","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1528,L1529","required_engine_version":"0.35.0","name":"user_known_k8s_client_container_parens","macro":"user_known_k8s_client_container_parens","condition":"(user_known_k8s_client_container)","tags":null,"enabled":"true","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:user_known_k8s_client_container:3fe640b1f7a9eea1ac982bd3f68f241b"],"used_by":["rule:Kubernetes Client Tool Launched in Container:bc5091ab0698e22b68d788e490e8eb66"],"type":"macro","hash":"2fdfd506ad251627b22d33c77dee9957","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1531,L1543","required_engine_version":"0.35.0","name":"Kubernetes Client Tool Launched in Container","rule":"Kubernetes Client Tool Launched in Container","condition":"spawned_process  and container  and not user_known_k8s_client_container_parens  and proc.name in (k8s_client_binaries)\n","desc":"Detect the execution of a Kubernetes client tool (like docker, kubectl, crictl) within a container, which is typically not expected behavior.  Although this rule targets container workloads, monitoring the use of tools like crictl on the host over interactive access could also be  valuable for broader auditing objectives.\n","output":"Kubernetes Client Tool Launched in Container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_sandbox","container","mitre_execution","T1610"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:k8s_client_binaries:4a93546ebd9ae6cb7a6bfee03e63792c","macro:user_known_k8s_client_container:3fe640b1f7a9eea1ac982bd3f68f241b","macro:user_known_k8s_client_container_parens:2fdfd506ad251627b22d33c77dee9957"],"type":"rule","hash":"bc5091ab0698e22b68d788e490e8eb66","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The two Container Drift rules below will fire when a new executable is created in a container.\n# There are two ways to create executables - file is created with execution permissions or permissions change of existing file.\n# We will use a new filter, is_open_exec, to find all files creations with execution permission, and will trace all chmods in a container.\n# The use case we are targeting here is an attempt to execute code that was not shipped as part of a container (drift) -\n# an activity that might be malicious or non-compliant.\n# Two things to pay attention to:\n#   1) In most cases, 'docker cp' will not be identified, but the assumption is that if an attacker gained access to the container runtime daemon, they are already privileged\n#   2) Drift rules will be noisy in environments in which containers are built (e.g. docker build)\n# These two rules are not enabled by default.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1554,L1555","required_engine_version":"0.35.0","name":"user_known_container_drift_activities","macro":"user_known_container_drift_activities","condition":"(never_true)","tags":null,"enabled":"true","dependencies":["macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3","macro:never_true:7fdab030a488289fce9f593757b50ba3"],"used_by":["rule:Container Drift Detected (chmod):70996cf27c16da0916ae631a52ca0dd6","rule:Container Drift Detected (open+create):e32f7f179a97e8ff06bae061e2a07e22"],"type":"macro","hash":"46ac0d3ff6fcf7d1fec5e687faf159f5","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1557,L1576","required_engine_version":"0.35.0","name":"Container Drift Detected (chmod)","rule":"Container Drift Detected (chmod)","condition":"chmod  and container  and evt.rawres\u003e=0  and ((evt.arg.mode contains \"S_IXUSR\") or\n     (evt.arg.mode contains \"S_IXGRP\") or\n     (evt.arg.mode contains \"S_IXOTH\"))\nand not runc_writing_exec_fifo  and not runc_writing_var_lib_docker  and not user_known_container_drift_activities \n","desc":"Detect new executables created within a container as a result of chmod. While this detection can generate significant noise, chmod  usage is frequently linked to dropping and executing malicious implants. The newer rule \"Drop and execute new binary in container\"  provides more precise detection of this TTP using unambiguous kernel signals. It is recommended to use the new rule. However, this  rule might be more relevant for auditing if applicable in your environment, such as when chmod is used on files within the /tmp folder.\n","output":"Drift detected (chmod), new executable created in a container (filename=%evt.arg.filename name=%evt.arg.name mode=%evt.arg.mode evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","container","process","filesystem","mitre_execution","T1059"],"enabled":"false","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:chmod:417e248f80c35ca0d471575a5fb951f5","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:chmod:417e248f80c35ca0d471575a5fb951f5","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:runc_writing_exec_fifo:02aceef22907814c7c6d346464be2cf9","macro:runc_writing_var_lib_docker:b777a4da7476b667e5c97c94dba354fe","macro:user_known_container_drift_activities:46ac0d3ff6fcf7d1fec5e687faf159f5"],"type":"rule","hash":"70996cf27c16da0916ae631a52ca0dd6","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# ****************************************************************************\n# * \"Container Drift Detected (open+create)\" requires FALCO_ENGINE_VERSION 6 *\n# ****************************************************************************","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1581,L1596","required_engine_version":"0.35.0","name":"Container Drift Detected (open+create)","rule":"Container Drift Detected (open+create)","condition":"evt.type in (open,openat,openat2,creat)  and evt.rawres\u003e=0 and evt.is_open_exec=true  and container  and not runc_writing_exec_fifo  and not runc_writing_var_lib_docker  and not user_known_container_drift_activities \n","desc":"Detect new executables created within a container as a result of open+create. The newer rule \"Drop and execute new binary in container\"  provides more precise detection of this TTP using unambiguous kernel signals. It is recommended to use the new rule. \n","output":"Drift detected (open+create), new executable created in a container (filename=%evt.arg.filename name=%evt.arg.name mode=%evt.arg.mode evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"ERROR","source":"syscalls","tags":["maturity_sandbox","container","process","filesystem","mitre_execution","T1059"],"enabled":"false","dependencies":["macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:runc_writing_exec_fifo:02aceef22907814c7c6d346464be2cf9","macro:runc_writing_var_lib_docker:b777a4da7476b667e5c97c94dba354fe","macro:user_known_container_drift_activities:46ac0d3ff6fcf7d1fec5e687faf159f5"],"type":"rule","hash":"e32f7f179a97e8ff06bae061e2a07e22","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1598,L1599","required_engine_version":"0.35.0","name":"run_as_root_image_list","list":"run_as_root_image_list","tags":null,"enabled":"true","used_by":["macro:user_known_run_as_root_container:6d1e706fe4693f24e8d8cd3b48e0697c"],"type":"list","hash":"e052d3453c3eb42d5d11541c0a2f5599","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1601,L1602","required_engine_version":"0.35.0","name":"user_known_run_as_root_container","macro":"user_known_run_as_root_container","condition":"(container.image.repository in (run_as_root_image_list))","tags":null,"enabled":"true","dependencies":["list:run_as_root_image_list:e052d3453c3eb42d5d11541c0a2f5599"],"used_by":["rule:Container Run as Root User:353fe5313eb9fe14878f7eaae04550a3"],"type":"macro","hash":"6d1e706fe4693f24e8d8cd3b48e0697c","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# The rule is disabled by default and should be enabled when non-root container policy has been applied.\n# Note the rule will not work as expected when usernamespace is applied, e.g. userns-remap is enabled.","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1606,L1620","required_engine_version":"0.35.0","name":"Container Run as Root User","rule":"Container Run as Root User","condition":"spawned_process  and container  and proc.vpid=1  and user.uid=0  and not user_known_run_as_root_container\n","desc":"Container detected running as the root user. This should be taken into account especially when policies disallow containers from running with  root user privileges. Note that a root user in containers doesn't inherently possess extensive power, as modern container environments define  privileges through Linux capabilities. To learn more, check out the rule \"Launch Privileged Container\".\n","output":"Container launched with root user privilege (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_sandbox","container","process","users","mitre_execution","T1610"],"enabled":"false","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:user_known_run_as_root_container:6d1e706fe4693f24e8d8cd3b48e0697c"],"type":"rule","hash":"353fe5313eb9fe14878f7eaae04550a3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This rule helps detect CVE-2021-3156:\n# A privilege escalation to root through heap-based buffer overflow","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1624,L1637","required_engine_version":"0.35.0","name":"Sudo Potential Privilege Escalation","rule":"Sudo Potential Privilege Escalation","condition":"spawned_process  and user.uid != 0  and (proc.name=sudoedit or proc.name = sudo)  and (proc.args contains -s or proc.args contains -i or proc.args contains --login)  and (proc.args contains \"\\ \" or proc.args endswith \\)\n","desc":"Affecting sudo (\u003c= 1.9.5p2), there's a privilege escalation vulnerability. By executing sudo using the sudoedit -s or sudoedit -i command with a  command-line argument that ends with a single backslash character, an unprivileged user can potentially escalate privileges to root. This rule is  highly specific and might be bypassed due to potential issues with string matching on command line arguments.\n","output":"Detect Sudo Privilege Escalation Exploit (CVE-2021-3156) (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","filesystem","users","mitre_privilege_escalation","T1548.003"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"f1e70442dbd3656e78ceb11d3863b239","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1639,L1640","required_engine_version":"0.35.0","name":"user_known_userfaultfd_processes","list":"user_known_userfaultfd_processes","tags":null,"enabled":"true","used_by":["rule:Unprivileged Delegation of Page Faults Handling to a Userspace Process:beb9e5195f907d71080bc9d9db607371"],"type":"list","hash":"c9561d224c2d208b6adc5403cb66fae1","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1642,L1653","required_engine_version":"0.35.0","name":"Unprivileged Delegation of Page Faults Handling to a Userspace Process","rule":"Unprivileged Delegation of Page Faults Handling to a Userspace Process","condition":"evt.type = userfaultfd  and user.uid != 0  and (evt.rawres \u003e= 0 or evt.res != -1)  and not proc.name in (user_known_userfaultfd_processes)\n","desc":"Detect a successful unprivileged userfaultfd syscall, which could serve as an attack primitive for exploiting other vulnerabilities.  To fine-tune this rule, consider using the template list \"user_known_userfaultfd_processes\".\n","output":"An userfaultfd syscall was successfully executed by an unprivileged user (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","process","mitre_defense_evasion","TA0005"],"enabled":"true","dependencies":["list:user_known_userfaultfd_processes:c9561d224c2d208b6adc5403cb66fae1"],"type":"rule","hash":"beb9e5195f907d71080bc9d9db607371","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# This rule helps detect CVE-2021-4034:\n# A privilege escalation to root through memory corruption","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1657,L1669","required_engine_version":"0.35.0","name":"Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)","rule":"Polkit Local Privilege Escalation Vulnerability (CVE-2021-4034)","condition":"spawned_process and user.uid != 0 and proc.name=pkexec and proc.args = ''","desc":"This rule detects attempts to exploit a privilege escalation vulnerability in Polkit's pkexec. Through the execution of specially  crafted code, a local user can exploit this weakness to attain root privileges on a compromised system. This rule is highly  specific in its scope.\n","output":"Detect Polkit pkexec Local Privilege Escalation Exploit (CVE-2021-4034) (args=%proc.args evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","process","users","mitre_privilege_escalation","TA0004"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2"],"type":"rule","hash":"5bc83b5d4fdd9b976dabc965dfe05fee","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"# Rule for detecting potential Log4Shell (CVE-2021-44228) exploitation\n# Note: Not compatible with Java 17+, which uses read() syscalls","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1673,L1674","required_engine_version":"0.35.0","name":"java_network_read","macro":"java_network_read","condition":"(evt.type=recvfrom and fd.type in (ipv4, ipv6) and proc.exe endswith java)","tags":null,"enabled":"true","used_by":["rule:Java Process Class File Download:3f245808a168ffcf6b0e2ae629ffbb80"],"type":"macro","hash":"4a7940303027c582a247119ec5bfd388","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1676,L1686","required_engine_version":"0.35.0","name":"Java Process Class File Download","rule":"Java Process Class File Download","condition":"java_network_read  and evt.buffer bcontains cafebabe\n","desc":"Detecting a Java process downloading a class file which could indicate a successful exploit of the log4shell Log4j vulnerability (CVE-2021-44228).  This rule is highly specific in its scope.\n","output":"Java process class file download (server_ip=%fd.sip server_port=%fd.sport connection=%fd.name lport=%fd.lport rport=%fd.rport fd_type=%fd.type fd_proto=%fd.l4proto evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"CRITICAL","source":"syscalls","tags":["maturity_sandbox","host","container","process","mitre_initial_access","T1190"],"enabled":"false","dependencies":["macro:java_network_read:4a7940303027c582a247119ec5bfd388"],"type":"rule","hash":"3f245808a168ffcf6b0e2ae629ffbb80","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1688,L1689","required_engine_version":"0.35.0","name":"docker_binaries","list":"docker_binaries","items":["docker","dockerd","containerd-shim","runc:[1:CHILD]","pause","exe","docker-compose","docker-entrypoi","docker-runc-cur","docker-current","dockerd-current"],"tags":null,"enabled":"true","used_by":["macro:server_procs:b0b2aee9b1b742b7be027fd5c2ac590e","rule:Change thread namespace:bf53659328792edf3dcb3d50994a2d61","rule:Non sudo setuid:7da3924afff60ec8eb7c45c5fd3fda63","rule:Delete or rename shell history:3fc83e2b9ee1f13d8fbba5e9ef385ffc","macro:docker_procs:26fc5da2b4808fa032d520b261d62d9d"],"type":"list","hash":"663cca84b425c42a03acc1f2ee04be85","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1691,L1692","required_engine_version":"0.35.0","name":"docker_procs","macro":"docker_procs","condition":"proc.name in (docker_binaries)","tags":null,"enabled":"true","dependencies":["list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85","list:docker_binaries:663cca84b425c42a03acc1f2ee04be85"],"used_by":["rule:Modify Container Entrypoint:ee4335b2203d324d5dec85969f5177c3"],"type":"macro","hash":"26fc5da2b4808fa032d520b261d62d9d","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1694,L1707","required_engine_version":"0.35.0","name":"Modify Container Entrypoint","rule":"Modify Container Entrypoint","condition":"open_write  and container  and (fd.name=/proc/self/exe or fd.name startswith /proc/self/fd/)  and not docker_procs  and not proc.cmdline = \"runc:[1:CHILD] init\"\n","desc":"This rule detect an attempt to write on container entrypoint symlink (/proc/self/exe). Possible CVE-2019-5736 Container Breakout exploitation attempt.  This rule has a more narrow scope.\n","output":"Detect Potential Container Breakout Exploit (CVE-2019-5736) (file=%fd.name evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty %container.info)","priority":"WARNING","source":"syscalls","tags":["maturity_sandbox","container","filesystem","mitre_initial_access","T1611"],"enabled":"false","dependencies":["macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:open_write:43a1a1a71582531905f162ae8757ecda","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:docker_procs:26fc5da2b4808fa032d520b261d62d9d"],"type":"rule","hash":"ee4335b2203d324d5dec85969f5177c3","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1709,L1710","required_engine_version":"0.35.0","name":"known_decode_payload_containers","list":"known_decode_payload_containers","tags":null,"enabled":"true","used_by":["rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81"],"type":"list","hash":"60b337204f50790481170ad511f04fdf","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1712,L1713","required_engine_version":"0.35.0","name":"base64_decoding","macro":"base64_decoding","condition":"(proc.cmdline contains \"base64\" and (proc.cmdline contains \"--decode\" or proc.cmdline contains \"-d\"))","tags":null,"enabled":"true","used_by":["rule:Decoding Payload in Container:48aef2a2f050ce45e9ba9914582a0f81"],"type":"macro","hash":"89188543299acf07816637a8a54bd974","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1715,L1730","required_engine_version":"0.35.0","name":"Decoding Payload in Container","rule":"Decoding Payload in Container","condition":"spawned_process  and container  and base64_decoding  and not container.image.repository in (known_decode_payload_containers)\n","desc":"Detect any use of {base64} decoding in a container. Legitimate applications may decode encoded payloads. The template list  known_decode_payload_containers can be used for simple tuning and customization, or you can adopt custom, more refined tuning. Less  sophisticated adversaries may {base64}-decode their payloads not only to obfuscate them, but also to ensure that the payload remains  intact when the application processes it. Note that injecting commands into an application's input often results in the application  processing passed strings like \"sh -c\". In these cases, you may be lucky and the encoded blob will also be logged. Otherwise, all you  will see is the {base64} decoding command, as the encoded blob was already interpreted by the shell. \n","output":"Decoding Payload in Container (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"INFO","source":"syscalls","tags":["maturity_sandbox","container","process","mitre_command_and_control","T1132"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:container:5f0b6ebc4bea10285ba2b8a6ce78b863","list:known_decode_payload_containers:60b337204f50790481170ad511f04fdf","macro:base64_decoding:89188543299acf07816637a8a54bd974"],"type":"rule","hash":"48aef2a2f050ce45e9ba9914582a0f81","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1731,L1732","required_engine_version":"0.35.0","name":"recon_binaries","list":"recon_binaries","items":["w","whoami","id","who","uname"],"tags":null,"enabled":"true","used_by":["macro:recon_binaries_procs:0b1be8b6af3f4d9ab086adf7813c16fa","rule:Basic Interactive Reconnaissance:f919d2aa742cf1ef21907e9e3d805ca1"],"type":"list","hash":"58ad572a5314b864bf7069800bb7c192","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L0,L0","required_engine_version":"0.35.0","name":"recon_binaries_procs","macro":"recon_binaries_procs","condition":"(proc.name in (recon_binaries))","tags":null,"enabled":"true","dependencies":["list:recon_binaries:58ad572a5314b864bf7069800bb7c192"],"used_by":["rule:Basic Interactive Reconnaissance:f919d2aa742cf1ef21907e9e3d805ca1"],"type":"macro","hash":"0b1be8b6af3f4d9ab086adf7813c16fa","maturity":"sandbox"},{"file_name":"falco-sandbox_rules.yaml","comment":"","permalink":"https://github.com/falcosecurity/rules/blob/main/rules/falco-sandbox_rules.yaml#L1737,L1753","required_engine_version":"0.35.0","name":"Basic Interactive Reconnaissance","rule":"Basic Interactive Reconnaissance","condition":"spawned_process  and recon_binaries_procs  and proc.tty != 0  and proc.is_vpgid_leader=true\n","desc":"This rule detects basic interactive reconnaissance commands that are typically run by unsophisticated attackers or used  in internal Red Team exercises. Interactive is defined as a terminal being present (proc.tty != 0). This could be any  form of reverse shell or usage of kubectl exec or ssh etc. In addition, filtering for the process being the process group   leader indicates that the command was \"directly\" typed into the terminal and not run as a result of a script. This rule  is a basic auditing or template rule. You can expand the list of reconnaissance commands, such as by adding \"ls\". Common  anti-patterns are SRE activity or debugging, but it is still worth capturing this generically. Typically, you would expect  other rules to fire as well in relation to this activity.\n","output":"Basic Interactive Reconnaissance (evt_type=%evt.type user=%user.name user_uid=%user.uid user_loginuid=%user.loginuid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty exe_flags=%evt.arg.flags %container.info)","priority":"NOTICE","source":"syscalls","tags":["maturity_sandbox","host","container","process","mitre_reconnaissance","TA0043"],"enabled":"true","dependencies":["macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","macro:spawned_process:b684ebf37c34399a595a3791398d95b2","list:recon_binaries:58ad572a5314b864bf7069800bb7c192","macro:recon_binaries_procs:0b1be8b6af3f4d9ab086adf7813c16fa"],"type":"rule","hash":"f919d2aa742cf1ef21907e9e3d805ca1","maturity":"sandbox"}]}